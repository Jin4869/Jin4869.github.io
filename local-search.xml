<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>大理寺日志贰一些观感</title>
    <link href="/2023/01/19/%E5%A4%A7%E7%90%86%E5%AF%BA%E6%97%A5%E5%BF%97%E8%B4%B0%E4%B8%80%E4%BA%9B%E8%A7%82%E6%84%9F/"/>
    <url>/2023/01/19/%E5%A4%A7%E7%90%86%E5%AF%BA%E6%97%A5%E5%BF%97%E8%B4%B0%E4%B8%80%E4%BA%9B%E8%A7%82%E6%84%9F/</url>
    
    <content type="html"><![CDATA[<p>十月份就更新的大理寺日志第二季，我直到一月份才知道，而且看了官方的微博，才知道第一季竟然亏钱了，**亏钱了！！**unbelievable！！</p><p>所以赶紧来补了 hhh 趁着还没有开虐记录一下里面沙雕的剧情</p><p>猫猫一如既往的可爱，咋不考虑做只娃娃捏<br><img src="2023-01-19-19-51-25.png" alt=""></p><p>我真的笑死，不愧是你崔倍<br><img src="2023-01-19-19-52-41.png" alt=""></p><p>开幕可爱击<br><img src="2023-01-19-20-06-07.png" alt=""><br><img src="2023-01-19-20-05-38.png" alt=""></p><p>娇羞什么啊猫爷！！<br><img src="2023-01-19-20-10-41.png" alt=""></p><p>md 好帅<br><img src="2023-01-19-20-11-56.png" alt=""></p><p>笑死，什么表情啊猫爷<br><img src="2023-01-19-20-14-10.png" alt=""></p><p>我真的笑死这一段<br><img src="2023-01-19-20-17-09.png" alt=""></p><p>陈拾耍帅，有点黑罗刹的样子<br><img src="2023-01-19-20-29-34.png" alt=""></p><p>新 op，猫爷真帅<br><img src="2023-01-19-20-42-48.png" alt=""></p><p>捕捉两只彩蛋<br><img src="2023-01-19-20-44-16.png" alt=""></p><p>隔壁老奶奶一脸磕到的样子哈哈哈哈<br><img src="2023-01-19-20-51-26.png" alt=""></p><p>笑死我了不要细想<br><img src="2023-01-19-20-53-14.png" alt=""></p><p>又发现彩蛋，但是不认识，主要画风很不一样<br><img src="2023-01-19-20-58-47.png" alt=""></p><p>彩蛋又加 1，还是不认识<br><img src="2023-01-19-21-00-30.png" alt=""></p><p>真实，阿里巴巴曾是个快乐的青年<br><img src="2023-01-19-21-03-35.png" alt=""></p><p class="note note-info">我真的很讨厌那个太后</p><p>又发现彩蛋一枚，这次是金小黑<br><img src="2023-01-19-21-16-30.png" alt=""></p><p>王七：猫爷克星<br><img src="2023-01-19-21-23-40.png" alt=""></p><blockquote><p>：谁要让我再钻盒子，我就！。。。</p></blockquote><p>猫爷的眼睛真的好好看！<br><img src="2023-01-19-21-30-41.png" alt=""></p><p>失去药效的猫爷，太可爱了哈哈哈<br><img src="2023-01-19-21-38-17.png" alt=""><br><img src="2023-01-19-21-38-45.png" alt=""></p><p>崔倍十八变<br><img src="2023-01-19-21-45-19.png" alt=""><br><img src="2023-01-19-21-45-40.png" alt=""><br><img src="2023-01-19-21-45-52.png" alt=""><br><img src="2023-01-19-21-46-02.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>生活小记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>动漫</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试post_asset_folder</title>
    <link href="/2023/01/16/%E6%B5%8B%E8%AF%95post-asset-folder/"/>
    <url>/2023/01/16/%E6%B5%8B%E8%AF%95post-asset-folder/</url>
    
    <content type="html"><![CDATA[<p>项目配置文件<code>_config.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>在创建文章时同时在该目录创建同名文件夹存放图片</p><p><img src="2023-01-16-14-43-36.png" alt=""></p><p>引用图片，用相对路径</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs md">![](<span class="hljs-link">2023-01-16-14-43-36.png</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用Spark碰到内存不足</title>
    <link href="/2023/01/16/%E4%BD%BF%E7%94%A8Spark%E7%A2%B0%E5%88%B0%E5%86%85%E5%AD%98%E4%B8%8D%E8%B6%B3/"/>
    <url>/2023/01/16/%E4%BD%BF%E7%94%A8Spark%E7%A2%B0%E5%88%B0%E5%86%85%E5%AD%98%E4%B8%8D%E8%B6%B3/</url>
    
    <content type="html"><![CDATA[<p>原文链接：<a href="https://blog.csdn.net/qq_36055407/article/details/103976014">在使用 spark 时，碰到内存不足问题</a></p><blockquote><p>搬运过来自己查看方便</p><p><strong>遇到此问题可以创建 swap 交换区：</strong></p></blockquote><p>Linux 中 Swap（即：交换分区），类似于 Windows 的虚拟内存，就是当内存不足的时候，把一部分硬盘空间虚拟成内存使用,从而解决内存容量不足的情况。</p><h2 id="步骤：">步骤：</h2><p>1.使用 root 用户</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">su</span><br></code></pre></td></tr></table></figure><p>2.创建一个用于交换的文件</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">fallocate</span> -l <span class="hljs-number">2</span>G /swapfile<br></code></pre></td></tr></table></figure><p>3.设置正确的权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> 600 /swapfile<br></code></pre></td></tr></table></figure><p>4.设置 linux 交换区</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mkswap -f /swapfile<br></code></pre></td></tr></table></figure><p>5.启用交换</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">swapon /swapfile<br></code></pre></td></tr></table></figure><p>6.每次自动启用，则在 vim /etc/fstab 文件并添加以下行 ：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">/swapfile <span class="hljs-keyword">swap</span> <span class="hljs-keyword">swap</span> defaults <span class="hljs-number">0</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><blockquote><p>这一步我会报错，所以每次都需要启动</p></blockquote><p>7.查看</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">free -h</span><br></code></pre></td></tr></table></figure><p>显示如下则成功创建交换区：<br><img src="/img/post/2023-01-16-14-15-45.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>Ubuntu相关问题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spark</tag>
      
      <tag>Ubuntu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>为页脚添加网站运行时间与busuanzi计数</title>
    <link href="/2023/01/15/%E4%B8%BA%E9%A1%B5%E8%84%9A%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%AB%99%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E4%B8%8Ebusuanzi%E8%AE%A1%E6%95%B0/"/>
    <url>/2023/01/15/%E4%B8%BA%E9%A1%B5%E8%84%9A%E6%B7%BB%E5%8A%A0%E7%BD%91%E7%AB%99%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E4%B8%8Ebusuanzi%E8%AE%A1%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<p>记录自己的魔改，防止之后想要修改回来的时候找不到文件了 hhh</p><h2 id="添加网站运行时间">添加网站运行时间</h2><p>在<code>\themes\fluid\layout\_partials\footer.ejs</code>的<code>&lt;div class=&quot;footer-inner&quot;&gt;&lt;/div&gt;</code>中添加如下代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;/* 添加网站运行时间 */&#125;<br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;days&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">show_date_time</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-string">&quot;show_date_time()&quot;</span>, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">    <span class="hljs-title class_">BirthDay</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&quot;01/11/2023 20:02:02&quot;</span>); <span class="hljs-comment">//修改为自己的blog建站时间</span></span><br><span class="language-javascript">    today = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();</span><br><span class="language-javascript">    timeold = today.<span class="hljs-title function_">getTime</span>() - <span class="hljs-title class_">BirthDay</span>.<span class="hljs-title function_">getTime</span>();</span><br><span class="language-javascript">    sectimeold = timeold / <span class="hljs-number">1000</span>;</span><br><span class="language-javascript">    secondsold = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(sectimeold);</span><br><span class="language-javascript">    msPerDay = <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;</span><br><span class="language-javascript">    e_daysold = timeold / msPerDay;</span><br><span class="language-javascript">    daysold = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(e_daysold);</span><br><span class="language-javascript">    e_hrsold = (e_daysold - daysold) * <span class="hljs-number">24</span>;</span><br><span class="language-javascript">    hrsold = <span class="hljs-title function_">setzero</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(e_hrsold));</span><br><span class="language-javascript">    e_minsold = (e_hrsold - hrsold) * <span class="hljs-number">60</span>;</span><br><span class="language-javascript">    minsold = <span class="hljs-title function_">setzero</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e_hrsold - hrsold) * <span class="hljs-number">60</span>));</span><br><span class="language-javascript">    seconds = <span class="hljs-title function_">setzero</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e_minsold - minsold) * <span class="hljs-number">60</span>));</span><br><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;days&quot;</span>).<span class="hljs-property">innerHTML</span> =</span><br><span class="language-javascript">      <span class="hljs-string">&quot;本站已跌跌撞撞运行&quot;</span> +</span><br><span class="language-javascript">      daysold +</span><br><span class="language-javascript">      <span class="hljs-string">&quot;天&quot;</span> +</span><br><span class="language-javascript">      hrsold +</span><br><span class="language-javascript">      <span class="hljs-string">&quot;小时&quot;</span> +</span><br><span class="language-javascript">      minsold +</span><br><span class="language-javascript">      <span class="hljs-string">&quot;分&quot;</span> +</span><br><span class="language-javascript">      seconds +</span><br><span class="language-javascript">      <span class="hljs-string">&quot;秒&quot;</span>;</span><br><span class="language-javascript">  &#125;</span><br><span class="language-javascript">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">setzero</span>(<span class="hljs-params">i</span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">10</span>) &#123;</span><br><span class="language-javascript">      i = <span class="hljs-string">&quot;0&quot;</span> + i;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    <span class="hljs-keyword">return</span> i;</span><br><span class="language-javascript">  &#125;</span><br><span class="language-javascript">  <span class="hljs-title function_">show_date_time</span>();</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="修改-busuanzi">修改 busuanzi</h2><p>因为 live2d 与 busuanzi 同时使用时，会导致 busuanzi 没有办法显示数据，需要修改 busuanzi 的 js 文件，我没有找到在 fluid 主题中的 js 文件，所以就自己建了一个<code>\source\js\busuanzi.pure.min.js</code>（空文件），然后在下面插入如下代码</p><p><span class="label label-warning">如果能找到自己主题的该文件那就删去原本文件的内容复制下面代码</span></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> bszCaller, bszTag;<br>!(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> c,<br>    d,<br>    e,<br>    a = !<span class="hljs-number">1</span>,<br>    b = [];<br>  (ready = <span class="hljs-keyword">function</span> (<span class="hljs-params">c</span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>      a ||<br>      <span class="hljs-string">&quot;interactive&quot;</span> === <span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> ||<br>      <span class="hljs-string">&quot;complete&quot;</span> === <span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span><br>        ? c.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">document</span>)<br>        : b.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> c.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);<br>          &#125;),<br>      <span class="hljs-variable language_">this</span><br>    );<br>  &#125;),<br>    (d = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>, c = b.<span class="hljs-property">length</span>; c &gt; a; a++) b[a].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">document</span>);<br>      b = [];<br>    &#125;),<br>    (e = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      a ||<br>        ((a = !<span class="hljs-number">0</span>),<br>        d.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">window</span>),<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">removeEventListener</span><br>          ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, e, !<span class="hljs-number">1</span>)<br>          : <span class="hljs-variable language_">document</span>.<span class="hljs-property">attachEvent</span> &amp;&amp;<br>            (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">detachEvent</span>(<span class="hljs-string">&quot;onreadystatechange&quot;</span>, e),<br>            <span class="hljs-variable language_">window</span> == <span class="hljs-variable language_">window</span>.<span class="hljs-property">top</span> &amp;&amp; (<span class="hljs-built_in">clearInterval</span>(c), (c = <span class="hljs-literal">null</span>))));<br>    &#125;),<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">addEventListener</span><br>      ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;DOMContentLoaded&quot;</span>, e, !<span class="hljs-number">1</span>)<br>      : <span class="hljs-variable language_">document</span>.<span class="hljs-property">attachEvent</span> &amp;&amp;<br>        (<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">attachEvent</span>(<span class="hljs-string">&quot;onreadystatechange&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>          <span class="hljs-regexp">/loaded|complete/</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span>) &amp;&amp; <span class="hljs-title function_">e</span>();<br>        &#125;),<br>        <span class="hljs-variable language_">window</span> == <span class="hljs-variable language_">window</span>.<span class="hljs-property">top</span> &amp;&amp;<br>          (c = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>              a || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-title function_">doScroll</span>(<span class="hljs-string">&quot;left&quot;</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (b) &#123;<br>              <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-title function_">e</span>();<br>          &#125;, <span class="hljs-number">5</span>)));<br>&#125;)(),<br>  (bszCaller = &#123;<br>    <span class="hljs-attr">fetch</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br>      <span class="hljs-keyword">var</span> c = <span class="hljs-string">&quot;BusuanziCallback_&quot;</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-number">1099511627776</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>());<br>      (<span class="hljs-variable language_">window</span>[c] = <span class="hljs-variable language_">this</span>.evalCall(b)),<br>        (a = a.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&quot;=BusuanziCallback&quot;</span>, <span class="hljs-string">&quot;=&quot;</span> + c)),<br>        (scriptTag = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;SCRIPT&quot;</span>)),<br>        (scriptTag.<span class="hljs-property">type</span> = <span class="hljs-string">&quot;text/javascript&quot;</span>),<br>        (scriptTag.<span class="hljs-property">defer</span> = !<span class="hljs-number">0</span>),<br>        (scriptTag.<span class="hljs-property">src</span> = a),<br>        (scriptTag.<span class="hljs-property">referrerPolicy</span> = <span class="hljs-string">&quot;no-referrer-when-downgrade&quot;</span>),<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&quot;HEAD&quot;</span>)[<span class="hljs-number">0</span>].<span class="hljs-title function_">appendChild</span>(scriptTag);<br>    &#125;,<br>    <span class="hljs-attr">evalCall</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">b</span>) &#123;<br>        <span class="hljs-title function_">ready</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-title function_">a</span>(b),<br>              (s = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;[src*=BusuanziCallback]&quot;</span>)),<br>              s.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">removeChild</span>(s);<br>          &#125; <span class="hljs-keyword">catch</span> (c) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(c), bszTag.<span class="hljs-title function_">hides</span>();<br>          &#125;<br>        &#125;);<br>      &#125;;<br>    &#125;,<br>  &#125;),<br>  bszCaller.<span class="hljs-title function_">fetch</span>(<br>    <span class="hljs-string">&quot;//busuanzi.ibruce.info/busuanzi?jsonpCallback=BusuanziCallback&quot;</span>,<br>    <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>      bszTag.<span class="hljs-title function_">texts</span>(a), bszTag.<span class="hljs-title function_">shows</span>();<br>    &#125;<br>  ),<br>  (bszTag = &#123;<br>    <span class="hljs-attr">bszs</span>: [<span class="hljs-string">&quot;site_pv&quot;</span>, <span class="hljs-string">&quot;page_pv&quot;</span>, <span class="hljs-string">&quot;site_uv&quot;</span>],<br>    <span class="hljs-attr">texts</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">bszs</span>.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">b</span>) &#123;<br>        <span class="hljs-keyword">var</span> c = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;busuanzi_value_&quot;</span> + b);<br>        c &amp;&amp; (c.<span class="hljs-property">innerHTML</span> = a[b]);<br>      &#125;);<br>    &#125;,<br>    <span class="hljs-attr">hides</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">bszs</span>.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;busuanzi_container_&quot;</span> + a);<br>        b &amp;&amp; (b.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>);<br>      &#125;);<br>    &#125;,<br>    <span class="hljs-attr">shows</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">bszs</span>.<span class="hljs-title function_">map</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) &#123;<br>        <span class="hljs-keyword">var</span> b = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;busuanzi_container_&quot;</span> + a);<br>        b &amp;&amp; (b.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;inline&quot;</span>);<br>      &#125;);<br>    &#125;,<br>  &#125;);<br></code></pre></td></tr></table></figure><p>在<code>\themes\fluid\layout\_partials\footer.ejs</code>插入下列代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;/* 重新定义busuanzi */&#125;<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/js/busuanzi.pure.mini.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;busuanzi_container_site_pv&quot;</span>&gt;</span><br>  总访问量<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;busuanzi_value_site_pv&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>次<br><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;busuanzi_container_site_uv&quot;</span>&gt;</span><br>  总访客数<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;busuanzi_value_site_uv&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>人<br><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br></code></pre></td></tr></table></figure><p>记得将主题配置文件<code>_config.yml</code>中<code>statics</code>设置为<code>false</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">statistics:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>在主题配置文件中引入 js（不确定是否必要，但以防万一还是引入吧）</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">custom_js:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">/js/busuanzi.pure.mini.js</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>hexo-fluid</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>busuanzi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>音乐播放器</title>
    <link href="/2023/01/15/%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/"/>
    <url>/2023/01/15/%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="网易云音乐的-iframe-插件">网易云音乐的 iframe 插件</h2><p>自己选择一个歌单或者一首歌，创建 iframe 插件<br><img src="/img/post/2023-01-15-12-56-39.png" alt=""></p><p>选择自己想要的尺寸以及播放模式<br><img src="/img/post/2023-01-15-12-58-22.png" alt=""></p><p>复制该 html 代码<br><img src="/img/post/2023-01-15-12-58-49.png" alt=""></p><p>放置在你想放置在博客的位置</p><p>我是放置在导航栏的位置<br><img src="/img/post/2023-01-15-13-11-14.png" alt=""></p><p>添加方法：在<code>themes\fluid\layout\_partitials\header\navigation.ejs</code>插入刚刚复制的代码<br><img src="/img/post/2023-01-15-13-15-57.png" alt=""></p><p>重启<code>hexo s</code>之后就能在导航栏看见了</p><h2 id="aplayer-插件">aplayer 插件</h2><p>当时接着弄 aplayer 是因为切换页面音乐就停了，然后改用 aplayer，<strong>结果发现 fluid 主题好像不支持 pjax？？</strong></p><p>alpayer 主要能吸底跟切歌吧，比网易的插件好一丢</p><p><strong>添加方法：</strong></p><p>安装 aplayer</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save hexo-tag-aplayer<br></code></pre></td></tr></table></figure><p>在主题配置文件<code>_config.yml</code>的<code>custom_html</code>添加以下代码：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">custom_html:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css&quot;&gt;</span><br><span class="hljs-string">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/pjax@VERSION/pjax.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="hljs-string">&lt;meting-js server=&quot;netease&quot; type=&quot;playlist&quot; id=&quot;8051474154&quot; fixed=&quot;true&quot;&gt;&lt;/meting-js&gt;</span><br><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>其中：</p><ul><li>server 是音乐的来源，有以下参数：<code>netease</code>, <code>tencent</code>, <code>kugou</code>, <code>xiami</code>, <code>baidu</code></li><li>type:<code>song</code>, <code>playlist</code>, <code>album</code>, <code>search</code>, <code>artist</code></li><li>id 是歌单或者歌曲对应的 id，就在网址里<br><img src="/img/post/2023-01-15-15-03-36.png" alt=""></li></ul><p>其他参数自行参考<a href="https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md">aplayer</a></p><p class="note note-info">可能会出现就是没有custom_html这个东西，那就整段添加上去就行</p><blockquote><p>有没有能手动添加 pjax 的呀？</p></blockquote><p>关闭歌词：添加<code>lrc-type= &quot;0&quot;</code></p>]]></content>
    
    
    <categories>
      
      <category>hexo-fluid</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文章信息设置</title>
    <link href="/2023/01/14/%E6%96%87%E7%AB%A0%E4%BF%A1%E6%81%AF%E8%AE%BE%E7%BD%AE/"/>
    <url>/2023/01/14/%E6%96%87%E7%AB%A0%E4%BF%A1%E6%81%AF%E8%AE%BE%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">文章标题</span><br><span class="hljs-attr">date:</span> <span class="hljs-string">yyyy-mm-dd</span> <span class="hljs-string">hh:mm:ss</span><br><span class="hljs-attr">tags:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">标签1</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">标签2</span><br><span class="hljs-attr">categories:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">分类1</span><br><span class="hljs-attr">excerpt:</span> <span class="hljs-string">摘要</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><h2 id="文章摘要">文章摘要</h2><p>开关自动摘要：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">index:</span><br>  <span class="hljs-attr">auto_excerpt:</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>手动指定摘要：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">正文的一部分作为摘要<br><span class="hljs-comment">&lt;!-- more --&gt;</span><br>余下的正文<br></code></pre></td></tr></table></figure><p><strong>设置<code>excerpt</code>字段</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">这是标题</span><br><span class="hljs-attr">excerpt:</span> <span class="hljs-string">这是摘要</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><h2 id="文章排序">文章排序</h2><p>如果想手动将某些文章固定在首页靠前的位置，可以在安装 <code>hexo-generator-index</code> &gt;= 2.0.0 版本的情况下，在文章开头中配置 sticky 属性</p><p>安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs BASH">$ npm install hexo-generator-index<br></code></pre></td></tr></table></figure><p>配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">文章标题</span><br><span class="hljs-attr">index_img:</span> <span class="hljs-string">/img/example.jpg</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2019-10-10 10:00:00</span><br><span class="hljs-attr">sticky:</span> <span class="hljs-number">100</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">以下是文章内容</span><br></code></pre></td></tr></table></figure><p><code>sticky</code> 数值越大，该文章越靠前，达到类似于置顶的效果，其他未设置的文章依然按默认排序。</p><p>当文章设置了<code>sticky</code> 后，主题会默认在首页文章标题前增加一个图标，来标识这是一个置顶文章</p><h2 id="文章在首页的封面图">文章在首页的封面图</h2><p>对于单篇文章，在文章开头中配置 <code>index_img</code> 属性。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">文章标题</span><br><span class="hljs-attr">tags:</span> [<span class="hljs-string">Hexo</span>, <span class="hljs-string">Fluid</span>]<br><span class="hljs-attr">index_img:</span> <span class="hljs-string">/img/example.jpg</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2019-10-10 10:00:00</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">以下是文章内容</span><br></code></pre></td></tr></table></figure><p><code>/img/example.jpg</code> 对应的是存放在<code>/source/img/example.jpg</code> 目录下的图片（目录也可自定义，但必须在 <code>source</code> 目录下）。</p><p>也可以使用外链 Url 的绝对路径。</p><p>如果想统一给文章设置一个默认图片（文章不设置 index_img 则默认使用这张图片），可在主题配置中设置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">default_index_img:</span> <span class="hljs-string">/img/example.jpg</span><br></code></pre></td></tr></table></figure><h2 id="单个文章的顶部大图">单个文章的顶部大图</h2><p>在 <code>Front-matter </code>中指定 <code>banner_img</code> 属性。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">文章标题</span><br><span class="hljs-attr">tags:</span> [<span class="hljs-string">Hexo</span>, <span class="hljs-string">Fluid</span>]<br><span class="hljs-attr">index_img:</span> <span class="hljs-string">/img/example.jpg</span><br><span class="hljs-attr">banner_img:</span> <span class="hljs-string">/img/post_banner.jpg</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2019-10-10 10:00:00</span><br><span class="hljs-meta">---</span><br><span class="hljs-string">以下是文章内容</span><br></code></pre></td></tr></table></figure><h2 id="脚注语法">脚注语法</h2><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs md">这是一句话[^1]<br>[<span class="hljs-symbol">^1</span>]: <span class="hljs-link">这是对应的脚注</span><br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs md">正文<br><br><span class="hljs-section">## 参考</span><br><br>[<span class="hljs-symbol">^1</span>]: <span class="hljs-link">参考资料 1</span><br>[<span class="hljs-symbol">^2</span>]: <span class="hljs-link">参考资料 2</span><br></code></pre></td></tr></table></figure><h2 id="Tag-插件">Tag 插件</h2><h3 id="便签">便签</h3><p>使用 HTML 形式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;note note-primary&quot;</span>&gt;</span>标签<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><p>可选便签</p><p class="note note-primary">primary</p><p class="note note-secondary">secondary</p><p class="note note-success">success</p><p class="note note-danger">danger</p><p class="note note-warning">warning</p><p class="note note-info">info</p><p class="note note-light">light</p><h3 id="行内标签">行内标签</h3><p>使用 Label：</p><p>HTML 形式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;label label-primary&quot;</span>&gt;</span>Label<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br></code></pre></td></tr></table></figure><p>可选 Label：<br><span class="label label-primary">primary</span><br><span class="label label-default">default</span><br><span class="label label-info">info</span><br><span class="label label-success">success</span><br><span class="label label-warning">warning</span><br><span class="label label-danger">danger</span></p><h3 id="按钮">按钮</h3><p>使用 HTML 形式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>text<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>url：跳转链接<br>text：显示的文字<br>title：鼠标悬停时显示的文字（可选）</p><p><a class="btn" href="url" title="title">text</a></p><p class="note note-danger">文章要从二级标题设起，因为一级标题会直接到顶部，就没有导航的效果了</p>]]></content>
    
    
    <categories>
      
      <category>hexo-fluid</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>留言板的制作</title>
    <link href="/2023/01/14/%E7%95%99%E8%A8%80%E6%9D%BF%E7%9A%84%E5%88%B6%E4%BD%9C/"/>
    <url>/2023/01/14/%E7%95%99%E8%A8%80%E6%9D%BF%E7%9A%84%E5%88%B6%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="新建一个页面">新建一个页面</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs BASH">hexo n page <span class="hljs-string">&quot;留言板&quot;</span><br></code></pre></td></tr></table></figure><p>在<code>博客根目录/sourse</code>下就会出现<code>留言板</code>文件夹，内有一文件<code>index.md</code></p><p>然后在导航栏添加留言板的按钮，修改主题配置<code>_config.yml</code>，这里 icon 可以自己选择<br><img src="/img/post/2023-01-14-20-00-14.png" alt=""></p><p>页面就建完了！此时页面是空的，接下来添加模块</p><h2 id="念两句诗模块">念两句诗模块</h2><p>在留言板文件夹中的<code>index.md</code>添加如下代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;poem-wrap&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;poem-border poem-left&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;poem-border poem-right&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h</span>&gt;</span>念两句诗<span class="hljs-tag">&lt;/<span class="hljs-name">h</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;poem&quot;</span>&gt;</span>挑选中/img/post.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://sdk.jinrishici.com/v2/browser/jinrishici.js&quot;</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    jinrishici.<span class="hljs-title function_">load</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) &#123;</span><br><span class="language-javascript">      <span class="hljs-keyword">var</span> poem1 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#poem&quot;</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> info = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#info&quot;</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> sentenceText = result.<span class="hljs-property">data</span>.<span class="hljs-property">content</span></span><br><span class="language-javascript">            poem1.<span class="hljs-property">innerHTML</span> = sentenceText</span><br><span class="language-javascript">            info.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;【&#x27;</span> + result.<span class="hljs-property">data</span>.<span class="hljs-property">origin</span>.<span class="hljs-property">dynasty</span> + <span class="hljs-string">&#x27;】&#x27;</span> + result.<span class="hljs-property">data</span>.<span class="hljs-property">origin</span>.<span class="hljs-property">author</span> + <span class="hljs-string">&#x27;《&#x27;</span> + result.<span class="hljs-property">data</span>.<span class="hljs-property">origin</span>.<span class="hljs-property">title</span> + <span class="hljs-string">&#x27;》&#x27;</span></span><br><span class="language-javascript">  &#125;);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>在主题文件夹下新建文件<code>ancientPoetry.css</code>，其中写如下代码</p><div class="note note-danger">            <p>字体需自己设置，或者使用默认</p>          </div><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/*诗*/</span><br><span class="hljs-selector-class">.poem-wrap</span> &#123;<br>  <span class="hljs-attribute">position</span>: relative;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">730px</span>;<br>  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">80%</span>;<br>  <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#797979</span>;<br>  <span class="hljs-attribute">border-top</span>: none;<br>  <span class="hljs-attribute">text-align</span>: center;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">80px</span> auto;<br>  <span class="hljs-comment">/* font-family: HongLeiXingShuJianTi; //全局字体 */</span><br>&#125;<br><br><span class="hljs-selector-class">.poem-wrap</span> h &#123;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32px</span>;<br>  <span class="hljs-attribute">font-style</span>: oblique;<br>  <span class="hljs-attribute">position</span>: relative;<br>  <span class="hljs-attribute">margin-top</span>: -<span class="hljs-number">40px</span>;<br>  <span class="hljs-attribute">display</span>: inline-block;<br>  <span class="hljs-attribute">letter-spacing</span>: <span class="hljs-number">4px</span>;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#797979</span>;<br>  <span class="hljs-comment">/* font-family: KaiTi;   // 念两句诗字体 */</span><br>&#125;<br><br><span class="hljs-selector-class">.poem-wrap</span> <span class="hljs-selector-tag">p</span> &#123;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">70%</span>;<br>  <span class="hljs-attribute">margin</span>: auto;<br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">40px</span>;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#797979</span>;<br>&#125;<br><br><span class="hljs-selector-class">.poem-wrap</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-id">#poem</span> &#123;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">32px</span>;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span> auto;<br>&#125;<br><br><span class="hljs-selector-class">.poem-wrap</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-id">#info</span> &#123;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">22px</span>;<br>  <span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span> auto;<br>  <span class="hljs-comment">/* font-family: KaiTi;   // 来源字体 */</span><br>&#125;<br><br><span class="hljs-selector-class">.poem-border</span> &#123;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">2px</span>;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">27%</span>;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#797979</span>;<br>&#125;<br><br><span class="hljs-selector-class">.poem-right</span> &#123;<br>  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-selector-class">.poem-left</span> &#123;<br>  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">685px</span>) &#123;<br>  <span class="hljs-selector-class">.poem-border</span> &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">18%</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">500px</span>) &#123;<br>  <span class="hljs-selector-class">.poem-wrap</span> &#123;<br>    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">60px</span>;<br>    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;<br>    <span class="hljs-attribute">border-top</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#797979</span>;<br>  &#125;<br><br>  <span class="hljs-selector-class">.poem-wrap</span> h &#123;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> <span class="hljs-number">6px</span>;<br>  &#125;<br><br>  <span class="hljs-selector-class">.poem-border</span> &#123;<br>    <span class="hljs-attribute">display</span>: none;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/* @font-face &#123;</span><br><span class="hljs-comment">  font-family: HongLeiXingShuJianTi;    // 引入的字体</span><br><span class="hljs-comment">  src: url(&quot;/font/HongLeiXingShuJianTi-2.otf&quot;);</span><br><span class="hljs-comment">&#125; */</span><br></code></pre></td></tr></table></figure><p>在主题配置文件<code>_config.yml</code>引入 css 文件<br><img src="/img/post/2023-01-14-20-07-59.png" alt=""></p><p>刷新页面，念两句诗模块增加了</p><h2 id="留言板模块">留言板模块</h2><p>这边用的是 valine 的评论功能，初始化请参考<a href="https://hexo.fluid-dev.com/docs/guide/#%E8%AF%84%E8%AE%BA">Hexo Fluid 用户手册</a></p><p>在<code>index.md</code>首部添加：</p><p><img src="/img/post/2023-01-14-20-18-05.png" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>hexo-fluid</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>valine</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>首页随机一言</title>
    <link href="/2023/01/14/%E9%A6%96%E9%A1%B5%E9%9A%8F%E6%9C%BA%E4%B8%80%E8%A8%80/"/>
    <url>/2023/01/14/%E9%A6%96%E9%A1%B5%E9%9A%8F%E6%9C%BA%E4%B8%80%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<h2 id="效果">效果</h2><p>如首页所示，每一次刷新是一句随机一言</p><h2 id="具体操作">具体操作</h2><p>在主题配置<code>_config.yml</code>中找到首页副标题的设置<code>slogan-api</code>，按照图片所示输入</p><p><img src="/img/post/2023-01-14-15-43-21.png" alt=""></p><p>然后就实现了！</p><p>api 接口说明：</p><ul><li><code>https://v1.hitokoto.cn/</code>，从 7 种分类中随机选取</li><li><code>https://v1.hitokoto.cn/?c=b</code>，从 b 类选取</li><li><code>https://v1.hitokoto.cn/?c=b&amp;c=a</code>，从 a 类和 b 类中选取（选取多类）</li><li><code>https://v1.hitokoto.cn/?c=f&amp;encode=text</code>，选取 f 类，并以纯文本形式输出</li></ul><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>a</td><td>动画</td></tr><tr><td>b</td><td>漫画</td></tr><tr><td>c</td><td>游戏</td></tr><tr><td>d</td><td>文学</td></tr><tr><td>f</td><td>原创</td></tr><tr><td>g</td><td>来自网络</td></tr><tr><td>h</td><td>其他</td></tr><tr><td>i</td><td>影视</td></tr><tr><td>j</td><td>诗词</td></tr><tr><td>k</td><td>网易云</td></tr><tr><td>l</td><td>哲学</td></tr><tr><td>其他</td><td>抖机灵</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>hexo-fluid</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>API</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/01/13/hello-world/"/>
    <url>/2023/01/13/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>作业4：Spark DataFrame编程</title>
    <link href="/2023/01/05/%E4%BD%9C%E4%B8%9A4%EF%BC%9ASpark-DataFrame%E7%BC%96%E7%A8%8B/"/>
    <url>/2023/01/05/%E4%BD%9C%E4%B8%9A4%EF%BC%9ASpark-DataFrame%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1>Spark DataFrame 编程</h1><h2 id="第一题-cafe-店">第一题 cafe 店</h2><p>Coffee Chain.csv 数据字段如下：</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs fortran">Area Code 区号<br>Ddate 统计日期<br>Market 市场位置<br>Market <span class="hljs-built_in">Size</span> 市场规模<br><span class="hljs-built_in">Product</span> 产品<br><span class="hljs-built_in">Product</span> <span class="hljs-keyword">Type</span> 产品类别<br>State 所在州<br><span class="hljs-keyword">Type</span> 产品属性<br>Budget Cogs 预算成本<br>Budget Margin 预算盈余<br>Budget Profit 利润预算<br>Budget Sales 销售预算<br>Coffee Sales 实际销售<br>Cogs 实际成本<br>Inventory 库存<br>Margin 实际盈余<br>Marketing 销售量<br><span class="hljs-keyword">Number</span> of Records 记录数<br>Profit 实际利润<br>Total Expenses 其他成本<br></code></pre></td></tr></table></figure><p><strong>转换成 dataframe</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> filepath = <span class="hljs-string">&quot;Coffee_Chain.csv&quot;</span><br><span class="hljs-keyword">val</span> df = spark.read.options(<span class="hljs-type">Map</span>(<span class="hljs-string">&quot;inferSchema&quot;</span>-&gt;<span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;delimiter&quot;</span>-&gt;<span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;header&quot;</span>-&gt;<span class="hljs-string">&quot;true&quot;</span>)).csv(filepath) <span class="hljs-comment">//创建dataframe</span><br>df.createOrReplaceTempView(<span class="hljs-string">&quot;coffee&quot;</span>)        <span class="hljs-comment">//创建视图</span><br></code></pre></td></tr></table></figure><p>查看咖啡连锁店的销售量排行，按照销售量降序排列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> a = spark.sql(<span class="hljs-string">&quot;select product, sum(Marketing) as number from coffee group by product order by number desc&quot;</span>)<br>a.show<br></code></pre></td></tr></table></figure><p>查看咖啡销售量和所在州的关系，按降序排列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> b = spark.sql(<span class="hljs-string">&quot;select market, state, sum(Marketing) as number from coffee group by state,market order by number desc&quot;</span>)<br></code></pre></td></tr></table></figure><p>查询咖啡的平均利润和售价，按平均利润降序排列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> c = spark.sql(<span class="hljs-string">&quot;select product, avg(`Coffee Sales`), avg(profit) as avg_profit from coffee group by product order by avg_profit desc&quot;</span>)<br></code></pre></td></tr></table></figure><p>查询市场规模、市场地域与销售量的关系，按总销量降序排列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> d = spark.sql(<span class="hljs-string">&quot;select Market, `Market Size`, sum(`Coffee Sales`) as total_sales from coffee group by Market, `Market Size` order by total_sales desc&quot;</span>)<br></code></pre></td></tr></table></figure><p>查询咖啡属性与平均售价、平均利润、销售量与其他成本的关系</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> b = spark.sql(<span class="hljs-string">&quot;</span><br><span class="hljs-string">    select a.type,</span><br><span class="hljs-string">           avg(a.`Coffee Sales`) as avg_sales,      //平均售价</span><br><span class="hljs-string">           avg(profit) as avg_profit,               //平均利润</span><br><span class="hljs-string">           sum(b.number) as total_sales,            //销售量</span><br><span class="hljs-string">           avg(a.`Total Expenses`) as other_cost    //其他成本</span><br><span class="hljs-string">    from coffee as a, (select product, sum(Marketing) as number from coffee group by product) as b //b：产品名，销售量</span><br><span class="hljs-string">    where a.product == b.product</span><br><span class="hljs-string">    group by a.type</span><br><span class="hljs-string">    order by total_sales desc&quot;</span>)     <span class="hljs-comment">//销售量降序排列</span><br></code></pre></td></tr></table></figure><h2 id="第二题：实现用户每天搜索前-3-名的商品排名统计（广播变量）">第二题：实现用户每天搜索前 3 名的商品排名统计（广播变量）</h2><p><strong>（1）查询每天每用户点击某商品的次数</strong><br>从 Spark 读入用户搜索日志记录，使用广播变量，将要过滤的用户终端类型（安卓、苹果、平板）进行广播，查询每天每用户点击某商品的次数，生成 key-value 键值对（建议将日期、商品、用户 ID 组成 key 值，每次计数为 1）</p><p>广播变量</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> broadcast = spark.sparkContext.broadcast(<span class="hljs-type">Array</span>(<span class="hljs-string">&quot;android&quot;</span>, <span class="hljs-string">&quot;iphone&quot;</span>, <span class="hljs-string">&quot;ipad&quot;</span>))<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.&#123;<span class="hljs-type">DataFrame</span>, <span class="hljs-type">Row</span>, <span class="hljs-type">SparkSession</span>&#125;<br><span class="hljs-keyword">val</span> a = sc.textFile(filePath).map(x=&gt;x.split(<span class="hljs-string">&quot;\t&quot;</span>)).filter(x=&gt;x.length&gt;<span class="hljs-number">0</span>)<br>        .map(x=&gt;<span class="hljs-type">Row</span>(x(<span class="hljs-number">0</span>),x(<span class="hljs-number">1</span>),x(<span class="hljs-number">2</span>))).map(x=&gt;(x,<span class="hljs-number">1</span>)).reduceByKey(_+_)<br>        .map(x=&gt;<span class="hljs-type">Row</span>(x._1.getString(<span class="hljs-number">0</span>), x._1.getString(<span class="hljs-number">1</span>), x._1.getString(<span class="hljs-number">2</span>), x._2))<br>        .collect()      <span class="hljs-comment">//[时间，用户ID，商品，点击次数]</span><br></code></pre></td></tr></table></figure><p><strong>（2）统计用户在每天点击搜索每个商品的总次数</strong><br>对于步骤一记录的 key-value 键值对，将用户每天点击商品的次数汇总累加，统计 Key 值的汇总计数，即每用户在每天点击搜索每个商品的总次数，本步骤输出为 json 格式</p><p>导入包</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.types.&#123;<span class="hljs-type">StructType</span>, <span class="hljs-type">StructField</span>, <span class="hljs-type">StringType</span>, <span class="hljs-type">IntegerType</span>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> b = <span class="hljs-type">StructType</span>(<span class="hljs-type">Array</span>(<span class="hljs-type">StructField</span>(<span class="hljs-string">&quot;Date&quot;</span>, <span class="hljs-type">StringType</span>), <span class="hljs-type">StructField</span>(<span class="hljs-string">&quot;UserID&quot;</span>, <span class="hljs-type">StringType</span>), <span class="hljs-type">StructField</span>(<span class="hljs-string">&quot;Item&quot;</span>, <span class="hljs-type">StringType</span>), <span class="hljs-type">StructField</span>(<span class="hljs-string">&quot;Count&quot;</span>, <span class="hljs-type">IntegerType</span>)))<br></code></pre></td></tr></table></figure><p>输出为 json 格式</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> df = spark.createDataFrame(a,b)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DataFrame</tag>
      
      <tag>Spark</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>作业3：编写Spark独立应用程序</title>
    <link href="/2023/01/05/%E4%BD%9C%E4%B8%9A3%EF%BC%9A%E7%BC%96%E5%86%99Spark%E7%8B%AC%E7%AB%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/"/>
    <url>/2023/01/05/%E4%BD%9C%E4%B8%9A3%EF%BC%9A%E7%BC%96%E5%86%99Spark%E7%8B%AC%E7%AB%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<h1>编写 Spark 独立应用程序</h1><h2 id="编写独立应用程序实现数据去重">编写独立应用程序实现数据去重</h2><p>对于两个输入文件 A 和 B，编写 Spark 独立应用程序，对两个文件进行合并，并剔除其中重复的内容，得到一个新的文件 C</p><p>输入文件 A</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">20170101 </span>x<br><span class="hljs-symbol">20170102 </span>y<br><span class="hljs-symbol">20170103 </span>x<br><span class="hljs-symbol">20170104 </span>y<br><span class="hljs-symbol">20170105 </span>z<br><span class="hljs-symbol">20170106 </span>z<br></code></pre></td></tr></table></figure><p>输入文件 B</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">20170101 </span>y<br><span class="hljs-symbol">20170102 </span>y<br><span class="hljs-symbol">20170103 </span>x<br><span class="hljs-symbol">20170104 </span>z<br><span class="hljs-symbol">20170105 </span>y<br></code></pre></td></tr></table></figure><p>输出文件 C</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">20170101 </span>x<br><span class="hljs-symbol">20170101 </span>y<br><span class="hljs-symbol">20170102 </span>y<br><span class="hljs-symbol">20170103 </span>x<br><span class="hljs-symbol">20170104 </span>y<br><span class="hljs-symbol">20170104 </span>z<br><span class="hljs-symbol">20170105 </span>y<br><span class="hljs-symbol">20170105 </span>z<br><span class="hljs-symbol">20170106 </span>z<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span><br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span>._<br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkConf</span><br><br><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">proj1</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>])&#123;<br>        <span class="hljs-keyword">val</span> conf = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>().setAppName(<span class="hljs-string">&quot;proj1&quot;</span>)<br>        <span class="hljs-keyword">val</span> sc = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkContext</span>(conf)<br><br>        <span class="hljs-keyword">val</span> dataA = sc.textFile(<span class="hljs-string">&quot;file:///media/sf_virtualbox-sharefiles/1/input/A.txt&quot;</span>)<br>        <span class="hljs-keyword">val</span> dataB = sc.textFile(<span class="hljs-string">&quot;file:///media/sf_virtualbox-sharefiles/1/input/B.txt&quot;</span>)<br>        <span class="hljs-keyword">val</span> data = dataA.union(dataB)       <span class="hljs-comment">//合并</span><br>        <span class="hljs-keyword">val</span> data_distinct = data.distinct   <span class="hljs-comment">//去重</span><br>        data_distinct.saveAsTextFile(<span class="hljs-string">&quot;file:///usr/local/spark-3.1.2-withHive/mycode/Proj1/result1&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="编写独立应用程序实现求平均值问题">编写独立应用程序实现求平均值问题</h2><p>每个输入文件表示班级学生某个学科的成绩，每行内由两个字段组成，第一个是<strong>学生名字</strong>，第二个是<strong>学生成绩</strong>；编写 Spark 独立应用程序求出所有学生的平均成绩，并输入到一个新文件中</p><p>Algorithm.txt</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs">小明 92<br>小红 87<br>小新 82<br>小丽 90<br></code></pre></td></tr></table></figure><p>Database.txt</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs">小明 95<br>小红 81<br>小新 89<br>小丽 85<br></code></pre></td></tr></table></figure><p>Python.txt</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs">小明 82<br>小红 83<br>小新 94<br>小丽 91<br></code></pre></td></tr></table></figure><p>result</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clojure"> (小红<span class="hljs-punctuation">,</span><span class="hljs-number">83.67</span>)<br> (小新<span class="hljs-punctuation">,</span><span class="hljs-number">88.33</span>)<br> (小明<span class="hljs-punctuation">,</span><span class="hljs-number">89.67</span>)<br>(小丽<span class="hljs-punctuation">,</span><span class="hljs-number">88.67</span>)<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">proj2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>])&#123;<br>        <span class="hljs-keyword">val</span> conf = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>().setAppName(<span class="hljs-string">&quot;proj2&quot;</span>)<br>        <span class="hljs-keyword">val</span> sc = <span class="hljs-type">SparkContext</span>(conf)<br><br>        <span class="hljs-keyword">val</span> ac = sc.textFile(<span class="hljs-string">&quot;Algorithm.txt&quot;</span>)<br>        <span class="hljs-keyword">val</span> dc = sc.textFile(<span class="hljs-string">&quot;Database.txt&quot;</span>)<br>        <span class="hljs-keyword">val</span> pc = sc.textFile(<span class="hljs-string">&quot;Python.txt&quot;</span>)<br>        <span class="hljs-keyword">val</span> scores = ac.union(dc).union(pc) <span class="hljs-comment">//将数据合并</span><br>        <span class="hljs-keyword">val</span> sum = scores.map(line=&gt;(line.split(<span class="hljs-string">&quot;\t&quot;</span>)(<span class="hljs-number">0</span>),line.split(<span class="hljs-string">&quot;\t&quot;</span>)(<span class="hljs-number">1</span>).toDouble)).reduceByKey((x,y)=&gt;x+y)<br>        <span class="hljs-keyword">val</span> avg = sum.map(x=&gt;(x._1,x._2/<span class="hljs-number">3.0</span>))   <span class="hljs-comment">//计算平均分</span><br><br>        avg.saveAsTextFile(<span class="hljs-string">&quot;result&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="第三题">第三题</h2><p>对于文件 people.txt，该文件包含了序号、姓别和身高三个列，形式如下</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>  F   <span class="hljs-number">168</span><br><span class="hljs-symbol">1 </span>  F   <span class="hljs-number">141</span><br><span class="hljs-symbol">2 </span>  M   <span class="hljs-number">184</span><br></code></pre></td></tr></table></figure><p>编写 Spark 应用程序，计算得到男性总数、女性总数、男性最高身高、女性最高身高、男性最低身高、女性最低身高、男性平均身高、女性平均身高</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span><br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span>._<br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkConf</span><br><br><span class="hljs-keyword">import</span> org.apache.hadoop.conf.<span class="hljs-type">Configuration</span><br><span class="hljs-keyword">import</span> org.apache.hadoop.fs.<span class="hljs-type">FileSystem</span><br><span class="hljs-keyword">import</span> org.apache.hadoop.fs.<span class="hljs-type">Path</span><br><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">PrintWriter</span><br><br><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">proj3</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>])&#123;<br>        <span class="hljs-keyword">val</span> conf = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>().setAppName(<span class="hljs-string">&quot;proj3&quot;</span>)<br>        <span class="hljs-keyword">val</span> sc = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkContext</span>(conf)<br><br>        <span class="hljs-keyword">val</span> data = sc.textFile(<span class="hljs-string">&quot;people.txt&quot;</span>)<br><br>        <span class="hljs-keyword">val</span> datac = data.map(line=&gt;(line.split(<span class="hljs-string">&quot;\t&quot;</span>)(<span class="hljs-number">1</span>),(line.split(<span class="hljs-string">&quot;\t&quot;</span>)(<span class="hljs-number">2</span>),<span class="hljs-number">1</span>)))   <span class="hljs-comment">//(F,(168,1))</span><br>        <span class="hljs-keyword">val</span> datam = datac.filter(x=&gt;x._1==<span class="hljs-string">&quot;M&quot;</span>)      <span class="hljs-comment">//性别为M</span><br>        <span class="hljs-keyword">val</span> m_num_avg = datam.reduceByKey((x,y)=&gt;(x._1+y._1,x._2,y._2)).map(x=&gt;(x._1,x._2._2,x._2._1/x._2._2))      <span class="hljs-comment">//(M,(人数,平均身高))</span><br><br>        <span class="hljs-keyword">val</span> dataf = datac.filter(x=&gt;x._1==<span class="hljs-string">&quot;F&quot;</span>)      <span class="hljs-comment">//性别为F</span><br>        <span class="hljs-keyword">val</span> f_num_avg = datam.reduceByKey((x,y)=&gt;(x._1+y._1,x._2,y._2)).map(x=&gt;(x._1,x._2._2,x._2._1/x._2._2))      <span class="hljs-comment">//(M,(人数,平均身高))</span><br><br>        <span class="hljs-comment">// 存储数据</span><br>        <span class="hljs-keyword">val</span> conf1 = <span class="hljs-keyword">new</span> <span class="hljs-type">Configuration</span>()<br>        <span class="hljs-keyword">val</span> fs = <span class="hljs-type">FileSystem</span>.get(conf1)<br><br>        <span class="hljs-keyword">val</span> result = fs.create(<span class="hljs-keyword">new</span> <span class="hljs-type">Path</span>(<span class="hljs-string">&quot;result3&quot;</span>))<br>        <span class="hljs-keyword">val</span> writer = <span class="hljs-keyword">new</span> <span class="hljs-type">PrintWriter</span>(result)<br><br>        writer.write(<span class="hljs-string">s&quot;m_num_avg = <span class="hljs-subst">$&#123;m_num_avg.collect()(0)._2&#125;</span>&quot;</span>)   <span class="hljs-comment">//性别为m的人数，平均身高</span><br>        writer.write(<span class="hljs-string">s&quot;m_max = <span class="hljs-subst">$&#123;(datam.max._2._1)&#125;</span>&quot;</span>)               <span class="hljs-comment">//性别为m的最高身高</span><br>        writer.write(<span class="hljs-string">s&quot;m_min = <span class="hljs-subst">$&#123;(datam.min._2._1)&#125;</span>&quot;</span>)               <span class="hljs-comment">//性别为m的最低身高</span><br><br>        writer.write(<span class="hljs-string">s&quot;f_num_avg = <span class="hljs-subst">$&#123;f_num_avg.collect()(0)._2&#125;</span>&quot;</span>)   <span class="hljs-comment">//性别为f的人数，平均身高</span><br>        writer.write(<span class="hljs-string">s&quot;f_max = <span class="hljs-subst">$&#123;(dataf.max._2._1)&#125;</span>&quot;</span>)               <span class="hljs-comment">//性别为f的最高身高</span><br>        writer.write(<span class="hljs-string">s&quot;f_min = <span class="hljs-subst">$&#123;(dataf.min._2._1)&#125;</span>&quot;</span>)               <span class="hljs-comment">//性别为f的最低身高</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="第四题">第四题</h2><p>对于文件 relationship.txt，数据形式示例如下：A&lt;B,C,D,F,E,O，表示用户 B,C,D,F,E,O 关注了 A，现要求计算每个用户被关注的数量以及每个用户关注的数量</p><p>观察数据，关注的数量即在‘&lt;’右边出现了几次，被关注数量即为自己那一行’&lt;'右边有几个元素</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> datac = data.map(line=&gt;(line.split(<span class="hljs-string">&quot;&lt;&quot;</span>)(<span class="hljs-number">0</span>),lint.split(<span class="hljs-string">&quot;&lt;&quot;</span>)(<span class="hljs-number">1</span>)))     <span class="hljs-comment">//(A, (B,C,D,F,E,O))</span><br><span class="hljs-keyword">val</span> <span class="hljs-type">A_num</span> = datac.filter(x=&gt;x._2.contains(<span class="hljs-string">&quot;A&quot;</span>)).collect.size            <span class="hljs-comment">//在右边出现的次数</span><br><span class="hljs-keyword">val</span> <span class="hljs-type">A_bnum</span> = datac.filter(x=&gt;x._1.contains(<span class="hljs-string">&quot;A&quot;</span>)).collect()(<span class="hljs-number">0</span>)._2.length<span class="hljs-number">-1</span>   <span class="hljs-comment">//右边的长度</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>大数据计算</tag>
      
      <tag>Spark独立应用程序</tag>
      
      <tag>sbt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>作业2：scala编程</title>
    <link href="/2023/01/05/%E4%BD%9C%E4%B8%9A2%EF%BC%9Ascala%E7%BC%96%E7%A8%8B/"/>
    <url>/2023/01/05/%E4%BD%9C%E4%B8%9A2%EF%BC%9Ascala%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1>scala 编程</h1><h2 id="给定计算机系的成绩文件-data1-txt，包含姓名，课程名称，成绩三个字段">给定计算机系的成绩文件 data1.txt，包含姓名，课程名称，成绩三个字段</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> data1 = sc.textFile(<span class="hljs-string">&quot;file:///home/input/Data01.txt&quot;</span>)<br></code></pre></td></tr></table></figure><p>该系选修 Algorithm 课程有多少学生(文件中有多少 Algorithm)</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> count_Algorithm = data1.flatMap(line=&gt;line.split(<span class="hljs-string">&quot;,&quot;</span>)).filter(word=&gt;word==<span class="hljs-string">&quot;Algorithm&quot;</span>).map(word=&gt;(word,<span class="hljs-number">1</span>)).reduceByKey((a,b)=&gt;a+b)<br></code></pre></td></tr></table></figure><p>输出该系平均分最高的课程名称以及平均分</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> grade = data1.map(row=&gt;(row.split(<span class="hljs-string">&quot;,&quot;</span>)(<span class="hljs-number">1</span>),(row.split(<span class="hljs-string">&quot;,&quot;</span>)(<span class="hljs-number">2</span>).toInt,<span class="hljs-number">1</span>))) <span class="hljs-comment">//（课程名，（成绩，1））</span><br><span class="hljs-keyword">val</span> avg_grade = grade.reduceByKey((x,y)=&gt;(x._1+y._1,x._2+y._2)).map(x=&gt;(x._1,x._2._1/x._2._2))  <span class="hljs-comment">//（课程名，平均分）</span><br>avg_grade.sortBy(item=&gt;(-item._2)).collect()(<span class="hljs-number">0</span>)     <span class="hljs-comment">//对平均分倒序排列，取第一个</span><br></code></pre></td></tr></table></figure><p>输出平均分最高的学生姓名以及平均分</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> stu = data1.map(row=&gt;(row.split(<span class="hljs-string">&quot;,&quot;</span>)(<span class="hljs-number">0</span>),(row.split(<span class="hljs-string">&quot;,&quot;</span>)(<span class="hljs-number">2</span>).toInt, <span class="hljs-number">1</span>)))  <span class="hljs-comment">//(学生名，（成绩，1）)</span><br><span class="hljs-keyword">val</span> avg_stu = stu.reduceByKey((x,y)=&gt;(x._1+y._1,x._2+y._2)).map(x=&gt;(x._1,x._2._1/x._2._2))<br>avg_stu.sortBy(item=&gt;(-item._2)).collect()(<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>输出选修人数最多的课程名称及选修人数</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> sum_grade = grade.reduceByKey((x,y)=&gt;(x._1+y._1,x._2+y._2))     <span class="hljs-comment">//x._2+y._2:人数</span><br>sum_grade.sortBy(item=&gt;(-item._2._2)).collect()(<span class="hljs-number">0</span>)      <span class="hljs-comment">//对人数倒序排列</span><br></code></pre></td></tr></table></figure><p>统计每门课程的平均分，以课程名称：平均分的形式输出</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">avg_grade.collect().foreach(x=&gt;println(x._1+<span class="hljs-string">&quot;: &quot;</span>+x._2.toString()))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>作业1：MapReduce基本编程方法</title>
    <link href="/2023/01/05/%E4%BD%9C%E4%B8%9A1%EF%BC%9AMapReduce%E5%9F%BA%E6%9C%AC%E7%BC%96%E7%A8%8B%E6%96%B9%E6%B3%95/"/>
    <url>/2023/01/05/%E4%BD%9C%E4%B8%9A1%EF%BC%9AMapReduce%E5%9F%BA%E6%9C%AC%E7%BC%96%E7%A8%8B%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1>MapReduce 基本编程方法</h1><h2 id="单词去重">单词去重</h2><p>将一个文件内的所有单词去重，输出为去重后的单词</p><p>输入</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-literal">one</span> <span class="hljs-literal">two</span> <span class="hljs-literal">three</span> <span class="hljs-literal">four</span> <span class="hljs-literal">five</span><br><span class="hljs-literal">one</span> <span class="hljs-literal">two</span> <span class="hljs-literal">three</span> <span class="hljs-literal">four</span><br><span class="hljs-literal">one</span> <span class="hljs-literal">two</span> <span class="hljs-literal">three</span><br><span class="hljs-literal">one</span> <span class="hljs-literal">two</span><br>hello world<br>hello China<br>hello fuzhou<br>hello hi<br></code></pre></td></tr></table></figure><p>输出</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">China<br><span class="hljs-literal">five</span><br><span class="hljs-literal">four</span><br>fuzhou<br>hello<br>hi<br><span class="hljs-literal">one</span><br><span class="hljs-literal">three</span><br><span class="hljs-literal">two</span><br>world<br></code></pre></td></tr></table></figure><p>Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Map</span><br>        <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Mapper</span>&lt;LongWritable, Text, Text, NullWritable&gt;&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Text</span> <span class="hljs-variable">outputKey</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>();        <span class="hljs-comment">//定义输出</span><br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">map</span><span class="hljs-params">(LongWritable key, Text value,        //定义map函数</span><br><span class="hljs-params">                        Mapper&lt;LongWritable, Text, Text, NullWritable&gt;.Context context)</span><br>            <span class="hljs-keyword">throws</span> IOException, InterruptedException &#123;<br>                String[] s = value.toString().split(<span class="hljs-string">&quot; &quot;</span>)<br>                <span class="hljs-keyword">for</span> (String word : s)&#123;<br>                    outputKey.set(word);<br>                    context.write(outputKey, NullWritable.get())    <span class="hljs-comment">//键为单词，值为空</span><br>                &#125;<br>            &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Reduce</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Reduce</span><br>        <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Reducer</span>&lt;Text, NullWritable, Text, NullWritable&gt;&#123;<br><br>        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reduce</span><span class="hljs-params">(Text key, Iterable&lt;NullWritable&gt; values,</span><br><span class="hljs-params">                            Reducer&lt;Text, NullWritable, Text, NullWritable&gt;.Context context)</span><br>                <span class="hljs-keyword">throws</span> IOException, InterruptedException&#123;<br><br>            context.write(key, NullWritable.get());<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="计算股票的资本损益">计算股票的资本损益</h2><p>统计买卖的每个股票收益。（将每个股票的名称作为 key 值，当操作为 Buy 时，value 记为负的价格，当操作为 Sell 时，value 记为正的价格，以这个 key 和 value 作为 map 阶段输出，reduce 阶段的输入）</p><p>输入</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Leetcode</span> Buy <span class="hljs-number">1000</span><br><span class="hljs-attribute">Corona</span> Buy <span class="hljs-number">10</span><br><span class="hljs-attribute">Leetcode</span> Sell <span class="hljs-number">9000</span><br><span class="hljs-attribute">Handbags</span> Buy <span class="hljs-number">30000</span><br><span class="hljs-attribute">Corona</span> Sell <span class="hljs-number">1010</span><br><span class="hljs-attribute">Corona</span> Buy <span class="hljs-number">1000</span><br><span class="hljs-attribute">Corona</span> Sell <span class="hljs-number">500</span><br><span class="hljs-attribute">Corona</span> Buy <span class="hljs-number">1000</span><br><span class="hljs-attribute">Handbags</span> Sell <span class="hljs-number">7000</span><br><span class="hljs-attribute">Corona</span> Sell <span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure><p>输出</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Corona</span> Masks <span class="hljs-number">9500</span><br><span class="hljs-attribute">Handbags</span> -<span class="hljs-number">23000</span><br><span class="hljs-attribute">Leetcode</span> <span class="hljs-number">8000</span><br></code></pre></td></tr></table></figure><p>Map</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Map</span><br>        <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt;&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Text</span> <span class="hljs-variable">outputKey</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>();<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">map</span><span class="hljs-params">(LongWritable key, Text value,</span><br><span class="hljs-params">                        Mapper&lt;LongWritable, Text, Text, Text, IntWritable&gt;.Context context)</span><br>            <span class="hljs-keyword">throws</span> IOException, InterruptedException &#123;<br><br>        String[] s = value.toString().split(<span class="hljs-string">&quot; &quot;</span>);<br>        outputKey.set(s[<span class="hljs-number">0</span>])     <span class="hljs-comment">//股票名称为键</span><br><br>        <span class="hljs-comment">//当操作为Buy时，value记为负的价格，操作为Sell时，value记为正的价格</span><br>        <span class="hljs-type">int</span> val;<br>        <span class="hljs-keyword">if</span> (s[<span class="hljs-number">1</span>].equals(<span class="hljs-string">&quot;Buy&quot;</span>))&#123;<br>            val = -Integer.ParseInt(s[<span class="hljs-number">2</span>]);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            val = Integer.ParseInt(s[<span class="hljs-number">2</span>]);<br>        &#125;<br><br>        context.write(outputKey, <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntWritable</span>(val));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Reduce</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Reduce</span><br>        <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt;&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reduce</span><span class="hljs-params">(Text key, Iterable&lt;IntWritable&gt; values,</span><br><span class="hljs-params">                            Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span><br>            <span class="hljs-keyword">throws</span> IOException, InterruptedException&#123;<br><br>        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (IntWritable val : values)<br>            sum += val.get();<br>        context.write(key, <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntWritable</span>(sum));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MapReduce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH5 Spark SQL</title>
    <link href="/2023/01/04/CH5-Spark-SQL/"/>
    <url>/2023/01/04/CH5-Spark-SQL/</url>
    
    <content type="html"><![CDATA[<h1>CH5 Spark SQL</h1><h2 id="5-1-结构化-API-概述">5.1 结构化 API 概述</h2><ul><li>Dataset 类型</li><li>DataFrame 类型</li><li>SQL 表和视图</li></ul><p><strong>结构化 API 执行过程</strong></p><ul><li>写 DataFrame/Dataset/SQL 代码</li><li>如果是有效的代码，即代码没有编译错误，Spark 将其转换为一个逻辑计划</li><li>Spark 将逻辑计划转换为物理计划，同时进行代码优化</li><li>Spark 然后在集群上执行这个物理计划（基于 RDD 操作）</li></ul><h2 id="5-2-DataFrame-概述">5.2 DataFrame 概述</h2><p><strong>Schema</strong>：Schema 模式定义了 DataFrame 的列名和列的数据类型，可以手动定义或者从数据源读取模式</p><p>Schema 可用 printSchema 查询</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> df = spark.read.format(<span class="hljs-string">&quot;json&quot;</span>).load(<span class="hljs-string">&quot;/data/flight-data/json.2015-summary.json&quot;</span>)<br>df.printSchema<br></code></pre></td></tr></table></figure><p>模式是一个 StructType，由多个 StructField 类型的字段构成，这些字段即<strong>StructField</strong>，具有名称、类型、布尔标志（该标志制定该列是否可以包含缺失值或空值）<br><img src="/img/post/16728228680755.jpg" alt=""></p><p>如果数据中的类型（在运行时）与模式不匹配，Spark 将抛出一个错误</p><p><strong>创建 Rows</strong><br>只有 DataFrame 有 schema，Row 本身没有 schema。如果手动创建一个 Row 对象，则必须以与它们可能被附加的 DataFrame 的 schema 相同的顺序指定列值</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.<span class="hljs-type">Row</span><br><span class="hljs-comment">//创建row</span><br><span class="hljs-keyword">val</span> myRow = <span class="hljs-type">Row</span>(<span class="hljs-string">&quot;Hello&quot;</span>,<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>,<span class="hljs-literal">false</span>)<br><span class="hljs-comment">//访问创建的Row对象中的数据</span><br>myRow(<span class="hljs-number">0</span>)                        <span class="hljs-comment">//type Any</span><br>myRow(<span class="hljs-number">0</span>).asInstanceOf[<span class="hljs-type">String</span>]   <span class="hljs-comment">//String</span><br>myRow.getString(<span class="hljs-number">0</span>)              <span class="hljs-comment">//String</span><br>myRow.getInt(<span class="hljs-number">2</span>)                 <span class="hljs-comment">//Int</span><br></code></pre></td></tr></table></figure><h2 id="5-3-DataFrame-转换">5.3 DataFrame 转换</h2><p>核心操作：</p><ul><li>添加行或列</li><li>删除行或列</li><li>变换一行成一列</li><li>根据列值对 rows 进行排序</li></ul><h3 id="5-3-1-创建-DataFrame">5.3.1 创建 DataFrame</h3><p>使用 spark.read</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala">spark.read.json(<span class="hljs-string">&quot;people.json&quot;</span>)<br>spark.read.parquet(<span class="hljs-string">&quot;people.parquet&quot;</span>)<br>spark.read.csv(<span class="hljs-string">&quot;people.csv&quot;</span>)<br>spark.read.format(<span class="hljs-string">&quot;json&quot;</span>).load(<span class="hljs-string">&quot;people.json&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>SparkSession</strong>支持从不同的数据源加载数据，并把数据转换成 DataFrame，并且支持把 DataFrame 转换成 SQLContext 自身的表，然后使用 SQL 语句来操作数据</p><p>创建一个 SparkSession 对象</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.<span class="hljs-type">SparkSession</span><br><span class="hljs-keyword">val</span> spark = <span class="hljs-type">SparkSession</span>.builder().getOrCreate()<br></code></pre></td></tr></table></figure><p><strong>隐式转换</strong>：Scala 编译器进行类型匹配时，如果找不到合适的类型，那么隐式转换会让编译器在作用范围内自动推导出来合适的类型</p><h3 id="5-3-2-select-和-selectExpr">5.3.2 select 和 selectExpr</h3><p>允许在数据表上执行与 SQL 查询等效的 DataFrame 操作</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.select(<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> DEST_COUNTRY_NAME <span class="hljs-keyword">FROM</span> dfTable LIMIT <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>expr 可以引用一个简单的列或一个列字符串操作</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.select(expr(<span class="hljs-string">&quot;DEST_COUNTRY_NAME AS destination&quot;</span>)).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> DEST_COUNTRY_NAME <span class="hljs-keyword">as</span> destination <span class="hljs-keyword">FROM</span> dfTable LIMIT <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>select 后跟一系列 expr，可使用 selectExpr</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.selectExpr(<span class="hljs-string">&quot;DEST_COUNTRY_NAME as new ColumnNmae&quot;</span>,<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><h3 id="5-3-3-字面常量转换为-Spark-类型">5.3.3 字面常量转换为 Spark 类型</h3><p>将显式字面常量值传递给 Spark，只是一个值（而不是一个新列）</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.function.lit<br>df.select(expr(<span class="hljs-string">&quot;*&quot;</span>),lit(<span class="hljs-number">1</span>).as(<span class="hljs-string">&quot;One&quot;</span>)).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>,<span class="hljs-number">1</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">One</span> <span class="hljs-keyword">FROM</span> dfTable LIMIT <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="5-3-4-添加列">5.3.4 添加列</h3><p>withColumn 方法</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.withColumn(<span class="hljs-string">&quot;numberOne&quot;</span>,lit(<span class="hljs-number">1</span>)).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>,<span class="hljs-number">1</span> <span class="hljs-keyword">as</span> numberOne <span class="hljs-keyword">FROM</span> dfTable LIMIT <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><img src="/img/post/16728251346979.jpg" alt=""></p><h3 id="5-3-5-重命名列">5.3.5 重命名列</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.withColumnRenamed(<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>,<span class="hljs-string">&quot;dest&quot;</span>).columns<br></code></pre></td></tr></table></figure><h3 id="5-3-6-删除列、更改列类型">5.3.6 删除列、更改列类型</h3><p>删除列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.drop(<span class="hljs-string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>).columns<br><br><span class="hljs-comment">//通过将多个列作为参数传递，来删除多个列</span><br>dfWithLongColName.drop(<span class="hljs-string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>,<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>)<br></code></pre></td></tr></table></figure><p>更改列的类型(cast)</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.withColumn(<span class="hljs-string">&quot;count2&quot;</span>,col(<span class="hljs-string">&quot;count&quot;</span>).cast(<span class="hljs-string">&quot;long&quot;</span>))<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>,<span class="hljs-built_in">cast</span>(count <span class="hljs-keyword">as</span> long) <span class="hljs-keyword">AS</span> count2 <span class="hljs-keyword">FROM</span> dfTable<br></code></pre></td></tr></table></figure><h3 id="5-3-7-过滤行">5.3.7 过滤行</h3><p>使用 where 或 filter</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.filter(col(<span class="hljs-string">&quot;count&quot;</span>)&lt;<span class="hljs-number">2</span>).show(<span class="hljs-number">2</span>)<br>df.where(<span class="hljs-string">&quot;count&lt;2&quot;</span>).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>指定多个过滤器</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.where(col(<span class="hljs-string">&quot;count&quot;</span>)&lt;<span class="hljs-number">2</span>).where(col(<span class="hljs-string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>)=!=<span class="hljs-string">&quot;Croatia&quot;</span>)<br></code></pre></td></tr></table></figure><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> dfTable <span class="hljs-keyword">WHERE</span> count<span class="hljs-operator">&lt;</span><span class="hljs-number">2</span> <span class="hljs-keyword">AND</span> ORIGIN_COUNTRY_NAME <span class="hljs-operator">!=</span> &quot;Croatia&quot; LIMIT <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="5-3-8-删除重复行">5.3.8 删除重复行</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.select(<span class="hljs-string">&quot;ORIGIN_COUNTRY_NAME&quot;</span>,<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>).distinct()<br></code></pre></td></tr></table></figure><h3 id="5-3-9-连接和附加行（union）">5.3.9 连接和附加行（union）</h3><p>确保二者具有相同的模式和列数，否则 union 会失败</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> newDF = spark.createDataFrame(parallelizedRows,schema)<br>df.union(newDF).show()<br></code></pre></td></tr></table></figure><h3 id="5-3-10-行排序">5.3.10 行排序</h3><p>sort 和 orderBy</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.sort(<span class="hljs-string">&quot;count&quot;</span>).show(<span class="hljs-number">5</span>)<br>df.orderBy(<span class="hljs-string">&quot;count&quot;</span>,<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>).show(<span class="hljs-number">5</span>)<br>df.orderBy(col(<span class="hljs-string">&quot;count&quot;</span>),col(<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p>指定排序方向</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.spark.sql.functions.&#123;desc,asc&#125;<br>df.orderBy(expr(<span class="hljs-string">&quot;count desc&quot;</span>)).show(<span class="hljs-number">2</span>)<br>df.orderBy(desc(<span class="hljs-string">&quot;count&quot;</span>),asc(<span class="hljs-string">&quot;DEST_COUNTRY_NAME&quot;</span>)).show(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><h3 id="5-3-11-limit">5.3.11 limit</h3><p>限制从 DataFrame 中提取的内容</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">df.limit(<span class="hljs-number">5</span>).show()<br></code></pre></td></tr></table></figure><h3 id="5-3-12-收集-row-到-driver-端">5.3.12 收集 row 到 driver 端</h3><p>收集一些数据给驱动程序，以便在本地机器上操作它</p><ul><li><strong>collect</strong>从整个 DataFrame 中获取所有数据</li><li><strong>take</strong>选取 DataFrame 的前几行</li><li><strong>show</strong>打印出几行数据</li></ul>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spark SQL</tag>
      
      <tag>DataFrame</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH4 RDD 编程</title>
    <link href="/2023/01/03/CH4-RDD-%E7%BC%96%E7%A8%8B/"/>
    <url>/2023/01/03/CH4-RDD-%E7%BC%96%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1>CH4 RDD 编程</h1><h2 id="4-1-RDD-编程基础">4.1 RDD 编程基础</h2><h3 id="4-1-1-RDD-创建">4.1.1 RDD 创建</h3><p><strong>从文件系统中加载数据创建 RDD</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;file:///usr/local/spark/mycode/rdd/word.txt&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>从分布式文件系统 HDFS 中加载数据</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;hdfs://localhost:9000/user/hadoop/word.txt&quot;</span>)<br><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;/user/hadoop/word.txt&quot;</span>)<br><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;word.txt&quot;</span>)<br></code></pre></td></tr></table></figure><p>三条语句完全等价</p><p>通过并行集合（数组）创建 RDD</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> array = <span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>)<br><span class="hljs-keyword">val</span> rdd = sc.parallelize(array)<br></code></pre></td></tr></table></figure><h3 id="4-1-2-RDD-操作">4.1.2 RDD 操作</h3><h4 id="4-1-2-1-转换操作">4.1.2.1 转换操作</h4><table><thead><tr><th>操作</th><th>含义</th></tr></thead><tbody><tr><td>filter(func)</td><td>筛选出满足函数 func 的元素</td></tr><tr><td>map(func)</td><td>将每个元素传递到函数 func 中，并将结果返回为一个新的数据集</td></tr><tr><td>flatMap(func)</td><td>与 map()相似，但每个输入元素都可以映射到 0 或多个输出结果</td></tr><tr><td>groupByKey()</td><td>返回一新的(K,Iterable)形式的数据集</td></tr><tr><td>reduceByKey(func)</td><td>其中每个值是将每个 key 传递到函数 func 中进行聚合后的结果</td></tr></tbody></table><p><strong>filter(func)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> linesWithSpark = lines.filter(line=&gt;line.contains(<span class="hljs-string">&quot;Spark&quot;</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728149027654.jpg" alt=""></p><p><strong>map(func)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala">data = <span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>)<br><span class="hljs-keyword">val</span> rdd1 = sc.parallelize(data)<br><span class="hljs-keyword">val</span> rdd2 = rdd1.map(x=&gt;x+<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728150210009.jpg" alt=""></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> words = lines.map(line=&gt;line.split(<span class="hljs-string">&quot; &quot;</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728150747473.jpg" alt=""></p><p><strong>flatMap(func)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> words = lines.flatMap(line=&gt;line(<span class="hljs-string">&quot; &quot;</span>))<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728151698742.jpg" alt=""></p><p><strong>groupByKey()</strong></p><p><img src="/img/post/16728152631865.jpg" alt=""></p><p><strong>reduceByKey(func)</strong></p><p><img src="/img/post/16728153051966.jpg" alt=""></p><h4 id="4-1-2-2-行动操作">4.1.2.2 行动操作</h4><table><thead><tr><th>操作</th><th>含义</th></tr></thead><tbody><tr><td>count()</td><td>返回数据集中元素的个数</td></tr><tr><td>collect()</td><td>以数组形式返回数据集中所有元素</td></tr><tr><td>first()</td><td>返回数据集中的第一个元素</td></tr><tr><td>take(n)</td><td>以数组形式返回数据集中的前 n 个元素</td></tr><tr><td>reduce(func)</td><td>通过函数 func（输入两个参数并返回一个值）聚合数据集中的元素</td></tr><tr><td>foreach(func)</td><td>将数据集中的每个元素传递到函数 func 中运行</td></tr></tbody></table><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> rdd = sc.parallelize(<span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>))<br>rdd.reduce((a,b)=&gt;a+b) <span class="hljs-comment">//Int=15</span><br>rdd.foreach(elem=&gt;println(elem))<br></code></pre></td></tr></table></figure><h3 id="4-1-3-惰性机制">4.1.3 惰性机制</h3><p>整个转换过程只是记录了转换的轨迹，并不会发生真正的计算，只有遇到行动操作时，才会触发“从头到尾”的真正的计算</p><h3 id="4-1-4-持久化">4.1.4 持久化</h3><p>每次调用行动操作，都会触发一次从头开始的计算，可以通过<strong>持久化（缓存）机制</strong>避免这种重复计算的开销</p><p>持久化后的 RDD 将会被保留在计算节点的内存中被后面的行动操作重复使用</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala">rdd.cache() <span class="hljs-comment">//调用presist(MEMORY_ONLY)，但是，语句执行到这里，并不会缓存rdd，因为这时rdd还没有被计算生成</span><br>println(rdd.count()) <span class="hljs-comment">//第一次行动操作，触发一次真正从头到尾的计算，这时上面的rdd.cache()会被执行，把这个rdd放到缓存中</span><br>println(rdd.collect().mkString(<span class="hljs-string">&quot;,&quot;</span>)) <span class="hljs-comment">//第二次行动操作，使用上面缓存的rdd</span><br></code></pre></td></tr></table></figure><h3 id="4-1-5-分区">4.1.5 分区</h3><p>作用</p><ul><li>增加并行度</li><li>减小通信开销</li></ul><p>原则：使得分区的个数尽量等于集群中的 CPU 核心（core）数目</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;data.txt&quot;</span>,<span class="hljs-number">2</span>) <span class="hljs-comment">//设置两个分区</span><br><br><span class="hljs-keyword">val</span> rdd = lines.repartition(<span class="hljs-number">1</span>) <span class="hljs-comment">//对data这个RDD进行重新分区</span><br></code></pre></td></tr></table></figure><h3 id="4-1-6-综合案例：wordcount">4.1.6 综合案例：wordcount</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> lines = sc.textFile(<span class="hljs-string">&quot;file:///usr/local/spark/mycode/wordcount/word.txt&quot;</span>)<br><span class="hljs-keyword">val</span> wordCount = lines.flatMap(line=&gt;line.split(<span class="hljs-string">&quot; &quot;</span>)).map(word=&gt;(word,<span class="hljs-number">1</span>)).reduceByKey((a,b)=&gt;a+b)<br>wordCount.collect()<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728170515497.jpg" alt=""></p><h2 id="4-2-键值对-RDD">4.2 键值对 RDD</h2><h3 id="4-2-1-常用键值对-RDD-转换操作">4.2.1 常用键值对 RDD 转换操作</h3><p><strong>reduceByKey(func)</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">pairRdd.reduceByKey((a,b)=&gt;a+b).foreach(println)<br></code></pre></td></tr></table></figure><p><img src="/img/post/16728173440767.jpg" alt=""></p><p><strong>groupByKey()</strong></p><p>比如对四个键值对(“spark”,1)、(“spark”,2)、(“hadoop”,3)和(“hadoop”,5)，采用 groupByKey()得到的结果为:(“spark”,(1,2))和(“hadoop”,(3,5))</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-comment">//reduceByKey和groupByKey的区别</span><br><span class="hljs-keyword">val</span> rdd1 = rdd.reduceByKey(_+_)<br><span class="hljs-keyword">val</span> rdd2 = rdd.groupByKey().map(t=&gt;(t._1,t_2.sum))<br></code></pre></td></tr></table></figure><p><strong>Keys</strong><br>会把 key 返回形成一个新的 RDD</p><p><strong>values</strong><br>会把 value 返回形成一个新的 RDD</p><p><strong>sortByKey()</strong><br>返回一个根据键排序的 RDD</p><p><strong>mapValues(func)</strong><br>(Hadoop,1)<br>(Spark,1)<br>(Hive,1)<br>(Spark,1)</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; pairRDD.mapValues(x=&gt;x+<span class="hljs-number">1</span>)<br>(<span class="hljs-type">Hadoop</span>,<span class="hljs-number">2</span>)<br>(<span class="hljs-type">Spark</span>,<span class="hljs-number">2</span>)<br>(<span class="hljs-type">Hive</span>,<span class="hljs-number">2</span>)<br>(<span class="hljs-type">Spark</span>,<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p><strong>Join</strong>（内连接）</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> pairRDD1 = sc.parallelize(<span class="hljs-type">Array</span>((<span class="hljs-string">&quot;spark&quot;</span>,<span class="hljs-number">1</span>),(<span class="hljs-string">&quot;spark&quot;</span>,<span class="hljs-number">2</span>),(<span class="hljs-string">&quot;hadoop&quot;</span>,<span class="hljs-number">3</span>),(<span class="hljs-string">&quot;hadoop&quot;</span>,<span class="hljs-number">5</span>)))<br><br><span class="hljs-keyword">val</span> pairRDD2 = sc.parallelize(<span class="hljs-type">Array</span>((<span class="hljs-string">&quot;spark&quot;</span>,<span class="hljs-string">&quot;fast&quot;</span>)))<br><br>pairRDD1.join(pairRDD2)<br><br>(spark,(<span class="hljs-number">1</span>,fast))<br>(spark,(<span class="hljs-number">2</span>,fast))<br></code></pre></td></tr></table></figure><h3 id="4-2-2-综合案例">4.2.2 综合案例</h3><p>给定一组键值对(“spark”,2),(“hadoop”,6),(“hadoop”,4),(“spark”,6)，键值对的 key 表示图书名称，value 表示某天图书销量，请计算每个键对应的平均值，也就是计算每种图书的每天平均销量</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> rdd = sc.parallelize((<span class="hljs-string">&quot;spark&quot;</span>,<span class="hljs-number">2</span>),(<span class="hljs-string">&quot;hadoop&quot;</span>,<span class="hljs-number">6</span>),(<span class="hljs-string">&quot;hadoop&quot;</span>,<span class="hljs-number">4</span>),(<span class="hljs-string">&quot;spark&quot;</span>,<span class="hljs-number">6</span>))<br><br>rdd.mapValues(x=&gt;(x,<span class="hljs-number">1</span>)).reduceByKey((x,y)=&gt;(x._1+y._1,x._2+y._2)).mapValues(x=&gt;(x._1/x._2)).collect()<br><br>rdd.map(x=&gt;(x._1,(x._2,<span class="hljs-number">1</span>))).reduceByKey((x,y)=&gt;(x._1+y._1,x._2+y._2)).map(x=&gt;(x._1,x._2._1/x._2._2)).collect()<br><br>rdd.groupByKey().map(x=&gt;&#123;(x._1,x._2.sum/x._2.size)&#125;).collect()<br></code></pre></td></tr></table></figure><h2 id="4-3-数据读写">4.3 数据读写</h2><h3 id="4-3-1-文件数据读写">4.3.1 文件数据读写</h3><p><strong>本地文件系统的数据读写</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> textFile = sc.textFile(<span class="hljs-string">&quot;file:///usr/local/spark/mycode/wordcount/word.txt&quot;</span>)<br><br><span class="hljs-comment">//写入文本文件</span><br>textFile.saveAsTextFile(<span class="hljs-string">&quot;file:///usr/local/spark/mycode/wordcount/writeback&quot;</span>)<br><span class="hljs-comment">//ls</span><br><span class="hljs-comment">//part-00000</span><br><span class="hljs-comment">//_SUCCESS</span><br><br><span class="hljs-comment">//再次把数据加载在RDD中</span><br><span class="hljs-keyword">val</span> textFile = sc.textFile(<span class="hljs-string">&quot;file:///usr/local/spark/mycode/wordcount/writeback&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>分布式文件系统的写入</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala">textFile.saveAsTextFile(<span class="hljs-string">&quot;writeback&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="4-3-2-读写-HBase-数据">4.3.2 读写 HBase 数据</h3><p>HBase 中需要根据行键、列族、列限定符和时间戳来确定一个单元格，[行键，列族，列限定符，时间戳]</p><p><img src="/img/post/16728197922764.jpg" alt=""></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> org.apache.hadoop.conf.<span class="hljs-type">Configuration</span><br><span class="hljs-keyword">import</span> org.apache.hadoop.hbase._<br><span class="hljs-keyword">import</span> org.apache.hadoop.hbase.client._<br><span class="hljs-keyword">import</span> org.apache.hadoop.hbase.mapreduce.<span class="hljs-type">TableInputFormat</span><br><span class="hljs-keyword">import</span> org.apache.hadoop.hbase.util.<span class="hljs-type">Bytes</span><br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span><br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkContext</span>._<br><span class="hljs-keyword">import</span> org.apache.spark.<span class="hljs-type">SparkConf</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">SparkOperateHBase</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args:<span class="hljs-type">Array</span>[<span class="hljs-type">String</span>])&#123;<br>        <span class="hljs-keyword">val</span> conf = <span class="hljs-type">HBaseConfiguration</span>.create()<br>        <span class="hljs-keyword">val</span> sc = <span class="hljs-keyword">new</span> <span class="hljs-type">SparkContext</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">SparkConf</span>())<br><br>        <span class="hljs-comment">//设置查询的表名</span><br>        conf.set(<span class="hljs-type">TableInputFormat</span>.<span class="hljs-type">INPUT_TABLE</span>,<span class="hljs-string">&quot;student&quot;</span>)<br>        <span class="hljs-keyword">val</span> stuRDD = sc.newAPIHadoopRDD(conf,classOf[<span class="hljs-type">TableInputFormat</span>],<br>            classOf[org.apache.hadoop.hbase.io.<span class="hljs-type">ImmutableBytesWritable</span>],<br>                classOf[org.apache.hadoop.hbase.client.<span class="hljs-type">Result</span>])<br>        <span class="hljs-keyword">val</span> count = stuRDD.count()<br>        println(<span class="hljs-string">&quot;RDD Count:&quot;</span>+count)<br>        stuRDD.cache()<br><br>        <span class="hljs-comment">//遍历输出</span><br>        stuRDD.foreach(&#123;<span class="hljs-keyword">case</span> (_,result) =&gt;<br>            <span class="hljs-keyword">val</span> key = <span class="hljs-type">Bytes</span>.toString(result.getRow)<br>            <span class="hljs-keyword">val</span> name = <span class="hljs-type">Bytes</span>.toString(result.getValue(<span class="hljs-string">&quot;info&quot;</span>.getBytes,<span class="hljs-string">&quot;name&quot;</span>.getBytes))<br>            <span class="hljs-keyword">val</span> gender = bytes.toString(result.getValue(<span class="hljs-string">&quot;info&quot;</span>.getBytes,<span class="hljs-string">&quot;gender&quot;</span>.getBytes))<br>            <span class="hljs-keyword">val</span> age = <span class="hljs-type">Bytes</span>.toString(result.getValue(<span class="hljs-string">&quot;info&quot;</span>.getBytes,<span class="hljs-string">&quot;age&quot;</span>.getBytes))<br>            println(<span class="hljs-string">&quot;Row key:&quot;</span>+key+<span class="hljs-string">&quot; Name:&quot;</span>+name+<span class="hljs-string">&quot; Gender:&quot;</span>+gender+<span class="hljs-string">&quot; Age:&quot;</span>+age)<br>        &#125;)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>写入数据</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> indataRDD = sc.makeRDD(<span class="hljs-type">Array</span>(<span class="hljs-string">&quot;3,Rongcheng,M,26&quot;</span>,<span class="hljs-string">&quot;4,Guanghua,M,27&quot;</span>)) <span class="hljs-comment">//构建两行数据</span><br><br><span class="hljs-keyword">val</span> rdd = indataRDD.map(_.split(&#x27;,&#x27;)).map&#123;arr=&gt;&#123;<br>    <span class="hljs-keyword">val</span> put = <span class="hljs-keyword">new</span> <span class="hljs-type">Put</span>(<span class="hljs-type">Byte</span>.toBytes(arr(<span class="hljs-number">0</span>))) <span class="hljs-comment">//行键的值</span><br>    put.add(<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;info&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;name&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(arr(<span class="hljs-number">1</span>))) <span class="hljs-comment">//info:name列的值</span><br>    put.add(<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;info&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;gender&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(arr(<span class="hljs-number">2</span>))) <span class="hljs-comment">//info:gender列的值</span><br>    put.add(<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;info&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(<span class="hljs-string">&quot;age&quot;</span>),<span class="hljs-type">Bytes</span>.toBytes(arr(<span class="hljs-number">3</span>))) <span class="hljs-comment">//info:name列的值</span><br>    (<span class="hljs-keyword">new</span> <span class="hljs-type">ImmutableBytesWritable</span>, put)<br>&#125;&#125;<br><br>rdd.saveAsNewAPIHadoopDataset(job.getConfiguration())<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>大数据</tag>
      
      <tag>RDD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH3 Spark 设计与运行原理</title>
    <link href="/2023/01/02/CH3-Spark-%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86/"/>
    <url>/2023/01/02/CH3-Spark-%E8%AE%BE%E8%AE%A1%E4%B8%8E%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1>CH3 Spark 设计与运行原理</h1><h2 id="3-1-Spark-概述">3.1 Spark 概述</h2><h3 id="3-1-1-Spark-简介">3.1.1 Spark 简介</h3><p>特点：</p><ul><li>运行速度快：支持循环数据流与内存计算</li><li>容易使用：Scala、Java、Python 和 R 语言进行编程，可以通过 Spark Shell 进行交互式编程</li><li>通用性：提供了完整而强大的技术栈，包括 SQL 查询、流式计算、机器学习和图算法组件</li><li>运行模式多样</li></ul><h3 id="3-1-2-Scala-简介">3.1.2 Scala 简介</h3><p>是一门现代的多范式编程语言，运行于 Java 平台（JVM，Java 虚拟机），并兼容现有的 Java 程序</p><p>特点：</p><ul><li>强大的并发性，支持函数式编程，可以更好的支持分布式系统</li><li>语法简洁，提供优雅的 API</li><li>兼容 Java，运行速度快</li></ul><h3 id="3-1-3-Spark-与-Hadoop-对比">3.1.3 Spark 与 Hadoop 对比</h3><p>Hadoop 的 MapReduce 计算框架延迟高，只适用于离线批处理应用（批量计算），存在如下缺点</p><ul><li>表达能力有限</li><li>磁盘 IO 开销大</li><li>延迟高<ul><li>任务之间的衔接涉及 IO 开销</li><li>在前一个任务完成之前，其他任务就无法开始，难以胜任复杂、多阶段的计算任务</li></ul></li></ul><p>相比于 Hadoop MapReduce，Spark 具有如下优点</p><ul><li>Spark 的计算模式也属于 MapReduce，但不局限于 Map 和 Reduce 操作，还提供了多种数据集操作类型</li><li>Spark 提供了内存计算，可将中间结果放到内存中，对于迭代运算效率更高</li><li>Spark 基于 DAG 的任务调度执行机制，优于 Hadoop MapReduce 的迭代执行机制</li></ul><p>使用 Hadoop 进行迭代计算非常耗资源<br>Spark 将数据载入内存后，之后的迭代计算都可以直接使用内存中的中间结果作运算，避免了从磁盘中频繁读取数据</p><h2 id="3-2-Spark-生态系统">3.2 Spark 生态系统</h2><ul><li>Spark 既能提供内存计算框架，也可以支持 SQL 即时查询、实时流式计算、机器学习和图计算等</li><li>Spark 可以部署在资源管理器 YARN 之上，提供一站式的大数据解决方案</li></ul><p><strong>Spark 提供的生态系统能同时支持批处理、交互式查询和流数据处理</strong></p><table><thead><tr><th>应用场景</th><th>时间跨度</th><th>其他框架</th><th>Spark 生态系统中的组件</th></tr></thead><tbody><tr><td>复杂的批量数据处理</td><td>小时级</td><td>MapReduce、Hive</td><td>Spark</td></tr><tr><td>基于历史数据的交互式查询</td><td>分钟级、秒级</td><td>Impala、Dremel、Drill</td><td>Spark SQL</td></tr><tr><td>基于实时数据流的数据处理</td><td>毫秒、秒级</td><td>Storm、S4</td><td>Spark Streaming</td></tr><tr><td>基于历史数据的数据挖掘</td><td>-</td><td>Mahout</td><td>MLlib</td></tr><tr><td>图结构数据的处理</td><td>-</td><td>Pregel、Hama</td><td>GraphX</td></tr></tbody></table><h2 id="3-3-Spark-运行架构">3.3 Spark 运行架构</h2><h3 id="3-3-1-基本概念">3.3.1 基本概念</h3><ul><li><strong>RDD</strong>：弹性分布式数据集的简称，是分布式内存的一个抽象概念，提供了一种高度受限的共享内存模型</li><li><strong>DAG</strong>：有向无环图的简称，反应 RDD 之间的依赖关系</li><li><strong>Executor</strong>：是运行在工作阶段（WorkerNode）的一个进程，负责运行 Task</li><li><strong>Application</strong>：用户编写的 Spark 应用程序</li><li><strong>Task</strong>：运行在 Executor 上的工作单元</li><li><strong>Job</strong>：一个 Job 包含多个 RDD 及作用于相应 RDD 上的各种操作</li><li><strong>Stage</strong>：Job 的基本调度单位。一个 Job 会分为多组 Task，每组 Task 被称为 Stage，或者也被称为 TaskSet，代表了一组关联的、相互之间没有 Shuffle 依赖关系的任务组成的任务集</li></ul><h3 id="3-3-2-架构设计">3.3.2 架构设计</h3><p>Spark 运行架构包括<strong>集群资源管理器</strong>（Cluster Manager）、运行作业任务的<strong>工作节点</strong>（Worker Node）、每个应用的<strong>任务控制节点</strong>（Driver）和每个工作节点上<strong>负责具体任务的执行进程</strong>（Executor）</p><p><img src="/img/post/16728104096104.jpg" alt=""></p><ul><li>一个 Application 由一个 Driver 和若干个 Job 构成，一个 Job 由多个 Stage 构成，一个 Stage 由多个没有 Shuffle 关系的 Task 组成</li><li>当执行一个 Application 时，Driver 会向集群管理器<strong>申请资源</strong>，<strong>启动 Executor</strong>，并向 Executor 发送应用程序和文件，然后在 Executor 上<strong>执行 Task</strong>，运行结束后，执行结果会返回给 Driver，或者写到 HDFS 或者其他数据库中</li></ul><h3 id="3-3-3-Spark-运行基本流程">3.3.3 Spark 运行基本流程</h3><ol><li>为应用构建基本运行环境，即由 Driver 创建一个 SparkContext，进行资源的申请、任务分配和监控</li><li>资源管理器为 Executor 分配资源，并启动 Executor 进程</li><li>SparkContext 根据 RDD 的依赖关系构建 DAG 图，DAG 图提交给 DAGScheduler 解析成 Stage，然后把一个个 TaskSet 提交给底层调度器 TaskScheduler 处理；Executor 向 SparkContext 申请 Task，Task Scheduler 将 Task 发放给 Executor 运行并提供应用程序代码</li><li>Task 在 Executor 上运行，把执行结果反馈给 TaskScheduler，然后反馈给 DAGScheduler，运行完毕后写入数据并释放所有资源</li></ol><p><img src="/img/post/16728122560998.jpg" alt=""></p><p>特点：</p><ul><li>每个 Application 都有自己专属的 Executor 进程，并且该进程在 Application 运行期间一直驻留。Executor 进程以多线程的方式运行 Task</li><li>Spark 运行过程与资源管理器无关，只要能够获取 Executor 进程并保持通信即可</li><li>Executor 有 BlockManager 存储模块</li><li>Task 采用了数据本地性和推测执行等优化机制</li></ul><h3 id="3-3-4-RDD-运行原理">3.3.4 RDD 运行原理</h3><p>一个 RDD 就是一个分布式对象集合，提供给你了一种高度受限的共享内存模型，<strong>即 RDD 是只读的记录分区的集合，不能直接修改</strong>。</p><p>执行过程：（这一系列处理称为一个 Lineage（血缘关系））</p><ul><li>RDD 读入外部数据源进行创建</li><li>RDD 经过一系列的转换（Transformation）操作，每一次都会产生不同的 RDD，供给下一个转换操作使用</li><li>最后一个 RDD 经过“动作”操作进行转换，并输出到外部数据源</li></ul><p><img src="/img/post/16728128249337.jpg" alt=""></p><p>优点：<strong>惰性调用</strong>、<strong>管道化</strong>、避免同步等待、不需要保存中间结果、每次操作变得简单</p><blockquote><p>惰性调用：对于转换操作，只记录 RDD 之间的生成与依赖关系，只在执行“动作”操作时，才出发真正的计算<br>管道化：一个操作得到的结果，无需中间存储，直接管道式流转到下一个操作</p></blockquote><p><strong>RDD 之间的依赖关系————Shuffle 操作</strong></p><p><img src="/img/post/16728134333402.jpg" alt=""></p><p><strong>RDD 之间的依赖关系————窄依赖和宽依赖</strong></p><p><strong>窄依赖</strong>表现为一个父 RDD 的分区对应于一个子 RDD 的分区，或多个父 RDD 的分区对应于一个子 RDD 的分区</p><p><strong>宽依赖</strong>则表现为存在一个父 RDD 的一个分区对应一个子 RDD 的多个分区</p><p><img src="/img/post/16728136402960.jpg" alt=""></p><p>窄依赖对于作业的优化很有利，宽依赖无法优化</p><p>窄依赖可以实现“流水线”优化，宽依赖无法实现“流水线”优化</p><h4 id="3-3-4-1-RDD-运行过程">3.3.4.1 RDD 运行过程</h4><ol><li>创建 RDD 对象</li><li>SparkContext 负责计算 RDD 之间的依赖关系，构建 DAG</li><li>DAGScheduler 负责把 DAG 图分解成多个 Stage，每个 Stage 中包含了多个 Task，每个 Task 会被 TaskScheduler 分发给各个 WorkerNode 上的 Executor 去执行</li></ol><p><img src="/img/post/16728140033545.jpg" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spark</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH2 Scala 语言基础</title>
    <link href="/2023/01/02/CH2-Scala-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/"/>
    <url>/2023/01/02/CH2-Scala-%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1>CH2 Scala 语言基础</h1><h2 id="2-1-Scala-语言概述">2.1 Scala 语言概述</h2><p>Scala 是一门纯粹的面向对象的语言。每个值都是对象，每个操作都是方法调用。对象的数据类型以及行为由类和特质描述。</p><p>也是一门函数式语言。每个函数都是一个值，并且和其他类型（如整数、字符串等）的值处于同一地位。</p><p><strong>启动 scala</strong></p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-variable">$ </span>scala<br></code></pre></td></tr></table></figure><p><strong>退出 scala</strong></p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos">scala&gt; :<span class="hljs-keyword">quit</span><br></code></pre></td></tr></table></figure><p><strong>在 scala 解释器中运行脚本文件</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">scala</span>&gt; :load /usr/<span class="hljs-keyword">local</span>/<span class="hljs-keyword">scala</span>/mycode/<span class="hljs-keyword">Test</span>.<span class="hljs-keyword">scala</span><br></code></pre></td></tr></table></figure><p><strong>通过编译打包的方式运行 Scala 程序</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">$ cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/scala/my</span>code<br>$ scalac HelloWorld.scala<br></code></pre></td></tr></table></figure><p>使用 Scala 或者 java 命令运行字节码文件</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-variable">$ </span>scala -classpath .HelloWorld<br></code></pre></td></tr></table></figure><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-variable">$ </span>java -classpath .<span class="hljs-symbol">:/usr/local/scala/lib/scala-library</span>.jar <span class="hljs-title class_">HelloWorld</span><br></code></pre></td></tr></table></figure><h2 id="2-2-Scala-基础">2.2 Scala 基础</h2><h3 id="2-2-1-基本数据类型和变量">2.2.1 基本数据类型和变量</h3><p><strong>基本数据类型</strong></p><p>（注意首字母大写）</p><p>和 Java 不同的是，在 Scala 中，这些<strong>类型都是“类”</strong>，并且都是包 scala 的成员，比如，Int 的全名是 scala.Int。对于字符串，Scala 用 java.lang.String 类来表示字符串<br><img src="/img/post/16727201095688.jpg" alt=""></p><p><strong>字面量</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> i = <span class="hljs-number">123</span>     <span class="hljs-comment">//123，整数字面量</span><br><span class="hljs-keyword">val</span> i = <span class="hljs-number">3.14</span>    <span class="hljs-comment">//3.14，浮点数字面量</span><br><span class="hljs-keyword">val</span> i = <span class="hljs-literal">true</span>    <span class="hljs-comment">//true，布尔型字面量</span><br><span class="hljs-keyword">val</span> i = &#x27;<span class="hljs-type">A</span>&#x27;     <span class="hljs-comment">//&#x27;A&#x27;，字符字面量</span><br><span class="hljs-keyword">val</span> i = <span class="hljs-string">&quot;Hello&quot;</span> <span class="hljs-comment">//&quot;Hello&quot;，字符串字面量</span><br></code></pre></td></tr></table></figure><p><strong>操作符</strong><br>优先级：算数运算符 &gt; 关系运算符 &gt; 逻辑运算符 &gt; 赋值运算符</p><ul><li>算术运算符：加（+）、减（-）、乘（*）、除（/）、余数（%）；</li><li>关系运算符：大于（&gt;）、小于(&lt;) 、等于（==）不等于（!=）、大于等于（&gt;=）、小于等于(&lt;=)</li><li>逻辑运算符：逻辑与(&amp;&amp;)、逻辑或(||)、逻辑非(!)；</li><li>位运算符：按位与(＆)、按位或(|)、按位异或(^)、按位取反(~)等</li><li>赋值运算符：=及其与其它运算符结合的扩展赋值运算符，例如+=、<br>%</li></ul><p><strong>变量</strong></p><ul><li>val：不可变的，声明时必须被初始化，初始化后不能再赋值</li><li>var：可变的，声明时需要进行初始化，初始化后还可以再次赋值</li></ul><p>根据初始值可以省略具体的数据类型</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> myStr = <span class="hljs-string">&quot;Hello World&quot;</span><br></code></pre></td></tr></table></figure><p>也可以显式声明变量的类型</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> myStr2:<span class="hljs-type">String</span> = <span class="hljs-string">&quot;Hello World&quot;</span><br></code></pre></td></tr></table></figure><h3 id="2-2-2-输入输出">2.2.2 输入输出</h3><p><strong>控制台输入输出语句</strong></p><p>控制台读入数据：<code>readInt</code>,<code>readDouble</code>,<code>readByte</code>,<code>readShort</code>,<code>readFloat</code>,<code>readLong</code>,<code>readChar</code>,<code>readBoolean</code>,<code>readLine</code></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> io.<span class="hljs-type">StdIn</span>._<br><br><span class="hljs-keyword">var</span> i = readInt()<br><br><span class="hljs-keyword">var</span> str = readLine(<span class="hljs-string">&quot;please input your name:&quot;</span>)<br></code></pre></td></tr></table></figure><p>控制台输出信息：<code>print</code>,<code>println</code>,<code>printf</code>(C 语言风格)</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> i = <span class="hljs-number">10</span><br><span class="hljs-keyword">val</span> f = <span class="hljs-number">3.5</span><br><span class="hljs-keyword">val</span> s = <span class="hljs-string">&quot;hello&quot;</span><br><br>scala&gt; println(<span class="hljs-string">s&quot;<span class="hljs-subst">$s</span>:i=<span class="hljs-subst">$i</span>,f=<span class="hljs-subst">$f</span>&quot;</span>)         <span class="hljs-comment">//s插值字符串</span><br>hello:i=<span class="hljs-number">10</span>,f=<span class="hljs-number">3.5425</span><br><br>scala&gt; println(<span class="hljs-string">f&quot;<span class="hljs-subst">$s</span>:i=<span class="hljs-subst">$i</span>%-4d,f=<span class="hljs-subst">$f</span>%.1f&quot;</span>) <span class="hljs-comment">//f插值字符串</span><br>hello:i=<span class="hljs-number">10</span>  ,f=<span class="hljs-number">3.5</span><br></code></pre></td></tr></table></figure><p><strong>读写文件</strong></p><p>写入文件：使用 java.io.PrintWriter 把数据写入文件，PrintWriter 类提供了<code>print</code>和<code>println</code>两个写方法</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">PrintWriter</span><br><br><span class="hljs-keyword">val</span> outputFile = <span class="hljs-keyword">new</span> <span class="hljs-type">PrintWriter</span>(<span class="hljs-string">&quot;test.txt&quot;</span>)<br><br>outputFile.println(<span class="hljs-string">&quot;Hello World&quot;</span>)<br>outputFile.print(<span class="hljs-string">&quot;Spark is good&quot;</span>)<br><br>outputFile.close()<br></code></pre></td></tr></table></figure><p>读取文件：使用 scala.io.Source 的<code>getLines</code>方法</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> scala.io.<span class="hljs-type">Source</span><br><br><span class="hljs-keyword">val</span> inputFile = <span class="hljs-type">Source</span>.fromFile(<span class="hljs-string">&quot;output.txt&quot;</span>)<br><span class="hljs-keyword">val</span> lines = inputFile.getLines  <span class="hljs-comment">//返回的结果是一个迭代器</span><br><br><span class="hljs-keyword">for</span> (line &lt;- lines) println(line)<span class="hljs-comment">//逐行打印结果</span><br></code></pre></td></tr></table></figure><h3 id="2-2-3-控制结构">2.2.3 控制结构</h3><h4 id="2-2-3-1-if-条件表达式">2.2.3.1 if 条件表达式</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">if</span>(表达式)&#123;<br>    语句块<span class="hljs-number">1</span><br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    语句块<span class="hljs-number">2</span><br>&#125;<br></code></pre></td></tr></table></figure><p>Scala 中 if 表达式的值可以赋值给变量</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> a = <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">0</span>) <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-number">-1</span><br></code></pre></td></tr></table></figure><h4 id="2-2-3-2-while-循环">2.2.3.2 while 循环</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">while</span>(表达式)&#123;<br>    循环体<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">do</span>&#123;<br>    循环体<br>&#125;<span class="hljs-keyword">while</span>(表达式)<br></code></pre></td></tr></table></figure><h4 id="2-2-3-3-for-循环">2.2.3.3 for 循环</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">for</span>(变量 &lt;- 表达式)&#123;语句块&#125;<br></code></pre></td></tr></table></figure><p>其中，“变量&lt;-表达式”被称为生成器</p><p><strong>守卫表达式</strong>：过滤出一些满足条件的结果</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">for</span>(i &lt;- <span class="hljs-number">1</span> to <span class="hljs-number">5</span> <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>) println(i)<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">2<br>4<br></code></pre></td></tr></table></figure><p>for 支持多个<strong>生成器</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">for</span> (i &lt;- <span class="hljs-number">1</span> to <span class="hljs-number">5</span>; j &lt;- <span class="hljs-number">1</span> to <span class="hljs-number">3</span>) println(i*j)<br></code></pre></td></tr></table></figure><p><strong>for 推导式</strong>：for 结构可以再每次执行的时候创造一个值，然后将包含了所有产生值的集合作为 for 循环表达式的结果返回，集合的类型由生成器中的集合类型决定</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">for</span> (变量&lt;-表达式) <span class="hljs-keyword">yield</span>&#123;语句块&#125;<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; <span class="hljs-keyword">val</span> r=<span class="hljs-keyword">for</span>(i &lt;- <span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>) <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>) <span class="hljs-keyword">yield</span> &#123;println(i);i&#125;<br><br><span class="hljs-number">2</span><br><span class="hljs-number">4</span><br>r:<span class="hljs-type">Array</span>[<span class="hljs-type">Int</span>] = <span class="hljs-type">Array</span>(<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure><h4 id="2-2-3-4-异常处理">2.2.3.4 异常处理</h4><p>Scala 将所有异常都当作“不受检异常”（或称运行时异常）</p><p>使用 try-catch 结构来捕获异常</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">FileReader</span><br><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">FileNotFoundException</span><br><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">IOException</span><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">val</span> f = <span class="hljs-keyword">new</span> <span class="hljs-type">FileReader</span>(<span class="hljs-string">&quot;input.txt&quot;</span>)<br>    <span class="hljs-comment">// 文件操作</span><br>&#125;<span class="hljs-keyword">catch</span>&#123;<br>    <span class="hljs-keyword">case</span> ex:<span class="hljs-type">FileNotFoundException</span> =&gt;<br>        <span class="hljs-comment">// 文件不存在时的操作</span><br>    <span class="hljs-keyword">case</span> ex:<span class="hljs-type">IOException</span> =&gt;<br>        <span class="hljs-comment">// 发生I/O错误时的操作</span><br>&#125;<span class="hljs-keyword">finally</span>&#123;<br>    file.close() <span class="hljs-comment">//确保关闭文件</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-3-5-对循环的控制">2.2.3.5 对循环的控制</h4><p>Scala 提供了一个 Breaks 类，<code>breakable</code>和<code>break</code>对循环结构进行控制</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> util.control.<span class="hljs-type">Breaks</span>._ <span class="hljs-comment">//导入Breaks类的所有方法</span><br><br><span class="hljs-keyword">val</span> array = <span class="hljs-type">Array</span>(<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>)<br><br>breakable&#123;<br>    <span class="hljs-keyword">for</span> (i &lt;- array)&#123;<br>        <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">5</span>) <span class="hljs-keyword">break</span> <span class="hljs-comment">//跳出breakable，终止for循环，相当于break</span><br>        println(i)<br>    &#125;<br>&#125;<span class="hljs-comment">// 输出1，3</span><br><br><span class="hljs-keyword">for</span>(i &lt;- array)&#123;<br>    breakable&#123;<br>        <span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">5</span>) <span class="hljs-keyword">break</span> <span class="hljs-comment">//跳出breakable，终止当次循环，相当于continue</span><br>        println(i)<br>    &#125;<br>&#125;<span class="hljs-comment">// 输出1，3，5，4</span><br></code></pre></td></tr></table></figure><h3 id="2-2-4-数据结构">2.2.4 数据结构</h3><h4 id="2-2-4-1-数组（Array）">2.2.4.1 数组（Array）</h4><p>声明一个整型数组</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> intValueArr = <span class="hljs-keyword">new</span> <span class="hljs-type">Array</span>[<span class="hljs-type">Int</span>](<span class="hljs-number">3</span>) <span class="hljs-comment">// 声明一个长度为3的整型数组，每个数组元素初始化为0</span><br><br>intValueArr(<span class="hljs-number">0</span>) = <span class="hljs-number">12</span> <span class="hljs-comment">//给第一个元素赋值为12</span><br></code></pre></td></tr></table></figure><p>声明一个字符串数组</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> myStrArr = <span class="hljs-keyword">new</span> <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>](<span class="hljs-number">3</span>) <span class="hljs-comment">// 声明一个长度为3的字符串数组，每个数组元素初始化为null</span><br><br>myStrArr(<span class="hljs-number">0</span>) = <span class="hljs-string">&quot;BigData&quot;</span><br></code></pre></td></tr></table></figure><p>可以不给出数组类型</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> intValue = <span class="hljs-type">Array</span>(<span class="hljs-number">12</span>,<span class="hljs-number">45</span>,<span class="hljs-number">33</span>)<br><span class="hljs-keyword">val</span> myStrArr = <span class="hljs-type">Array</span>(<span class="hljs-string">&quot;BigData&quot;</span>,<span class="hljs-string">&quot;Hadoop&quot;</span>,<span class="hljs-string">&quot;Spark&quot;</span>)<br></code></pre></td></tr></table></figure><p>多维数组的创建：调用 Array 的<code>ofDim</code>方法</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> myMatrix = <span class="hljs-type">Array</span>.ofDim[<span class="hljs-type">Int</span>](<span class="hljs-number">3</span>,<span class="hljs-number">4</span>)<br><br>\\ `myMatrix(<span class="hljs-number">0</span>)(<span class="hljs-number">1</span>)`返回第一行第二列的元素<br></code></pre></td></tr></table></figure><h4 id="2-2-4-2-元组（Tuple）">2.2.4.2 元组（Tuple）</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; <span class="hljs-keyword">val</span> tuple = (<span class="hljs-string">&quot;BigData&quot;</span>,<span class="hljs-number">2015</span>,<span class="hljs-number">45.0</span>) <span class="hljs-comment">//定义元组</span><br>tuple: (<span class="hljs-type">String</span>, <span class="hljs-type">Int</span>, <span class="hljs-type">Double</span>) = (<span class="hljs-type">BigData</span>,<span class="hljs-number">2015</span>,<span class="hljs-number">45.0</span>)<br><br>scala&gt; println(tuple._1)    <span class="hljs-comment">//访问元组的元素（索引从1开始）</span><br><span class="hljs-type">BigData</span><br></code></pre></td></tr></table></figure><h4 id="2-2-4-3-容器（Collection）">2.2.4.3 容器（Collection）</h4><p>包括序列（Sequence）、集合（Set）、映射（Map）</p><p>Scala 用了三个包来组织容器类，分别是 scala.collection, scala.collection.mutable, scala.collection.immutable</p><p>scala.collection 定义了可变容器和不可变容器的一些通用操作</p><h4 id="2-2-4-4-序列（Sequence）">2.2.4.4 序列（Sequence）</h4><p>元素可以按照特定的顺序访问的容器，序列中每个元素均带有一个从 0 开始计数的固定索引位置</p><p>具有两个子特质 LinearSeq 和 IndexedSeq，LinearSeq 序列具有高效的 head 和 tail 操作，而 IndexedSeq 序列具有高效的随机存储操作</p><p><strong>列表（List）</strong></p><p>scala 中的 List 一旦被定义，其值就不能改变</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">var</span> strList = <span class="hljs-type">List</span>(<span class="hljs-string">&quot;BigData&quot;</span>,<span class="hljs-string">&quot;Hadoop&quot;</span>,<span class="hljs-string">&quot;Spark&quot;</span>)<br><br>strList.head <span class="hljs-comment">//返回第一个元素，即&quot;BigData&quot;</span><br>strList.tail <span class="hljs-comment">// 返回除第一个元素外的其他值构成的新列表，即List(&quot;Hadoop&quot;,&quot;Spark&quot;)</span><br></code></pre></td></tr></table></figure><p>构造列表</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> otherList=<span class="hljs-string">&quot;Apache&quot;</span>::strList<br><br>otherList为<span class="hljs-type">List</span>(<span class="hljs-string">&quot;Apache&quot;</span>,<span class="hljs-string">&quot;BigData&quot;</span>,<span class="hljs-string">&quot;Hadoop&quot;</span>,<span class="hljs-string">&quot;Spark&quot;</span>)<br><br><span class="hljs-keyword">val</span> intList = <span class="hljs-number">1</span>::<span class="hljs-number">2</span>::<span class="hljs-number">3</span>::<span class="hljs-type">Nil</span>  <span class="hljs-comment">//Nil：空列表对象</span><br><span class="hljs-comment">// 借助Nil可以将多个元素用操作符::串起来初始化一个列表</span><br></code></pre></td></tr></table></figure><blockquote><p>除了 head、tail 操作是常数时间 O(1)，其他按索引访问的操作都需要从头开始遍历，即 O(N)</p></blockquote><p><strong>向量（Vector）</strong><br>实现所有访问操作都是常数时间</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; <span class="hljs-keyword">val</span> v = <span class="hljs-type">Vector</span>(<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;b&quot;</span>,<span class="hljs-string">&quot;c&quot;</span>)<br>v: scala.collection.immutable.<span class="hljs-type">Vector</span>[<span class="hljs-type">String</span>] = <span class="hljs-type">Vector</span>(a,b,c)<br>scala&gt; v(<span class="hljs-number">1</span>)<br>res2: <span class="hljs-type">String</span> = b<br></code></pre></td></tr></table></figure><p>Vector 不能改变，但是可以通过生成新的 Vector 来实现对 Vector 的修改</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; <span class="hljs-keyword">val</span> a = <span class="hljs-type">Vector</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<br>scala&gt; <span class="hljs-keyword">val</span> b = a ++ <span class="hljs-type">Vector</span>(<span class="hljs-number">4</span>,<span class="hljs-number">5</span>) <span class="hljs-comment">//实现对Vector添加元素</span><br>b: scala.collection.immutable.<span class="hljs-type">Vector</span>[<span class="hljs-type">Int</span>] = <span class="hljs-type">Vector</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>)<br><br>scala&gt; <span class="hljs-keyword">val</span> a = <span class="hljs-type">Vector</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<br>scala&gt; <span class="hljs-keyword">val</span> b = a.updated(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>) <span class="hljs-comment">// 修改Vector中的元素</span><br>b: <span class="hljs-type">Vector</span>(<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)<br><br>scala&gt; <span class="hljs-keyword">val</span> vec1 = <span class="hljs-type">Vector</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br>scala&gt; <span class="hljs-keyword">val</span> vec2 = <span class="hljs-number">3</span> +: <span class="hljs-number">4</span> +: vec1 <span class="hljs-comment">//+:用于在头部追加元素</span><br>vec2: <span class="hljs-type">Vector</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><br>scala&gt; <span class="hljs-keyword">val</span> vec3 = vec2 :+ <span class="hljs-number">5</span> <span class="hljs-comment">//:+用于在尾部追加元素</span><br>vec3: <span class="hljs-type">Vector</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>)<br><br>scala&gt; vec3(<span class="hljs-number">3</span>)<br>res6: <span class="hljs-type">Int</span> = <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p><code>++</code> 连接两个集合<br><code>:::</code> 连接两个 List 类型的集合<br>这些操作符都是从右往左结合的</p><p><strong>Range</strong></p><p>一种特殊的、带索引的不可变数字等差序列</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; <span class="hljs-keyword">val</span> r = <span class="hljs-keyword">new</span> <span class="hljs-type">Range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>)<br><br>scala&gt; <span class="hljs-number">1</span> to <span class="hljs-number">5</span><br>res0: <span class="hljs-type">Range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>)<br><br><span class="hljs-comment">// 1到5，不包含区间终点</span><br>scala&gt; <span class="hljs-number">1</span> until <span class="hljs-number">5</span><br><br><span class="hljs-comment">// 1到10，步长为2</span><br>scala&gt; <span class="hljs-number">1</span> to <span class="hljs-number">10</span> by <span class="hljs-number">2</span><br><br><span class="hljs-comment">// Float类型，从0.5f到5.9f，步长为0.3f</span><br>scala&gt; <span class="hljs-number">0.5</span>f to <span class="hljs-number">5.9</span>f by <span class="hljs-number">0.8</span>f<br>res3: <span class="hljs-type">NumericRange</span>(<span class="hljs-number">0.5</span>,<span class="hljs-number">1.3</span>,<span class="hljs-number">2.1</span>,<span class="hljs-number">2.89999</span>,<span class="hljs-number">3.69998</span>,<span class="hljs-number">4.5</span>,<span class="hljs-number">5.3</span>)<br></code></pre></td></tr></table></figure><h4 id="2-2-4-5-集合（Set）">2.2.4.5 集合（Set）</h4><p>不重复元素的容器</p><p>创建不可变集</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">var</span> mySet = <span class="hljs-type">Set</span>(<span class="hljs-string">&quot;Hadoop&quot;</span>,<span class="hljs-string">&quot;Spark&quot;</span>)<br></code></pre></td></tr></table></figure><p>创建可变集</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> scala.collection.mutable.<span class="hljs-type">Set</span><br><span class="hljs-keyword">val</span> myMutableSet = <span class="hljs-type">Set</span>(<span class="hljs-string">&quot;Database&quot;</span>,<span class="hljs-string">&quot;BigData&quot;</span>)<br>myMutableSet += <span class="hljs-string">&quot;Cloud Computing&quot;</span><br></code></pre></td></tr></table></figure><p>操作：</p><ul><li>head</li><li>tail</li><li>isEmpty，在集合为空时返回 true</li><li>连接：<code>++</code>或<code>.++()</code></li><li>交集：<code>.&amp;()</code>或<code>.intersect()</code></li></ul><h4 id="2-2-4-6-映射（Map）">2.2.4.6 映射（Map）</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> university = <span class="hljs-type">Map</span>(<span class="hljs-string">&quot;XMU&quot;</span>-&gt;<span class="hljs-string">&quot;Xiamen University&quot;</span>,<span class="hljs-string">&quot;THU&quot;</span>-&gt;<span class="hljs-string">&quot;Tsinghua University&quot;</span>,<span class="hljs-string">&quot;PKU&quot;</span>-&gt;<span class="hljs-string">&quot;Peking University&quot;</span>) <span class="hljs-comment">//定义</span><br><br>println(university(<span class="hljs-string">&quot;XMU&quot;</span>)) <span class="hljs-comment">//通过键获取值</span><br><br><span class="hljs-keyword">val</span> xmu = <span class="hljs-keyword">if</span>(university.contains(<span class="hljs-string">&quot;XMU&quot;</span>)) university(<span class="hljs-string">&quot;XMU&quot;</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-comment">//先调用contains方法确定键是否存在</span><br>println(xmu)<br></code></pre></td></tr></table></figure><p>可变的映射</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> scala.collection.mutable.<span class="hljs-type">Map</span> <span class="hljs-comment">//导入所需的包</span><br><br>university(<span class="hljs-string">&quot;XMU&quot;</span>) = <span class="hljs-string">&quot;Xiaman University&quot;</span> <span class="hljs-comment">//更新已有元素</span><br>university(<span class="hljs-string">&quot;FZU&quot;</span>) = <span class="hljs-string">&quot;Fuzhou University&quot;</span> <span class="hljs-comment">//添加新元素</span><br><br>university += (<span class="hljs-string">&quot;SDU&quot;</span>-&gt;<span class="hljs-string">&quot;Shandong University&quot;</span>,<span class="hljs-string">&quot;WHU&quot;</span>-&gt;<span class="hljs-string">&quot;Wuhan University&quot;</span>) <span class="hljs-comment">//+=添加元素</span><br></code></pre></td></tr></table></figure><p>循环遍历映射</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">for</span>((k,v)&lt;-映射)<br><br><span class="hljs-keyword">for</span>(k&lt;-映射.keys)     <span class="hljs-comment">//只遍历k</span><br><span class="hljs-keyword">for</span>(v&lt;-映射.values)   <span class="hljs-comment">//只遍历v</span><br></code></pre></td></tr></table></figure><p><strong>Map 合并</strong>：使用<code>++</code>或<code>Map.++()</code>，Map 合并时会移除重复的 key<br>如果存在相同的 key，合并之后的 Map 中的 value 会被最右边的 Map 的值所替代</p><h4 id="2-2-4-7-迭代器（Iterator）">2.2.4.7 迭代器（Iterator）</h4><p>提供了按顺序访问容器元素的数据结构</p><p>操作：</p><ul><li>next：返回迭代器的下一个元素</li><li>hasNext：检测是否还有下一个元素<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> iter = <span class="hljs-type">Iterator</span>(<span class="hljs-string">&quot;Hadoop&quot;</span>,<span class="hljs-string">&quot;Spark&quot;</span>,<span class="hljs-string">&quot;Scala&quot;</span>)<br><span class="hljs-keyword">while</span> (iter.hasNext)&#123;<br>    println(iter.next())<br>&#125;<br></code></pre></td></tr></table></figure></li><li><code>.max</code>查找最大元素，<code>.min</code>查找最小元素</li><li><code>.size</code>,<code>.length</code>，获取迭代器的长度</li></ul><h2 id="2-3-面向对象编程基础">2.3 面向对象编程基础</h2><h3 id="2-3-1-类">2.3.1 类</h3><p><strong>类的定义</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span></span>&#123;<br>    <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span><br>    <span class="hljs-comment">// def 方法名(参数列表):返回结果类型=&#123;方法体&#125;</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(step:<span class="hljs-type">Int</span>):<span class="hljs-type">Unit</span> = &#123;value += step&#125; <span class="hljs-comment">//Unit:不返回任何值</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span></span>():<span class="hljs-type">Int</span> = &#123;value&#125;<br>&#125;<br><br><span class="hljs-keyword">val</span> myCounter = <span class="hljs-keyword">new</span> <span class="hljs-type">Counter</span> <span class="hljs-comment">//使用new关键字创建一个类的实例</span><br></code></pre></td></tr></table></figure><p><strong>方法的定义</strong></p><p>如果方法返回类型为 Unit，可以同时省略返回结果类型和等号，但是不能省略大括号</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>() &#123;value += <span class="hljs-number">1</span>&#125;    <span class="hljs-comment">// 去掉返回值类型和等号只保留大括号</span><br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">current</span></span>()=value     <span class="hljs-comment">//根据value的类型自动推断出返回类型为Int型</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>构造器</strong></p><p>Scala 类的定义主体就是类的构造器，称为主构造器。<strong>在类名之后用圆括号列出主构造器的参数列表</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span>(<span class="hljs-params">var name:<span class="hljs-type">String</span></span>) <span class="hljs-comment">//定义一个带字符串参数的简单类</span></span><br><span class="hljs-keyword">var</span> mycounter = <span class="hljs-keyword">new</span> <span class="hljs-type">Counter</span>(<span class="hljs-string">&quot;Runner&quot;</span>)<br><br>println(mycounter.name) <span class="hljs-comment">//调用读方法：Runner</span><br>mycounter.name = <span class="hljs-string">&quot;Timer&quot;</span>    <span class="hljs-comment">//调用写方法</span><br></code></pre></td></tr></table></figure><h3 id="2-3-2-模式匹配">2.3.2 模式匹配</h3><p><strong>match 语句</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> scala.io.<span class="hljs-type">Stdln</span>._<br>println(<span class="hljs-string">&quot;Please input the score:&quot;</span>)<br><span class="hljs-keyword">val</span> grade=readChar()<br>grade <span class="hljs-keyword">match</span>&#123;<br>    <span class="hljs-keyword">case</span> &#x27;<span class="hljs-type">A</span>&#x27; =&gt; println(<span class="hljs-string">&quot;85-100&quot;</span>)<br>    <span class="hljs-keyword">case</span> &#x27;<span class="hljs-type">B</span>&#x27; =&gt; println(<span class="hljs-string">&quot;70-84&quot;</span>)<br>    <span class="hljs-keyword">case</span> &#x27;<span class="hljs-type">C</span>&#x27; =&gt; println(<span class="hljs-string">&quot;60-69&quot;</span>)<br>    <span class="hljs-keyword">case</span> &#x27;<span class="hljs-type">D</span>&#x27; =&gt; println(<span class="hljs-string">&quot;&lt;60&quot;</span>)<br>    <span class="hljs-keyword">case</span> _ =&gt; println(<span class="hljs-string">&quot;error input&quot;</span>) <span class="hljs-comment">//default</span><br>&#125;<br></code></pre></td></tr></table></figure><p>不需要 break 跳出判断</p><p>匹配某类型的所有值</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">case</span> i: <span class="hljs-type">Int</span> =&gt; i + <span class="hljs-string">&quot;is an int value&quot;</span> <span class="hljs-comment">//匹配整形的值，并赋值给i</span><br><span class="hljs-keyword">case</span> <span class="hljs-string">&quot;Spark&quot;</span>=&gt;<span class="hljs-string">&quot;Spark is found&quot;</span>      <span class="hljs-comment">//匹配特定的字符串</span><br></code></pre></td></tr></table></figure><p>在 case 中使用守卫式（guard）添加一些过滤逻辑</p><h2 id="2-4-函数式编程基础">2.4 函数式编程基础</h2><h3 id="2-4-1-函数的定义和使用">2.4.1 函数的定义和使用</h3><p>def 方法名(参数列表):结果类型={方法体}</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">counter</span></span>(value:<span class="hljs-type">Int</span>):<span class="hljs-type">Int</span> = &#123;value+=<span class="hljs-number">1</span>&#125;<br></code></pre></td></tr></table></figure><p>可以直接把匿名函数存放到变量中</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">val</span> myNumFunc: <span class="hljs-type">Int</span> =&gt; <span class="hljs-type">Int</span>=(num:<span class="hljs-type">Int</span>)=&gt;num*<span class="hljs-number">2</span><br><span class="hljs-comment">//val myNumFunc = (num:Int) =&gt; num*2 （省略Int=&gt;Int）</span><br>println(myNumFunc(<span class="hljs-number">3</span>)) <span class="hljs-comment">//6</span><br></code></pre></td></tr></table></figure><h3 id="2-4-2-高阶函数">2.4.2 高阶函数</h3><p>一个函数包含其他函数作为其参数或者返回结果为一个函数</p><p>分别 计算一个整数到另一个整数的连加和、平方和、2 的幂次和</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sum</span></span>(f:<span class="hljs-type">Int</span> =&gt; <span class="hljs-type">Int</span>, a:<span class="hljs-type">Int</span>, b:<span class="hljs-type">Int</span>):<span class="hljs-type">Int</span> = &#123;<br>    <span class="hljs-keyword">if</span>(a&gt;b) <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> f(a)+sum(f,a+<span class="hljs-number">1</span>,b)<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scala">scala&gt; sum(x=&gt;x,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>)    <span class="hljs-comment">//直接传入一个匿名函数</span><br>res8: <span class="hljs-type">Int</span>=<span class="hljs-number">15</span><br><br>scala&gt; sum(x=&gt;x*x,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>)  <span class="hljs-comment">//传入另一个匿名函数</span><br>res9: <span class="hljs-type">Int</span>=<span class="hljs-number">55</span><br><br>scala&gt; sum(powerOfTwo,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>) <span class="hljs-comment">//传入一个已经定义好的方法</span><br>res10:<span class="hljs-type">Int</span>=<span class="hljs-number">62</span><br></code></pre></td></tr></table></figure><h2 id="2-5-函数式编程实例-WordCount">2.5 函数式编程实例 WordCount</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">import</span> java.io.<span class="hljs-type">File</span><br><span class="hljs-keyword">import</span> scala.io.<span class="hljs-type">Sourse</span><br><span class="hljs-keyword">import</span> collection.mutable.<span class="hljs-type">Map</span><br><br><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">WordCount</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args:<span class="hljs-type">Array</span>[<span class="hljs-type">String</span>])&#123;<br>        <span class="hljs-keyword">val</span> dirfile = <span class="hljs-keyword">new</span> <span class="hljs-type">File</span>(<span class="hljs-string">&quot;testfiles&quot;</span>)<br>        <span class="hljs-keyword">val</span> files = dirfile.listFiles<br>        <span class="hljs-keyword">val</span> results = <span class="hljs-type">Map</span>.empty[<span class="hljs-type">String</span>, <span class="hljs-type">Int</span>]<br>        <span class="hljs-keyword">for</span>(file&lt;-files)&#123;<br>            <span class="hljs-keyword">val</span> data = <span class="hljs-type">Source</span>.fromFile(file)<br>            <span class="hljs-keyword">val</span> strs = data.getLines.flatMap&#123;s=&gt;s.split(<span class="hljs-string">&quot; &quot;</span>)&#125;<br>            strs foreach &#123; word =&gt;<br>                <span class="hljs-keyword">if</span>(results.contains(word))<br>                    results(word)+=<span class="hljs-number">1</span><br>                <span class="hljs-keyword">else</span> results(word)=<span class="hljs-number">1</span><br>            &#125;<br>        &#125;<br>        results foreach&#123;<span class="hljs-keyword">case</span> (k,v)=&gt;println(<span class="hljs-string">s&quot;<span class="hljs-subst">$k</span>:<span class="hljs-subst">$v</span>&quot;</span>)&#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>大数据计算</tag>
      
      <tag>Scala</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH1 MapReduce</title>
    <link href="/2023/01/02/CH1-MapReduce/"/>
    <url>/2023/01/02/CH1-MapReduce/</url>
    
    <content type="html"><![CDATA[<h1>CH1 MapReduce</h1><h2 id="1-1-概述">1.1 概述</h2><h3 id="1-1-1-分布式并行编程">1.1.1 分布式并行编程</h3><p><strong>MapReduce 比较传统并行计算框架</strong></p><table><thead><tr><th></th><th>传统并行计算框架</th><th>MapReduce</th></tr></thead><tbody><tr><td>集群架构/容错性</td><td>共享式（共享内存/共享存储），容错性差</td><td>非共享式，容错性好</td></tr><tr><td>硬件/价格/扩展性</td><td>刀片服务器、高速网、SAN、价格贵、扩展性差</td><td>普通 PC 机，<strong>便宜</strong>，<strong>扩展性好</strong></td></tr><tr><td>编程/学习难度</td><td>what-how，难</td><td>what，简单</td></tr><tr><td>适用场景</td><td>实时、细粒度计算、计算密集型（计算量大）</td><td>批处理、非实时、数据密集型（数据量大）</td></tr></tbody></table><h3 id="1-1-2-MapReduce-模型简介">1.1.2 MapReduce 模型简介</h3><ul><li>编程容易</li><li><strong>分而治之</strong></li><li><strong>计算向数据靠拢</strong>（因为移动数据需要大量的网络传输开销）</li><li>采用<strong>Master/Slave 架构</strong><ul><li>一个 Master，若干个 Slave，Master 运行 JobTracker，Slave 运行 TaskTracker</li><li>Master 控制 Slave 上<strong>任务的执行</strong>，<strong>故障的修复</strong></li></ul></li></ul><h2 id="1-2-MapReduce-体系结构">1.2 MapReduce 体系结构</h2><h3 id="1-2-1-MapReduce-v1-体系结构">1.2.1 MapReduce v1 体系结构</h3><p><img src="/img/post/16725573612825.jpg" alt=""></p><ul><li><strong>Client</strong> 客户端<ul><li>用户编写的 MapReduce 程序通过 Client 提交到 JobTracker 端（一般通过命令行提交）</li><li>用户可通过 Client 提供的一些接口查看作业运行状态</li></ul></li><li><strong>JobTracker</strong><ul><li>负责<strong>资源监控和作业调度</strong></li><li><strong>监控所有 TaskTracker 与 Job 健康状况</strong>，一旦发现失败，就将相应的任务转移到其他节点</li><li><strong>跟踪任务的执行进度、资源使用量等信息</strong>，并将这些信息告诉<strong>任务调度器（TaskScheduler）</strong>，调度器会在资源出现空闲时选择合适的任务去使用这些资源</li></ul></li><li><strong>TaskTracker</strong><ul><li><strong>监控 Task 运行的情况</strong></li><li><strong>周期性</strong>通过“心跳”将本节点上<strong>资源的使用情况</strong>和<strong>任务的运行进度</strong>汇报给<strong>JobTracker</strong>，同时接收 JobTracker 发送过来的命令并执行相应的操作（启动新任务、杀死任务等）</li><li><strong>使用“slot”等量划分本节点上的资源量</strong>（CPU、内存等）。一个 Task 获取到一个 slot 后才有机会运行，Hadoop 调度就是将各个 TaskTracker 上的空闲 slot 分配给 Task 使用。</li><li>slot 分为<strong>Map slot</strong>和<strong>Reduce slot</strong>，分别给 MapTask 和 ReduceTask 使用</li></ul></li><li><strong>Task</strong><ul><li>分为 Map Task 和 Reduce Task，均由 TaskTracker 启动</li></ul></li></ul><h3 id="1-2-2-MapReduce-v2-的体系结构">1.2.2 MapReduce v2 的体系结构</h3><p><strong>Yarn</strong></p><p>主要思想是将 MRv1 版 JobTracker 的两大功能——<strong>资源管理</strong>和<strong>任务调度</strong>，拆分成两个独立的进程：<strong>全局资源管理进程 ResourceManager</strong>和<strong>任务管理进程 ApplicationMaster</strong></p><ul><li>依旧是<strong>master/slave</strong>结构</li><li>主进程<strong>ResourceManager</strong>是整个集群资源<strong>仲裁中心</strong></li><li>从进程<strong>NodeManager</strong>管理本机资源</li></ul><p><img src="/img/post/16725602617571.jpg" alt=""></p><p>Yarn 在执行时包含以下独立实体：</p><ul><li><strong>Client</strong><ul><li>客户端，负责<strong>向集群提交作业</strong></li></ul></li><li><strong>ResourceManager</strong><ul><li>集群主进程，仲裁中心，负责<strong>集群资源管理</strong>和<strong>任务调度</strong></li><li>处理客户端作业提交请求</li><li>启动或监控 ApplicationMaster</li><li>监控 NodeManager</li><li>资源的分配与调度</li></ul></li><li><strong>Scheduler</strong><ul><li>资源仲裁模块</li></ul></li><li><strong>ApplicationManager</strong><ul><li><strong>选定，启动和监管</strong>ApplicationMaster</li></ul></li><li><strong>NodeManager</strong><ul><li>集群从进程，<strong>管理和监视 Containers</strong>，执行具体任务</li><li>单个节点上的资源管理和任务管理</li><li>处理来自 ResourceManager 的命令</li><li>处理来自 ApplicationMaster 的命令</li></ul></li><li><strong>Container</strong><ul><li><strong>本机资源集合体</strong>，如某 Container 为 4 个 CPU，8GB 内存</li><li>YARN 会为每个任务分配一个 Container，且该任务只能使用该 Container 中描述的资源</li><li>对任务运行环境进行抽象，封装 CPU、内存等多维度的资源以及运行环境变量、启动命令等任务运行相关信息</li></ul></li><li><strong>ApplicationMaster</strong><ul><li><strong>任务执行和监管中心</strong></li><li>每个应用有一个，负责应用程序整个生命周期的管理，负责协调来自 ResourceManager 的资源，并通过 NodeManager 监视容器的执行和资源的使用</li><li>负责数据的切分</li><li>为应用程序申请资源并分配给内部的任务</li><li>任务的监控与容错</li></ul></li></ul><p><img src="/img/post/16726437220279.jpg" alt=""></p><ol><li><strong>作业提交</strong>：Client 端向主进程 ResourceManager 的 ApplicationManager 模块提交任务（1），ApplicationManager 按某种策略选中某 NodeManager 的某 Container 来执行此应用程序的 ApplicationMaster（2）</li><li><strong>任务分配</strong>：ApplicationMaster 向 Scheduler 申请资源（3），Scheduler 根据所有 NodeManager 发送过来的资源信息（4）和集群制定的调度策略以 Container 为单位给 Application Master 分配计算资源（5）</li><li><strong>任务执行</strong>：ApplicationMaster 向选定的 NodeManager 发送任务信息（包括程序代码、数据位置等信息），通知选中的 NodeManager，让其启动本 NM 管理的 Container 计算任务（6）</li><li><strong>进度和状态更新</strong>：处于计算状态的 Container 向其所在 NodeManager 汇报计算进度，NodeManager 则通过心跳包，将这些信息再汇报给 ApplicationMaster，ApplicationMaster 则根据汇总过来的信息，给出任务进度</li><li><strong>任务完成</strong>：所有任务完成后，信息一层层向上汇报到 ApplicationMaster，ApplicationMaster 再将结束信息汇报的 ApplicationManager 模块，ApplicationManager 通知客户端任务结束</li></ol><p><img src="/img/post/16726442845971.jpg" alt=""><br><strong>Yarn 的优势</strong>：<br>Yarn 的设计大大减轻了 ResourceManager 的资源消耗，并且 ApplicationMaster 可以分布于集群中任意一台机器，设计上更加优美</p><h2 id="1-3-MapReduce-工作流程">1.3 MapReduce 工作流程</h2><h3 id="1-3-1-工作流程概述">1.3.1 工作流程概述</h3><p><img src="/img/post/16726445928848.jpg" alt=""></p><ul><li>不同 Map 任务不会进行通信，不同 Reduce 任务之间不会发生任何信息交换</li><li>具有相同 key 的&lt;k,v&gt;会被发送到同一个 reduce 任务处理</li><li>用户不能显式地从一台机器向另一台机器发送消息</li></ul><h3 id="1-3-2-MapReduce-各个执行阶段">1.3.2 MapReduce 各个执行阶段</h3><p><img src="/img/post/16726447180147.jpg" alt=""></p><ol><li>使用 InputFormat 模块做 Map 前的<strong>预处理</strong>；</li><li>将输入文件切分为逻辑上的多个<strong>InputSplit</strong>（InputSplit 是 MapReduce 对文件进行处理和运算的输入单位，只是一个逻辑概念，<strong>没有对文件进行实际切割</strong>，只记录了要处理的数据的位置和长度）</li><li>通过 RecordReader（RR）根据 InputSplit 中的信息来处理 InputSplit 的具体信息，<strong>加载数据并转换为适合 Map 任务读取的键值对</strong>，输入给 Map 任务</li><li>Map 任务根据用户自定义的映射规则，输出一系列的&lt;key,value&gt;作为中间结果</li><li><strong>shuffle</strong>：对 Map 的输出进行一定的<strong>分区</strong>、<strong>排序</strong>、<strong>合并</strong>、<strong>归并</strong>等操作，得到&lt;key,value-list&gt;形式的中间结果</li><li>Reduce 从多个 Map 读取数据，以一系列&lt;key,value-list&gt;中间结果作为输入，执行用户定义的逻辑，输出结果给<strong>OutputFormat</strong>模块（抽象类，下面有很多扩展的子类）</li><li>OutputFormat 模块会<strong>验证</strong>输出目录是否已经存在以及输出结果类型是否符合配置文件中的配置类型，如果都满足，就输出 Reduce 的结果到分布式文件系统</li></ol><p><strong>关于 split</strong></p><p><img src="/img/post/16726456897140.jpg" alt=""><br>HDFS 以固定大小的 block 为基本单位存储数据，MapReduce 处理单位是 split。split 是个逻辑概念，划分方法完全由用户决定</p><p><strong>Map 任务的数量</strong>：Hadoop 为每个 split 创建一个 Map 任务，split 的多少决定了 Map 任务的数量</p><p><strong>Reduce 任务的数量</strong>：最优的 Reduce 任务个数取决于集群中可用的 reduce 任务槽（slot）的数目，通常设置比 reduce 任务槽数目稍微少一些的 Reduce 任务个数（这样可以预留一些系统资源处理可能发生的错误）</p><h3 id="1-3-3-Shuffle-过程详解">1.3.3 Shuffle 过程详解</h3><p><img src="/img/post/16726461067379.jpg" alt=""></p><h4 id="1-3-3-1-Map-端的-shuffle-过程">1.3.3.1 Map 端的 shuffle 过程</h4><p><img src="/img/post/16726462640067.jpg" alt=""></p><ul><li><p>每个 Map 任务分配一个缓存，MapReduce 默认 100MB 缓存</p></li><li><p>设置<strong>溢写比例</strong>0.8（缓冲区数据/缓冲区大小）</p></li><li><p>分区默认采用哈希函数（对 Map 输出的 key 作 hash 取模，模为 reduce 任务数）</p></li><li><p>排序后可以合并，合并不能改变最终的结果；合并用来缩减中间节点的数据量，可选的操作（可做可不做）</p></li><li><p>在 Map 任务全部结束之前进行归并</p></li><li><p>归并得到一个大的文件（索引文件和数据文件），<strong>放在本地磁盘</strong>（同样经过分区与排序）</p></li><li><p>文件归并时，如果溢写文件数量大于预定值（默认是 3）则可以再次启动 Combiner，少于 3 不需要</p></li><li><p><strong>JobTracker</strong>会一直<strong>监测 Map 任务</strong>的执行，并通知 Reduce 任务来领取任务</p></li></ul><blockquote><p>合并和归并的区别：<br>两个键值对&lt;“a”,1&gt;和&lt;“a”,1&gt;，合并得到&lt;“a”,2&gt;（计算），归并得到&lt;“a”,&lt;1,1&gt;&gt;（聚合）</p></blockquote><p><strong>Shuffle</strong>（混洗）：输出到 Reducer 的数据为 Mapper 阶段经过排序的输出结果。在 shuffle 阶段框架将通过 HTTP 从恰当的 Mapper 的分区中取得数据</p><p><strong>Sort</strong>（排序）：该阶段框架将对输入到 Reducer 的数据通过 key（不同的 Mapper 可能输出相同的 key）进行分组。<strong>混洗和排序阶段是同时进行</strong>；map 的输出数据被获取时会进行合并</p><p><strong>Partition</strong>（分区）：Partitioner 对 map 输出的中间值的 key（Reducer 之前）进行分区。分区采用的默认方法是对 key 取 hashcode。分区数等于 job 的 reduce 任务数，根据中间结果的<strong>key 将数据传输到对应的 reduce 任务</strong>。HashPartitioner 是默认的分区器</p><h4 id="1-3-3-2-Reduce-端的-Shuffle-过程">1.3.3.2 Reduce 端的 Shuffle 过程</h4><ul><li>通过 RPC 向 JobTracker<strong>询问 Map 任务是否已经完成</strong>，若完成则领取数据</li><li>Reduce 领取数据<strong>先放入缓存</strong>，<u>来自不同 Map 机器</u>，先归并再合并写入磁盘</li><li>多个溢写文件归并成一个或多个大文件，文件中的键值对是<strong>排序</strong>的</li></ul><p><img src="/img/post/16726634063597.jpg" alt=""></p><h2 id="1-4-实例分析：WordCount">1.4 实例分析：WordCount</h2><p><img src="/img/post/16726637985775.jpg" alt=""></p><h3 id="1-4-1-编写-Map-处理逻辑">1.4.1 编写 Map 处理逻辑</h3><p>输入类型：&lt;Object, Text&gt;<br>输出类型：&lt;Text, IntWritable&gt;</p><p><img src="/img/post/16726639107191.jpg" alt=""></p><h3 id="1-4-2-编写-Reduce-处理逻辑">1.4.2 编写 Reduce 处理逻辑</h3><ul><li>Reduce 阶段任务：对输入的数字序列进行求和</li></ul><p><img src="/img/post/16726639869410.jpg" alt=""></p><h3 id="1-4-3-编写-main-方法">1.4.3 编写 main 方法</h3><p>驱动整个作业</p><p><img src="/img/post/16726641613758.jpg" alt=""></p><h2 id="1-5-MapReduce-具体应用">1.5 MapReduce 具体应用</h2><p>应用于关系代数运算（选择、投影、并、交、差、连接），分组与聚合运算</p><table><thead><tr><th>关系代数运算</th><th>Map 函数</th><th>Reduce 函数</th></tr></thead><tbody><tr><td>选择运算</td><td>对每个元组 t，满足条件则输出键值对&lt;t,t&gt;</td><td>恒等式，对输入不做任何变换</td></tr><tr><td>投影运算</td><td>剔除元组 t 中不属于投影后的字段得到 t’，输出键值对&lt;t’,t’&gt;</td><td>把属性值完全相同的元组合并起来得到&lt;t’,&lt;t’,t’,…&gt;&gt;，剔除后只得到一个&lt;t’,t’&gt;</td></tr><tr><td>求并集</td><td>将两个关系的元组转换成键值对&lt;t,t&gt;</td><td>剔除冗余数据</td></tr><tr><td>求交集</td><td>将两个关系的元组转换成键值对&lt;t,t&gt;</td><td>如果 t 有两个相同值与它关联则输出一个元组&lt;t,t&gt;，如果只有一个值，则输出空值（NULL）</td></tr><tr><td>求差集 R-S</td><td>记录元组的信息以及该元组来自哪个关系（R 或 S）</td><td>按键值相同的 t 合并后，如果与键 t 相关联的值如果只有 R（说明该元组只属于 R，不属于 S），就输出元组，其他情况均输出空值</td></tr></tbody></table><p><strong>自然连接</strong></p><p><img src="/img/post/16726654057820.jpg" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>大数据计算</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MapReduce</tag>
      
      <tag>大数据计算</tag>
      
      <tag>大数据</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH9 并发控制</title>
    <link href="/2022/12/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/"/>
    <url>/2022/12/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h1>第十一章 并发控制</h1><h2 id="11-1-并发控制概述">11.1 并发控制概述</h2><p>事务是并发控制的基本单位</p><p>并发操作带来的数据不一致性<br>R(x)：读数据 x<br>W(x)：写数据 x</p><p><strong>丢失修改</strong><br>T2 的提交结果破坏了 T1 的提交结果，导致 T1 的修改被丢失<br><img src="/img/post/16719569047645.jpg" alt=""></p><p><strong>不可重复读</strong></p><ol><li>T1 读取某一数据，T2 对其做了修改，当事务 T1 再次读该数据，得到与前一次不同的值</li><li>T1 读取某些数据，T2 删除其中部分数据，当 T1 再次读取数据，发现某些记录消失了</li><li>T1 读取某些数据，T2 插入了一些数据，当 T1 再次读取数据，发现多了一些记录</li></ol><p><img src="/img/post/16719570327616.jpg" alt=""></p><p><strong>读脏数据</strong></p><ul><li>T1 修改某一数据，并将其写回磁盘</li><li>T2 读取同一数据后，T1 由于某种原因被撤销</li><li>这时 T1 已修改过的数据恢复原值，T2 读到的数据就与数据库中的数据不一致</li><li>T2 读到的数据就为“脏”数据，即不正确的数据</li></ul><p><img src="/img/post/16719582581039.jpg" alt=""></p><h3 id="11-1-1-调度概念">11.1.1 调度概念</h3><p>调度：“事务集”中的一串有序操作集，一个事务中操作在调度中的顺序应该于他们在事务中的顺序一致</p><p>每个事务最后的行动：COMMIT 和 ROLLBACK</p><p><strong>并发控制的主要技术</strong></p><ul><li><strong>封锁</strong></li><li><strong>时间戳</strong><ul><li>事先选定事务的次序，按照这个时间戳来解决事务的冲突操作</li></ul></li><li><strong>乐观控制法</strong><ul><li>事务提交前再进行正确性检查</li></ul></li></ul><h2 id="11-2-封锁">11.2 封锁</h2><ul><li><strong>排他锁（X 锁）</strong><ul><li>若 T 对数据对象 A 加上 X 锁，则只允许 T 读取和修改 A，其他事务在 T 释放 A 上的锁之前都不能读取和修改 A</li></ul></li><li><strong>共享锁（S 锁）</strong><ul><li>T 能读取 A 不能修改 A，其他事务只能对 A 上 S 锁而不能上 X 锁，直到 T 释放 A 上的 S 锁为止</li></ul></li></ul><h2 id="11-3-封锁协议">11.3 封锁协议</h2><ul><li><strong>一级封锁协议</strong><ul><li>事务 T 在修改数据 R 之前必须先对其加 X 锁，直到事务结束才释放</li></ul></li><li><strong>二级封锁协议</strong><ul><li>在一级封锁协议的基础上增加事务 T 在读取数据 R 之前必须对其加 S 锁，读完后即可释放 S 锁</li></ul></li><li><strong>三级封锁协议</strong><ul><li>在一级封锁协议的基础上增加事务 T 在读取数据 R 之前必须先对其加 S 锁，直到事务结束才释放</li></ul></li></ul><h2 id="11-4-活锁和死锁">11.4 活锁和死锁</h2><p><strong>避免活锁</strong>：采取先来先服务原则</p><p>产生死锁的原因是两个或多个事务都已封锁了一些数据对象，然后又都请求对已为其他事务封锁的数据对象加锁，从而出现死等待现象</p><p><strong>解决死锁</strong>：</p><ul><li><strong>预防死锁</strong><ul><li>一次封锁法<ul><li>要求每个事务必须一次将所有要使用的数据全部加锁，否则就能继续执行</li></ul></li><li>顺序封锁法<ul><li>预先对数据对象规定一个封锁顺序，所有事务都按这个顺序实施封锁</li></ul></li></ul></li><li><strong>死锁的诊断与解除</strong></li></ul><p><strong>死锁的诊断</strong></p><ul><li><strong>超时法</strong><ul><li>实现简单，但有可能误判死锁，时限设置太长死锁发生后不能及时发现</li></ul></li><li><strong>事务等待图</strong><ul><li>图中存在回路则表示出现死锁<br><img src="/img/post/16719745341914.jpg" alt=""></li></ul></li></ul><p><strong>死锁的解除</strong><br>选择一个处理死锁代价最小的事务，将其撤销，释放此事务持有的所有锁，使其他事务得以继续进行下去</p><h2 id="11-5-并发调度的可串行性">11.5 并发调度的可串行性</h2><p><strong>可串行化调度</strong>：多个事务的并发执行是正确的，当且仅当其结果与按某一次序串行地执行这些事务时的结果相同。</p><p>可串行性是并发事务正确调度的准则</p><p><strong>冲突操作</strong>：不同的事务对同一个数据的<strong>读写操作</strong>和<strong>写写操作</strong>，其他不冲突</p><p><strong>冲突可串行化调度</strong>：一个调度 Sc 在保证冲突操作的次序不变的情况下，通过<strong>交换两个事务不冲突操作的次序</strong>得到另一调度 Sc’，如果 Sc’是串行的，称调度 Sc 是冲突可串行化的调度</p><p>冲突可串行化一定是可串行化调度，可串行化不一定冲突可串行化</p><blockquote><p>盲目写：在执行 W(Q)之前没有执行 R(Q)的操作，存在于任何不是冲突可串行化的视图可串行化调度中<br>视图可串行化：两个调度每个事务都读取相同数据从而进行相同的计算</p></blockquote><p><img src="/img/post/16719754001154.jpg" alt=""></p><h3 id="11-5-1-调度冲突可串行化的判定（例题）">11.5.1 调度冲突可串行化的判定（例题）</h3><p><img src="/img/post/16719775145415.jpg" alt=""></p><h2 id="11-6-两段锁协议">11.6 两段锁协议</h2><p><strong>第一阶段</strong>：获得封锁，也称为<strong>扩展阶段</strong>，事务可以申请获得任何数据项上的任何类型的锁，但是不能释放任何锁</p><p><strong>第二阶段</strong>：释放封锁，也称为<strong>收缩阶段</strong>，事务可以释放任何数据项上的任何类型的锁，但是不能再申请任何锁</p><p><img src="/img/post/16719779921873.jpg" alt=""></p><p>若并发执行的所有事务均遵守两段锁协议，则对这些事务的任何并发调度策略都是可串行化的</p><p>一次封锁发遵守两段锁协议</p><p>两段锁协议并不要求事务必须一次将所有要使用的数据全部加锁，因此遵守两段锁协议的事务可能发生死锁</p><h2 id="11-7-封锁的粒度">11.7 封锁的粒度</h2><p>封锁对象的大小称为<strong>封锁粒度</strong></p><p>封锁的对象：逻辑单元（属性值、属性值集合、元组、关系、索引项、整个索引、整个数据库），物理单元（页、物理记录）</p><ul><li>封锁的粒度越大，数据库所能够封锁的数据单元就越少，并发度就越小，系统开销也越小</li><li>封锁的粒度越小，并发度较高，但系统的开销也就越大</li></ul><h3 id="11-7-1-多粒度树">11.7.1 多粒度树</h3><ul><li>根结点是整个数据库，表示最大的数据粒度</li><li>叶结点表示最小的数据粒度</li></ul><p><img src="/img/post/16719789204317.jpg" alt=""></p><p>多粒度封锁中一个数据对象可能以两种方式封锁：</p><ul><li>显式封锁<ul><li>直接加到数据对象上的封锁</li></ul></li><li>隐式封锁<ul><li>该数据对象没有独立加锁，是由于其上级节点加锁而使该数据对象加上了锁</li></ul></li></ul><p>对某个数据对象加锁，系统要检查</p><ul><li>该数据对象<ul><li>有无显式封锁与之冲突</li></ul></li><li>所有上级结点<ul><li>检查本事务的显式封锁是否与该数据对象上的隐式封锁冲突：（由上级结点已加的封锁造成的）</li></ul></li><li>所有下级结点<ul><li>看上面的显式封锁是否与本事务的隐式封锁（将加到下级结点的封锁）冲突</li></ul></li></ul><h3 id="11-7-2-意向锁">11.7.2 意向锁</h3><p>目的：提高对某个数据对象加锁时系统的检查效率</p><p>对任一结点加基本锁，需要对上层结点加意向锁</p><p>意向锁类型：</p><ul><li>IS 锁：意向共享锁</li><li>IX 锁：意向排他锁</li><li>SIX 锁：共享意向排他锁<ul><li>例如对某个表加 SIX 锁，则表示该事务要读整个表（S 锁），同时会更新个别元组（IX 锁）</li></ul></li></ul><p><img src="/img/post/16719795929136.jpg" alt=""></p><p>具有意向锁的多粒度封锁方法</p><ul><li>申请封锁时应该按自上而下的次序进行</li><li>释放封锁时应该按自下而上的次序进行</li></ul><blockquote><p>例如：事务 T1 要对关系 R1 加 S 锁</p><ul><li>要首先对数据库加 IS 锁</li><li>要检查数据库和 R1 是否已加了与 S 不相容的锁（X 或 IX 或 SIX）</li><li>不再需要搜索和检查 R1 中的元组是否加了不相容的锁（X 锁）</li></ul></blockquote>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH8 数据库恢复技术</title>
    <link href="/2022/12/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%8D%81%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D%E6%8A%80%E6%9C%AF/"/>
    <url>/2022/12/25/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%8D%81%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D%E6%8A%80%E6%9C%AF/</url>
    
    <content type="html"><![CDATA[<h1>第十章 数据库恢复技术</h1><h2 id="10-1-事务的基本概念">10.1 事务的基本概念</h2><p><strong>事务</strong>：是用户定义的一个数据库操作序列，这些操作要么全做，要么全不做，是一个不可分割的工作单位</p><p>SQL 中定义事务的语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">BEGIN</span> TRANSACTION;  <span class="hljs-operator">/</span><span class="hljs-operator">/</span>事务开始<br><span class="hljs-keyword">COMMIT</span>;             <span class="hljs-operator">/</span><span class="hljs-operator">/</span>提交事务的所有操作，事务正常结束<br>                    <span class="hljs-operator">/</span><span class="hljs-operator">/</span>（将事务中所有对数据库的更新写回到磁盘上的物理数据库中去）<br><span class="hljs-keyword">ROLLBACK</span>;           <span class="hljs-operator">/</span><span class="hljs-operator">/</span>将事务中所有已完成的操作全部撤销，回滚到事务开始的状态<br></code></pre></td></tr></table></figure><h3 id="10-1-1-事务的-ACID-特性">10.1.1 事务的 ACID 特性</h3><ul><li><strong>原子性</strong><ul><li>事务是数据库的逻辑工作单位，操作要么都做要么都不做</li></ul></li><li><strong>一致性</strong><ul><li>数据库只包含成功事务提交的结果时，就说明数据库处于一致性状态</li></ul></li><li><strong>隔离性</strong><ul><li>一个事务的执行不能被其他事务干扰</li></ul></li><li><strong>持续性</strong><ul><li>事务一旦提交，对数据库中数据的改变就应该是永久性的</li><li>事务是恢复和并发控制的基本单位</li></ul></li></ul><p>ACID 特性可能遭到破坏的因素：</p><ul><li>不同事务的操作交叉执行</li><li>事务在运行过程中被强行停止</li></ul><h2 id="10-2-故障的种类">10.2 故障的种类</h2><ul><li><strong>事务内部的故障</strong><ul><li>运算溢出、并发事务发生死锁而被选中撤销该事务、违反了某些完整性限制而被终止</li><li><strong>UNDO</strong>：事务撤销，强行回滚该事务</li></ul></li><li><strong>系统故障</strong><ul><li>造成系统停止运转的任何事件，使得系统要重新启动，通常称为<strong>软故障</strong>（数据损坏）</li><li>例如：特定类型的硬件错误（CPU 故障）、操作系统故障、DBMS 代码错误、系统断电等</li><li>系统重新启动后，恢复子系统除需要<strong>撤销所有未完成的事务</strong>外，还需要<strong>重做所有已提交的事务</strong>，以将数据库真正恢复到一致状态。</li></ul></li><li><strong>介质故障</strong><ul><li>称为<strong>硬故障</strong>（数据库损坏）</li><li>指外存故障，如硬盘损坏、磁头碰撞、瞬时强磁场干扰等</li></ul></li><li><strong>计算机病毒</strong><ul><li>人为的故障或破坏</li></ul></li></ul><h2 id="10-3-恢复的实现技术">10.3 恢复的实现技术</h2><p>恢复的原理：<strong>冗余</strong>，根据存储在系统别处的冗余数据来重建</p><p>建立冗余数据最常用的技术是<strong>数据转储</strong>（备份）和<strong>登记日志文件</strong></p><h3 id="10-3-1-数据转储">10.3.1 数据转储</h3><p>转储即数据库管理员（DBA）定期地将整个数据库复制到磁带、磁盘或其他存储介质上保存起来的过程，这些备用的数据称为<strong>后备副本</strong>或后援副本</p><p>重装后备副本只能将数据库恢复到转储时的状态</p><ul><li><p><strong>静态转储</strong></p><ul><li><strong>实现简单</strong>，转储必须等待正运行的用户事务结束才能运行，新的事务必须等待转储结束才能执行</li><li>得到的一定是一个<strong>数据一致性的副本</strong>；会<strong>降低数据库的可用性</strong></li></ul></li><li><p><strong>动态转储</strong></p><ul><li>转储和用户事务可以并发执行</li><li>转储结束时后备副本上的数据并不能保证正确有效</li></ul></li><li><p><strong>海量转储</strong></p><ul><li>每次转储全部数据库</li></ul></li><li><p><strong>增量转储</strong></p><ul><li>每次只转储上一次转储后更新过的数据</li></ul></li></ul><h3 id="10-3-2-登记日志文件">10.3.2 登记日志文件</h3><p><strong>日志文件需要登记的内容</strong></p><ul><li>各个事务的开始（BEGIN TRANSACTION）标记</li><li>各个事务的结束（COMMIT 或 ROLLBACK）标记</li><li>各个事务的所有更新操作</li></ul><p><strong>日志记录的内容</strong></p><ul><li>事务标识（标明是哪个事务）</li><li>操作的类型（插入、删除或修改）</li><li>操作对象（记录内部标识）</li><li>更新前数据的旧值（对插入操作而言，此项为空值）</li><li>更新后数据的新值（对删除操作而言，此项为空值）</li></ul><p>利用日志文件恢复<br><img src="/img/post/16719542905530.jpg" alt=""></p><p>日志文件可以用来进行事务故障恢复和系统故障恢复，并协助后备副本进行介质故障恢复</p><p><strong>登记日志文件需要遵循的两条原则</strong></p><ul><li>登记的次序严格按并发事务执行的时间次序</li><li>必须先写日志文件，后写数据库</li></ul><h2 id="10-4-恢复策略">10.4 恢复策略</h2><table><thead><tr><th>故障</th><th>恢复策略</th><th>备注</th></tr></thead><tbody><tr><td>事务故障</td><td>UNDO</td><td></td></tr><tr><td>系统故障</td><td>UNDO（故障发生前未完成的事务）+REDO（已完成的事务，完成可能还在缓冲区没存到磁盘）</td><td></td></tr><tr><td>介质故障</td><td>重装备份到一致状态+REDO</td><td>对于静态转储，装入最新的数据库后备副本即恢复一致性；对于动态转储，还需同时装入转储开始时刻的日志文件副本，REDO+UNDO，才能恢复一致性状态；需要数据库管理员的介入</td></tr></tbody></table><h2 id="10-5-具有检查点的恢复技术">10.5 具有检查点的恢复技术</h2><p>增加一个<strong>重新开始文件</strong></p><p><strong>检查点记录内容</strong>包括：</p><ul><li>建立检查点时刻所有正在执行的事务清单</li><li>这些事务最近一个日志揭露的地址</li></ul><p><strong>重新开始文件</strong>用来记录各个检查点记录在日志文件中的地址</p><p><img src="/img/post/16719556905762.jpg" alt=""></p><p><img src="/img/post/16719557187660.jpg" alt=""></p><h2 id="10-6-数据库镜像">10.6 数据库镜像</h2><p>实际应用中用户往往只选择对关键数据和日志文件进行镜像，而不是对整个数据库进行镜像</p><p>主数据库负责数据的更新</p><p><img src="/img/post/16719559584876.jpg" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
      <tag>SQL语言</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH7 数据库设计</title>
    <link href="/2022/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"/>
    <url>/2022/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1>第七章 数据库设计</h1><h2 id="7-1-数据库设计概述">7.1 数据库设计概述</h2><p>数据库设计的特点“三分技术，七分管理，十二分基础数据”</p><h3 id="7-1-1-数据库设计的六个阶段（熟练掌握）">7.1.1 数据库设计的六个阶段（熟练掌握）</h3><ul><li><strong>需求分析</strong><ul><li>准确了解与分析用户需求（包括数据与处理）</li><li>最困难、最耗费时间的一步</li></ul></li><li><strong>概念结构设计</strong><ul><li>整个数据库设计的关键</li><li>形成一个独立于具体数据库管理系统的概念模型</li></ul></li><li><strong>逻辑结构设计</strong><ul><li>将概念结构转换为某个 DBMS 所支持的数据模型</li><li>优化</li></ul></li><li><strong>物理结构设计</strong><ul><li>为逻辑结构选取一个最适合应用环境的物理结构（包括存储结构和存取方法）</li></ul></li><li><strong>数据库实施</strong><ul><li>建立数据库</li><li>编制与调试应用程序</li><li>组织数据入库</li><li>进行试运行</li></ul></li><li><strong>数据库运行和维护</strong><ul><li>经过试运行即可投入正式运行</li><li>运行过程中不断进行评估、调整与修改</li></ul></li></ul><p><strong>需求分析和概念设计独立于任何数据库管理系统</strong></p><p>逻辑设计和物理设计与选用的 DBMS 密切相关</p><p><img src="/img/post/16718867044639.jpg" alt="数据库设计各个阶段的设计描述"></p><h3 id="7-1-2-数据库设计过程中的各级模式">7.1.2 数据库设计过程中的各级模式</h3><p><img src="/img/post/16718869311421.jpg" alt=""></p><h2 id="7-2-需求分析">7.2 需求分析</h2><h3 id="7-2-1-需求分析过程">7.2.1 需求分析过程</h3><p><img src="/img/post/16718872124515.jpg" alt=""></p><h3 id="7-2-2-数据字典">7.2.2 数据字典</h3><p><strong>用途</strong>：进行详细的数据收集和数据分析所获得主要成果</p><p>数据字典是关于数据库中数据的描述，是<strong>元数据</strong>，而不是数据本身，在<strong>需求分析</strong>阶段建立，<strong>强调用户的参与</strong></p><p><strong>内容</strong></p><ul><li><strong>数据项</strong><ul><li>不可再分的数据单位</li><li>数据项描述 = {数据项名，数据项含义说明，别名，数据类型，长度，取值范围，取值含义，与其他数据项的逻辑关系，数据项之间的联系}<ul><li>“取值范围”、“与其他数据项的逻辑关系”定义了数据的完整性约束条件</li></ul></li></ul></li><li><strong>数据结构</strong><ul><li>数据之间的组合关系</li><li>数据结构描述 = {数据结构名，含义说明，组成：{数据项或数据结构}}</li></ul></li><li><strong>数据流</strong><ul><li>数据结构在系统内传输的路径</li><li>数据流描述 = {数据流名，说明，数据流来源，数据流去向，组成：{数据结构}，平均流量，高峰期流量}</li></ul></li><li><strong>数据存储</strong><ul><li>数据结构停留或保存的地方，也是数据流的来源和去向之一</li><li>数据存储描述 = {数据存储名，说明，编号，输入的数据流，输出的数据流，组成：{数据结构}，数据量，存取频度，存取方式}</li></ul></li><li><strong>处理过程</strong><ul><li>一般用判定表或判定树来描述</li><li>处理过程描述 = {处理过程名，说明，输入：{数据流}，输出：{数据流}，处理：{简要说明}}</li></ul></li></ul><h2 id="7-3-概念结构">7.3 概念结构</h2><h3 id="7-3-1-E-R-模型">7.3.1 *E-R 模型</h3><pre><code class=" mermaid">graph TB实体集a([属性])b&#123;联系集&#125;</code></pre><h3 id="7-3-2-概念结构设计">7.3.2 概念结构设计</h3><p>为了简化 E- R 图的处置，现实世界的事物能作为属性对待的尽量作为属性对待</p><ul><li>作为属性不能再具有需要描述的性质</li><li>属性不能与其他实体具有联系</li></ul><ol><li>合并 E-R 图。生成初步的 E-R 图<br>产生冲突：<ul><li>属性冲突</li><li>命名冲突</li><li>结构冲突</li></ul></li><li>消除不必要的冗余，设计基本 E-R 图<ul><li>冗余容易破坏数据库的完整性，给数据库维护增加困难</li></ul></li></ol><h2 id="7-4-逻辑结构">7.4 逻辑结构</h2><p>把概念结构设计阶段设计好的基本 E-R 图转换为与选用数据库管理系统产品所支持的数据模型相符合的逻辑结构</p><h3 id="7-4-1-转化规则：">7.4.1 转化规则：</h3><ul><li>一个实体型转换为一个独立的关系模式</li><li>1:1 联系可以与任何一端的关系模式合并</li><li>1:n 联系一般和多端合并，放上 1 端的候选码</li><li>m:n 转换成一个独立的关系模式</li><li>三个或三个以上实体间的一个多元联系可以转换为一个关系模式</li></ul><h3 id="7-4-2-数据模型的优化">7.4.2 数据模型的优化</h3><p>对关系模式进行必要分解，提高数据操作效率和存储空间利用率。常用的两种分解方法是<strong>水平分解</strong>和<strong>垂直分解</strong></p><h2 id="7-5-物理结构">7.5 物理结构</h2><p>关系模式常用<strong>存取方法</strong>：<u>索引方法</u>和<u>聚簇方法</u></p><p>B+树索引和 hash 索引是数据库中经典的存取方法</p><h2 id="7-6-例题">7.6 例题</h2><p><img src="/img/post/16718901231457.jpg" alt=""></p><h2 id="第七章相关习题">第七章相关习题</h2><ol><li>在数据库设计中，把数据需求写成文档，它是个类数据描述的集合，包括数据项、数据结构、数据流、数据存储和数据加工过程等的描述，通常称为 <u>数据字典</u></li><li>E- R 图向关系模型转化要解决的问题是如何将实体和实体之间的的联系转换成关系模式，并如何确定这些关系模式的<u>属性</u>和<u>码</u></li><li>为提高数据操作的效率和存储空间的利用率，经过规范化处理之后的关系模式还需要进行一定的优化处理。优化是根据需求分析和概念设计中定义的事务的特点对关系模式进行必要的分解，常用的两种分解方法是<u>水平分解</u>和<u>垂直分解</u></li><li>将概念模型转换为全局逻辑模型后，还需根据局部应用需求，结合具体 DBMS 的特点，设计<u>用户的外模式（或用户视图）</u></li><li>E-R 图是数据库设计的工具之一，它适用于建立数据库的<u>概念模型</u></li><li>数据库逻辑设计阶段的任务是<u>建立数据模型</u></li><li>数据流程图（DFD）是用于描述结构化方法中<u>需求分析</u>阶段的工具</li></ol>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库设计</tag>
      
      <tag>数据库</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH6 关系数据理论</title>
    <link href="/2022/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%90%86%E8%AE%BA/"/>
    <url>/2022/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%90%86%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<h1>第六章 关系数据理论</h1><h2 id="6-1-规范化">6.1 规范化</h2><h3 id="6-1-1-函数依赖">6.1.1 函数依赖</h3><p>（R(U)是属性集 U 上的关系模式，X，Y 是 U 的子集）<strong>X 函数确定 Y 或 Y 函数依赖于 X</strong>，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></p><blockquote><p>只能根据语义来确定一个函数依赖，例如：姓名-&gt;年龄这个函数依赖只有在该部门没有同名人的条件下成立，如果允许有同名人，则年龄就不再函数依赖于姓名</p><p>一些术语和记号：</p></blockquote><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，但<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊈</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\nsubseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0966em;vertical-align:-0.3027em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⊈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则称<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>是<strong>非平凡</strong>的函数依赖，反之称为平凡的函数依赖<ul><li><blockquote><p>平凡依赖是必然成立的，我们总是讨论非平凡的函数依赖</p></blockquote></li></ul></li><li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则称 X 是<strong>决定因素</strong></li><li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \to X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \leftarrow \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></li><li>若 Y 不函数依赖于 X，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>↛</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \nrightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></li><li><strong>完全函数依赖：</strong> Y 依赖于 X 但是不依赖于 X 的任何一个真子集，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><msup><mo>→</mo><mi>F</mi></msup><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to^F Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">→</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></li><li><strong>部分函数依赖：</strong> Y 对 X 的子集依赖，记作<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><msup><mo>→</mo><mi>P</mi></msup><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to ^PY</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">→</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></li><li><strong>传递函数依赖：</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>⊈</mo><mi>X</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>Y</mi><mo>↛</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>Z</mi><mo separator="true">,</mo><mi>Z</mi><mo>⊈</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y(Y \nsubseteq X), Y\nrightarrow X, Y \to Z,Z \nsubseteq Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0966em;vertical-align:-0.3027em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⊈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0966em;vertical-align:-0.3027em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">⊈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span><ul><li><blockquote><p>这里加上条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>↛</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \nrightarrow X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">↛</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，因为如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y\to X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>←</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\leftarrow \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，实际上就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><msup><mo>→</mo><mtext>直接</mtext></msup><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to ^{直接} Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel">→</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">直接</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，是直接函数依赖而不是传递函数依赖</p></blockquote></li></ul></li></ul><h3 id="6-1-2-码">6.1.2 码</h3><ul><li><strong>候选码：</strong> 设 K 为 R(U,F)中的属性或属性集合，若 U 对 K 完全函数依赖，则 K 为 R 的候选码</li><li><strong>超码：</strong> U 部分依赖于 K。<strong>候选码是最小的超码</strong></li><li><strong>主码</strong>：若候选码多余一个，则选定其中的一个为主码</li><li><strong>主属性：</strong> 包含在任何一个候选码中的属性</li><li><strong>全码</strong>：整个属性组是码</li><li><strong>外码</strong>：关系模式 R 中属性或属性组<strong>X 并非 R 的码</strong>，但<strong>X 是另外一个关系模式的码</strong>，则称 X 是 R 的外码</li></ul><h3 id="6-1-3-范式">6.1.3 范式</h3><h4 id="6-1-3-1-2NF">6.1.3.1 2NF</h4><p>每一个非主属性完全函数依赖于（不部分依赖于）任何一个候选码</p><h4 id="6-1-3-2-3NF">6.1.3.2 3NF</h4><p>每一个非主属性既不不传递依赖于码，也不部分依赖于码</p><h4 id="6-1-3-3-BCNF">6.1.3.3 BCNF</h4><p>每一个决定因素都包含码</p><p><strong>若 3NF 只有唯一候选吗，则一定为 BCNF</strong></p><p><strong>全主属性一定可达 3NF，全码一定可达 BCNF</strong></p><h4 id="6-1-3-4-多值依赖">6.1.3.4 多值依赖</h4><p>R(U)是属性集 U 上的一个关系模式，X，Y，Z 是 U 的子集，并且 U=X+Y+Z，如果<strong>一个 X 的值决定一组 Y 的值</strong>，则<strong>多值依赖</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>成立</p><ul><li><strong>平凡多值依赖：</strong> Z 为空集，即 U=X+Y，且多值依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>成立</li><li><strong>非平凡多值依赖：</strong> Z 非空</li></ul><p>函数依赖可以看作是多值依赖的特殊情况</p><blockquote><p>多值依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>若在 R(U)上成立，不能断言对于任何<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⊂</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y&#x27;\subset Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><msup><mi>Y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">X\to\to Y&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>成立</p></blockquote><h4 id="6-1-3-5-4NF">6.1.3.5 4NF</h4><p>不允许有非平凡且非函数依赖的多值依赖</p><p>4NF 所允许的非平凡的多值依赖实际上就是函数依赖</p><p><strong>若一个关系模式为 4NF，则必为 BCNF</strong></p><p><strong>4NF 中：</strong></p><ul><li>非平凡的多值依赖<ul><li>x 含码 -&gt; 多值依赖也是函数依赖</li></ul></li><li>平凡的多值依赖<ul><li>x 含码 -&gt; 是函数依赖</li><li>x 不含码 -&gt; 不是函数依赖</li></ul></li></ul><p><img src="/img/post/16718706867902.jpg" alt=""></p><h4 id="6-1-3-6-例题：判断范式">6.1.3.6 例题：判断范式</h4><p><img src="/img/post/16718718543485.jpg" alt=""></p><h2 id="6-2-数据依赖的公理系统-armstrong-公理系统">6.2 数据依赖的公理系统 armstrong 公理系统</h2><p><strong>F 逻辑蕴涵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></strong>:关系模式 R&lt;U, F&gt;中，函数依赖<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>成立</p><ul><li>有效性：由 F 出发依据公理推出的每个函数依赖一定在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>中</li><li>完备性：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>中每个函数依赖一定可以由 F 出发根据公理推导出来</li></ul><h3 id="6-2-1-推理规则">6.2.1 推理规则</h3><p>对 R&lt;U, F&gt;有以下推理规则：</p><ul><li><strong>自反律：</strong><ul><li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Y \subseteq X \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴涵</li><li>子集对全集一定有平凡函数依赖</li><li>自反律得到的函数依赖均是平凡的函数依赖，自反律的使用并不依赖于 F</li></ul></li><li><strong>增广律：</strong><ul><li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴涵，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Z \subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>Z</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">XZ \to YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">XZ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴涵</li><li>左右各加了一个属性</li></ul></li><li><strong>传递律：</strong><ul><li>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>及<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y \to X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 所蕴涵，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>为 F 所蕴涵</li><li>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>→</mo><mi>X</mi><mo separator="true">,</mo><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y \to X, X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，则符合传递律但不符合传递函数依赖</li></ul></li><li><strong>合并规则</strong><ul><li>由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li></ul></li><li><strong>伪传递规则</strong><ul><li>由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">WY \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">WY</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>W</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">XW \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li></ul></li><li><strong>分解规则</strong><ul><li>由<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \to Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z \subseteq Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X \to Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></li></ul></li></ul><h3 id="6-2-2-闭包">6.2.2 闭包</h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>：F 的闭包，F 所逻辑蕴含的函数依赖的全体</p><h4 id="6-2-2-1-求闭包的步骤">6.2.2.1 求闭包的步骤</h4><ol><li>所有空集依赖</li><li>自身依赖，然后增广律扩充</li><li>原本关系增光扩充</li></ol><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X^+_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.105em;vertical-align:-0.2935em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4065em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span></span>：属性集 X 关于函数依赖集 F 的闭包（左边全是 X 的函数依赖）</p><blockquote><p>求候选码：一组属性集的闭包是全集</p></blockquote><h4 id="6-2-2-2-求属性集-X-闭包的算法">6.2.2.2 求属性集 X 闭包的算法</h4><ol><li>令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mn>0</mn></msup><mo>=</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">X^0 = X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></li><li>求 B，此时 B 为函数依赖中左边为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">X^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span>的函数依赖的右边部分的集合</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>B</mi><mo>∪</mo><msup><mi>X</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">X^{i+1} = B \cup X^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></li><li>判断<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>X</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">X^{i+1} = X^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></li><li>如果相等或等于 U，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">X^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span>就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X^+_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.105em;vertical-align:-0.2935em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4065em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2935em;"><span></span></span></span></span></span></span></span></span></span>，算法终止</li><li>若否，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i = i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7429em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，返回第二步（就是把 B 合并进去了）</li></ol><blockquote><p>不在函数依赖右边出现的属性一定是候选码组成部分</p></blockquote><h4 id="6-2-2-3-等价与最小覆盖">6.2.2.3 等价与最小覆盖</h4><ul><li><strong>函数依赖集等价</strong><ul><li>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mo>+</mo></msup><mo>=</mo><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">G^+ = F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7713em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>，就说函数依赖集 F 覆盖 G（F 是 G 的覆盖，或 G 是 F 的覆盖），或 F 与 G 等价</li></ul></li><li><strong>最小依赖集/最小覆盖</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">F_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><ul><li>F 中任一函数依赖的右部仅含有一个属性</li><li>不存在冗余的函数依赖</li><li>函数依赖左部要尽可能简（不能再用子集替代）</li></ul></li></ul><h4 id="6-2-2-4-求最小依赖集的方法">6.2.2.4 求最小依赖集的方法</h4><ol><li>判断右边，分解右端</li><li>去冗余函数依赖</li><li>判断左边，左边如果有多属性值，用子集代替之后判断是否保持函数依赖</li></ol><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mtext>不一定是唯一的</mtext></mrow><annotation encoding="application/x-tex">F_m不一定是唯一的</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">不一定是唯一的</span></span></span></span></p><p><strong>例：</strong></p></blockquote><p><img src="/img/post/16718722127099.jpg" alt=""></p><h2 id="6-3-模式分解">6.3 模式分解</h2><p><strong>投影：</strong> 函数依赖集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace linebreak="newline"></mspace><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>→</mo><mi>Y</mi><mo>∈</mo><msup><mi>F</mi><mo>+</mo></msup><mo>∧</mo><mi>X</mi><mi>Y</mi><mo>⊆</mo><msub><mi>U</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace></mrow></mrow><annotation encoding="application/x-tex">\\{ X \to Y|X\to Y\in F^+ \wedge XY\subseteq U_i\\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace newline"></span></span></span></span></span> 的一个覆盖 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">F_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 叫做 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span> 在属性 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上的投影</p><ul><li><strong>无损连接性</strong><br>保证不丢失信息</li><li><strong>保持函数依赖性</strong><br>减轻或解决各种异常情况</li></ul><h3 id="题型-1-判断是否保持函数依赖和无损连接性">题型 1:判断是否保持函数依赖和无损连接性</h3><p><strong>例一</strong><br><img src="/img/post/16718731711350.jpg" alt=""></p><hr><p><strong>例二</strong> （有隐藏的函数依赖，注意判断）</p><p><img src="/img/post/16718733465879.jpg" alt=""></p><h3 id="题型-2-模式分解">题型 2:模式分解</h3><p><strong>判断是否需要分解的理由（一般是分解到 3NF）</strong></p><p>范式太低，会存在插入、修改、删除数据的异常</p><h4 id="1-分解为-3NF">1:分解为 3NF</h4><p><img src="/img/post/16718726837430.jpg" alt=""></p><h4 id="2-分解为-BCNF">2:分解为 BCNF</h4><p><strong>例一</strong></p><p><img src="/img/post/16718728492261.jpg" alt=""></p><hr><p><strong>例二</strong> （损失了函数依赖）</p><p><img src="/img/post/16718729190952.jpg" alt=""></p><h4 id="3-分解为-4NF">3:分解为 4NF</h4><p><strong>例一</strong></p><p><img src="/img/post/16718730468843.jpg" alt=""></p><hr><p><strong>例二</strong> （损失函数依赖）</p><p><img src="/img/post/16718730707856.jpg" alt=""></p><h3 id="6-3-1-总结">6.3.1 总结</h3><ul><li>若要求分解具有<strong>无损连接性</strong>，模式分解一定可达 4NF（函数依赖范畴一定可达 BCNF）</li><li>若要求分解保持<strong>函数依赖</strong>，模式分解一定可达 3NF，不一定可达 BCNF</li><li>若要求分解<strong>既保持函数依赖又具有无损连接性</strong>，模式分解一定可达 3NF，不一定可达 BCNF</li></ul>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
      <tag>关系数据</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python网络爬虫理论复习</title>
    <link href="/2022/12/23/python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%90%86%E8%AE%BA%E5%A4%8D%E4%B9%A0/"/>
    <url>/2022/12/23/python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%90%86%E8%AE%BA%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>第一章 web 网站与访问</h1><h2 id="1-1-POST-方法向网站发送数据、GET-POST-混合方法向网站发送数据">1.1 POST 方法向网站发送数据、GET+POST 混合方法向网站发送数据</h2><table><thead><tr><th></th><th>GET</th><th>POST</th><th>GET+POST</th></tr></thead><tbody><tr><td>用途、语义上</td><td>信息获取（查询）</td><td>资源请求（增删改）</td><td>信息或资源的（增删改查）</td></tr><tr><td>传参方式</td><td>URL 传值</td><td>表单传值（request body 传参）</td><td>URL 传值+表单传值</td></tr><tr><td>服务器端获取数据方法</td><td>args</td><td>form</td><td>(args+form)/values</td></tr><tr><td>特点</td><td>适用于发送数据较小的场景；后退、刷新无害，速度快；书签可被收藏缓存，所有人可见，安全性差</td><td>适用于发送数据较大的场景；后退、刷新需要重新提交数据，速度慢；书签不可收藏、不能缓存，不可见，更安全</td><td>适用于所有场景，优缺点融合</td></tr></tbody></table><h2 id="1-2-Web-下载文件">1.2 Web 下载文件</h2><p>服务器向客户端发送文件名称和文件数据的过程</p><pre><code class=" mermaid">graph LR    f(服务器端)--1.启动服务器,返回可下载文件名称到客户端--&gt;k(客户端)    k(客户端)--2.发送拟下载的文件名称到服务器端--&gt;f(服务器端)    f(服务器端)--3.获取拟下载文件名称并返回文件的数据到客户端--&gt;k(客户端)    k--4.客户端接收并保存数据--&gt;k</code></pre><h2 id="1-3-Web-上传文件">1.3 Web 上传文件</h2><p>客户端把文件发送到服务器（服务器接收数据的过程）</p><pre><code class=" mermaid">graph LR    f(服务器端)--1.启动服务器--&gt;k(客户端)    k--2.客户端组织好上传的文件,并发送到服务器端--&gt;f    f--3.服务器获取拟上传文件名称和数据,保存到服务器端--&gt;f</code></pre><h2 id="1-4-正则表达式">1.4 正则表达式</h2><table><thead><tr><th>操作符</th><th>说明</th><th>实例</th></tr></thead><tbody><tr><td><code>.</code></td><td>任何单个字符</td><td></td></tr><tr><td><code>[]</code></td><td>字符集</td><td><code>[abc]</code>表示 a、b、c，<code>[a-z]</code>表示 a 到 z 单个字符</td></tr><tr><td><code>[^]</code></td><td>非字符集（排除范围）</td><td><code>[^abc]</code>表示非 a 非 b 非 c 的单个字符</td></tr><tr><td><code>*</code></td><td>前一个字符 0 次或无限次扩展</td><td><code>abc*</code>表示 ab、abc、abcc、abccc 等</td></tr><tr><td><code>+</code></td><td>前一个字符 1 次获无限次扩展</td><td><code>abc+</code>表示 abc、abcc、abccc 等</td></tr><tr><td><code>?</code></td><td>前一个字符 0 次或 1 次扩展</td><td><code>abc?</code>表示 ab、abc</td></tr><tr><td><code>｜</code></td><td>左右表达式任意一个</td><td><code>abc｜def</code>表示 abc、def</td></tr><tr><td><code>&#123;m&#125;</code></td><td>扩展前一个字符 m 次</td><td><code>ab&#123;2&#125;c</code>表示 abbc</td></tr><tr><td><code>&#123;m,n&#125;</code></td><td>扩展前一个字符 m 至 n 次（含 n）</td><td><code>ab&#123;1,2&#125;c</code>表示 abc、abbc</td></tr><tr><td><code>^</code></td><td>匹配字符串开头</td><td><code>^abc</code>表示 abc 且在一个字符串的开头</td></tr><tr><td><code>$</code></td><td>匹配字符串结尾</td><td><code>abc$</code>表示 abc 且在一个字符串的结尾</td></tr><tr><td><code>()</code></td><td>分组标记，内部只能使用<code>｜</code>操作符</td><td><code>(abc)</code>表示 abc，<code>(abc｜def)</code>表示 abc、def</td></tr><tr><td><code>\d</code></td><td>数字，等价于[0-9]</td><td></td></tr><tr><td><code>\w</code></td><td>单词字符，等价于[A-Za-z0-9_]，A-Z 和 a-z 以及数字和下划线</td><td></td></tr><tr><td><code>\s</code></td><td>匹配到一个空白字符（\n, \t, \r, 空格）</td><td></td></tr></tbody></table><h3 id="1-4-1-正则表达式的使用">1.4.1 正则表达式的使用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re   <span class="hljs-comment"># python标准库，用于字符串匹配</span><br>reg = <span class="hljs-string">r&quot;\d+&quot;</span>    <span class="hljs-comment"># 表示匹配连续的多个数值，在这里表示匹配连续多个数字</span><br>m = re.search(reg, <span class="hljs-string">&quot;abc123cd&quot;</span>)<br><span class="hljs-built_in">print</span>(m)<br><br><span class="hljs-comment"># 结果：</span><br>&lt;_sre.SRE_Match <span class="hljs-built_in">object</span>; span=(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>), <span class="hljs-keyword">match</span>=<span class="hljs-string">&#x27;123&#x27;</span>&gt;<br><span class="hljs-comment"># 找到连续的数值：“123”，span(3,6)表示开始位置是3，结束位置是6</span><br></code></pre></td></tr></table></figure><h3 id="1-4-2-经典正则表达式">1.4.2 经典正则表达式</h3><table><thead><tr><th>表达式</th><th>表示的字符串</th></tr></thead><tbody><tr><td><code>^[A-Za-z]+$</code></td><td>由 26 个字母组成的字符串</td></tr><tr><td><code>^[A-Za-z0-9]+$</code></td><td>由 26 个字母和数字组成的字符串</td></tr><tr><td><code>^-?\d+$</code></td><td>整数形式的字符串</td></tr><tr><td><code>^[0-9]*[1-9][0-9]*$</code></td><td>正整数形式的字符串</td></tr><tr><td><code>[1-9]\d&#123;5&#125;</code></td><td>中国境内邮政编码，6 位</td></tr><tr><td><code>\u4e00-\u9fa5</code></td><td>匹配中文字符</td></tr><tr><td><code>d&#123;3&#125;-\d&#123;8&#125;｜\d&#123;4&#125;-\d&#123;7&#125;</code></td><td>国内电话号码，010-73849573</td></tr></tbody></table><h3 id="1-4-3-Re-库主要功能函数">1.4.3 Re 库主要功能函数</h3><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>re.search()</td><td>一个字符串中搜索匹配正则表达式的第一个位置，返回 match 对象</td></tr><tr><td>re.match()</td><td>从一个字符串的开始位置起匹配正则表达式，返回 match 对象</td></tr><tr><td>re.findall()</td><td>搜索字符串，以列表类型返回全部能匹配的子串</td></tr><tr><td>re.split()</td><td>按照正则表达式匹配结果进行分割，返回列表类型</td></tr><tr><td>re.finditer()</td><td>搜索字符串，返回一个匹配结果的迭代类型，每个迭代元素是 match 对象</td></tr><tr><td>re.sub()</td><td>在一个字符串中替换所有匹配正则表达式的子串，返回替换后的字符串</td></tr></tbody></table><h3 id="1-4-4-Re-库另一种等价用法">1.4.4 Re 库另一种等价用法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;[1-9]\d&#123;5&#125;&#x27;</span>,<span class="hljs-string">&#x27;BIT100081&#x27;</span>)<br><br>等价于：<br>pat = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;[1-9\d&#123;5&#125;]&#x27;</span>) <span class="hljs-comment"># 编译为正则表达式对象</span><br><span class="hljs-keyword">match</span> = pat.search(<span class="hljs-string">&#x27;BIT100081&#x27;</span>)<br></code></pre></td></tr></table></figure><h1>第二章 web 网页数据爬取方法 BeautifulSoup</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br>soup = BeautifulSoup(<span class="hljs-string">&#x27;&lt;p&gt;data&lt;\p&gt;&#x27;</span>, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br></code></pre></td></tr></table></figure><p>bs4 库的<strong>prettity()</strong> 方法，<code>soup.prettity()</code>补全 html 文档</p><h2 id="2-1-BeautifulSoup-查找文档元素">2.1 BeautifulSoup 查找文档元素</h2><ul><li>基本元素：<ul><li><strong>.name</strong>，获取标签名称</li><li><strong>.attrs</strong>，获取标签内所有属性，返回一个字典</li><li><strong>.string</strong>，获取标签的文本信息，如果标签内包含了多个子节点并有多个文本时返回 None</li></ul></li></ul><h2 id="2-2-BeautifulSoup-遍历文档元素">2.2 BeautifulSoup 遍历文档元素</h2><table><thead><tr><th>标签类型</th><th>标签迭代类型</th></tr></thead><tbody><tr><td>.contents, .parent, .next_sibling, .previous_sibling</td><td>.children, .parents, .descendants, .next_siblings, .previous_siblings</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取父·祖先节点</span><br><span class="hljs-built_in">print</span>(soup.p.parent)  <span class="hljs-comment"># 获取p标签的直接父节点</span><br><span class="hljs-built_in">print</span>(soup.p.parents)  <span class="hljs-comment"># 获取p标签的祖先节点，返回一个生成器</span><br><span class="hljs-comment"># 获取子·子孙节点</span><br><span class="hljs-built_in">print</span>(soup.p.contents)  <span class="hljs-comment"># 获取p标签内的直接子节点，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.p.children)  <span class="hljs-comment"># 获取p标签内的直接子节点，返回一个生成器</span><br><span class="hljs-built_in">print</span>(soup.p.descendants)  <span class="hljs-comment"># 获取p标签内的子孙节点，返回一个生成器</span><br><span class="hljs-comment"># 获取兄弟节点</span><br><span class="hljs-built_in">print</span>(soup.a.previous_sibling)  <span class="hljs-comment"># 获取a标签的上一个兄弟节点</span><br><span class="hljs-built_in">print</span>(soup.a.previous_siblings)  <span class="hljs-comment"># 获取a标签前面的所有兄弟节点，返回一个生成器</span><br><span class="hljs-built_in">print</span>(soup.a.next_sibling)  <span class="hljs-comment"># 获取a标签的下一个兄弟节点</span><br><span class="hljs-built_in">print</span>(soup.a.next_siblings)  <span class="hljs-comment"># 获取a标签后面的所有兄弟节点，返回一个生成器</span><br></code></pre></td></tr></table></figure><h3 id="2-2-1-使用方法选择器">2.2.1 使用方法选择器</h3><ul><li><strong>find()</strong> 返回匹配到的第一个结果</li><li><strong>find_all()</strong> 返回一个包含所有匹配结果的列表</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(soup.find_all(text=re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;Lacie&#x27;</span>), limit=<span class="hljs-number">2</span>))  <span class="hljs-comment"># 使用正则获取所有文本包含&#x27;Lacie&#x27;的节点（limit: 限制匹配个数）</span><br><span class="hljs-built_in">print</span>(soup.find_all(<span class="hljs-string">&#x27;a&#x27;</span>, text=<span class="hljs-string">&#x27;Lacie&#x27;</span>))  <span class="hljs-comment"># 获取所有a标签内文本等于&#x27;Lacie&#x27;的节点（文本完整匹配）</span><br><span class="hljs-built_in">print</span>(soup.find_all(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;link2&#x27;</span>))  <span class="hljs-comment"># 获取所有a标签内id等于&#x27;link2&#x27;的节点</span><br><span class="hljs-built_in">print</span>(soup.find_all(<span class="hljs-string">&#x27;a&#x27;</span>, class_=<span class="hljs-string">&#x27;sister&#x27;</span>))  <span class="hljs-comment"># 获取所有a标签内class等于&#x27;sister&#x27;的节点</span><br><span class="hljs-built_in">print</span>(soup.find_all(<span class="hljs-string">&#x27;a&#x27;</span>, class_=<span class="hljs-string">&#x27;sister&#x27;</span>, <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;link2&#x27;</span>))  <span class="hljs-comment"># 多个搜索条件叠加</span><br><span class="hljs-built_in">print</span>(soup.find_all(name=<span class="hljs-string">&#x27;a&#x27;</span>))  <span class="hljs-comment"># 获取所有a节点</span><br><span class="hljs-built_in">print</span>(soup.find_all(attrs=&#123;<span class="hljs-string">&#x27;class&#x27;</span>: <span class="hljs-string">&#x27;sister&#x27;</span>&#125;))  <span class="hljs-comment"># 获取所有class属性值为&#x27;sister&#x27;的节点</span><br></code></pre></td></tr></table></figure><h2 id="2-3-使用-CSS-语法查找元素">2.3 使用 CSS 语法查找元素</h2><h3 id="2-3-1-使用-CSS-语法">2.3.1 使用 CSS 语法</h3><ul><li><strong>调用规则：</strong><code>tag.select(css)</code></li><li><strong>一般结构：</strong><code>[tagName][attName[=value]]</code></li></ul><h3 id="2-3-2-语法规则">2.3.2 语法规则</h3><table><thead><tr><th>选择器</th><th>描述</th></tr></thead><tbody><tr><td>[attName]</td><td>选取带有指定属性的字符串</td></tr><tr><td>[attName=value]</td><td>选取带有指定属性和值的字符串</td></tr><tr><td>[attName^=value]</td><td>匹配属性值以指定值开头的每个元素</td></tr><tr><td>[attName$=value]</td><td>匹配属性值以指定值结尾的每个元素</td></tr><tr><td>[attName*=value]</td><td>匹配属性值包含指定值的每个元素</td></tr></tbody></table><h3 id="2-3-3-select-查找">2.3.3 select 查找</h3><table><thead><tr><th>select 查找子孙节点</th><th>select 查找直接子节点</th><th>select 查找兄弟节点</th></tr></thead><tbody><tr><td>div p</td><td>div&gt;p</td><td>div~p，后续所有同级别的节点；div+p，后续第一个同级别的兄弟节点</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;p&#x27;</span>))  <span class="hljs-comment"># 获取所有p标签，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;p a&#x27;</span>))  <span class="hljs-comment"># 获取所有p标签内的a节点，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;p.story&#x27;</span>))  <span class="hljs-comment"># 获取p标签内class为&#x27;story&#x27;的所有元素，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;.story&#x27;</span>))  <span class="hljs-comment"># 获取class为&#x27;story&#x27;的所有元素，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;.beautiful.title&#x27;</span>))  <span class="hljs-comment"># 获取class为&#x27;beautiful title&#x27;的所有元素，返回一个列表</span><br><span class="hljs-built_in">print</span>(soup.select(<span class="hljs-string">&#x27;#link1&#x27;</span>))  <span class="hljs-comment"># 获取id为&#x27;link1&#x27;的所有元素，返回一个列表</span><br></code></pre></td></tr></table></figure><h1>第三章 网站数据爬取路径</h1><h2 id="3-1-网站树的爬取路径">3.1 网站树的爬取路径</h2><p><img src="/img/post/16708253808428.png" alt="网站树图例"></p><ul><li>递归程序实现<ul><li>分治、直接间接调用自身</li></ul></li><li>深度优先遍历（DFS）<ul><li>后进先出，栈，list</li></ul></li><li>广度优先遍历（BFS）<ul><li>先进先出，队列，list</li></ul></li></ul><p>递归分治：一棵树的遍历划分为根结点和它子树们的遍历</p><h2 id="3-2-网站图的爬取路径">3.2 网站图的爬取路径</h2><p>如果每个网页都能回到主界面，那么网站的关系就是一个有回路的图<br><img src="/img/post/16708261053331.png" alt=""></p><h2 id="3-3-python-的前后台线程">3.3 python 的前后台线程</h2><ul><li><code>setDaemon(True)</code>：设置<strong>后台</strong>线程，<strong>守护</strong>线程<ul><li>主线程退出时后台线程随机退出，优先级较低，用于为其他线程提供服务</li><li>线程的等待：<strong>线程对象.join()</strong>，该线程完成后才能继续往下运行</li><li>多线程与资源：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">lock = threading.RLock()<br>lock.acquire()  <span class="hljs-comment"># 获取锁</span><br>......<br>lock.release()  <span class="hljs-comment"># 释放锁</span><br></code></pre></td></tr></table></figure></li></ul></li><li><code>setDaemon(False)(默认情况)</code>：<strong>非守护</strong>线程，也称为<strong>前台</strong>线程<ul><li>主线程退出时，若前台线程还未结束，则等待所有前台线程结束，<strong>相当于在程序末尾加入 join()</strong></li><li>多线程与资源（前后台线程）</li></ul></li></ul><h1>第四章 Scrapy 框架爬虫程序</h1><h2 id="4-1-Scrapy-爬虫框架介绍">4.1 Scrapy 爬虫框架介绍</h2><h3 id="4-1-1-Scrapy-爬虫框架结构">4.1.1 Scrapy 爬虫框架结构</h3><p>5+2 结构，分布式，3 条数据流路径</p><p><img src="/img/post/16708279160639.png" alt=""></p><table><thead><tr><th>模块</th><th>功能</th></tr></thead><tbody><tr><td>Engine</td><td>控制各模块数据流，不间断从 Scheduler 处获得爬取请求，直至请求为空</td></tr><tr><td>Spider</td><td><strong>框架入口</strong>（初始爬取请求）。解析 Downloader 返回的响应（Response），产生爬取项（scraped item），产生额外的爬取请求（Request）</td></tr><tr><td>Item Pipelines</td><td><strong>框架出口</strong>（爬取结果及处理）以流水线方式处理 Spider 产生的爬取项</td></tr><tr><td>Scheduler</td><td>对所有爬取请求进行调度管理</td></tr><tr><td>Spider Middleware</td><td>对请求和爬取项的再处理（修改、丢弃、新增请求或爬取项）</td></tr><tr><td>Downloader</td><td>根据请求下载网页</td></tr><tr><td>Downloader Middleware</td><td>实施 Engine、Scheduler 和 Downloader 之间进行用户可配置的控制（修改、丢弃、新增请求或响应）</td></tr></tbody></table><h3 id="4-1-2-Scrapy-命令行的使用">4.1.2 Scrapy 命令行的使用</h3><p><code>&gt;scrapy &lt;command&gt; [options] [args]</code></p><table><thead><tr><th>命令</th><th>说明</th><th>格式</th></tr></thead><tbody><tr><td>startproject</td><td>创建一个新工程</td><td><code>scrapy startproject &lt;name&gt; [dir]</code></td></tr><tr><td>genspider</td><td>创建一个爬虫</td><td><code>scrapy genspider [options] &lt;name&gt; &lt;domain&gt;</code></td></tr><tr><td>settings</td><td>获得爬虫配置信息</td><td><code>scrapy settings [options]       </code></td></tr><tr><td>crawl</td><td>运行一个爬虫</td><td><code>scrapy crawl &lt;spider&gt;  </code></td></tr><tr><td>list</td><td>列出工程中所有爬虫</td><td><code>scrapy list </code></td></tr><tr><td>shell</td><td>启动 URL 调试命令行</td><td><code>scrapy shell [url]  </code></td></tr></tbody></table><h3 id="4-1-3-scrapy-与-request-对比">4.1.3 scrapy 与 request 对比</h3><table><thead><tr><th></th><th>request</th><th>Scrapy</th></tr></thead><tbody><tr><td>相同点</td><td>1.实现 python 爬虫重要技术路线 2.可用性都好，文档丰富，入门简单</td><td>3.两者都没有处理 js、提交表单、应对验证码等功能（可扩展）</td></tr><tr><td>不同点</td><td>页面级爬虫</td><td>网站级爬虫</td></tr><tr><td></td><td>功能库</td><td>框架</td></tr><tr><td></td><td>并发性考虑不足，性能较差</td><td>并发性好，性能较高</td></tr><tr><td></td><td>重点在于页面下载</td><td>重点在于爬虫结构</td></tr><tr><td></td><td>定制灵活</td><td>一般定制灵活，深度定制困难</td></tr><tr><td></td><td>上手十分简单</td><td>入门稍难</td></tr></tbody></table><h3 id="4-1-4-yield-关键字和生成器">4.1.4 yield 关键字和生成器</h3><p><img src="/img/post/16708302875333.png" alt=""><br>生成器相比一次列出所有内容的<strong>优势</strong>：</p><ul><li>更节省存储空间</li><li>响应更迅速</li><li>使用更灵活</li></ul><h3 id="4-1-5-Scrapy-爬虫的数据类型">4.1.5 Scrapy 爬虫的数据类型</h3><h4 id="4-1-5-1-Request-类">4.1.5.1 Request 类</h4><p><strong>Request 对象</strong>表示一个<strong>HTTP 请求</strong>，由 Spider 生成，由 Downloader 执行</p><table><thead><tr><th>属性或方法</th><th>说明</th></tr></thead><tbody><tr><td>.url</td><td>Request 对应的请求 URL 地址</td></tr><tr><td>.method</td><td>对应的请求方法，<code>GET</code> <code>POST</code>等</td></tr><tr><td>.headers</td><td>字典类型风格的请求头</td></tr><tr><td>.body</td><td>请求内容主体，字符串类型</td></tr><tr><td>.meta</td><td>用户添加的扩展信息，在 Scrapy 内部模块间传递信息使用</td></tr><tr><td>.copy()</td><td>复制该请求</td></tr></tbody></table><h4 id="4-1-5-2-Response-类">4.1.5.2 Response 类</h4><p><strong>Response 对象</strong>表示一个<strong>HTTP 响应</strong>，由 Downloader 生成，由 Spider 处理</p><table><thead><tr><th>属性或方法</th><th>说明</th></tr></thead><tbody><tr><td>.url</td><td>Response 对应的 URL 地址</td></tr><tr><td>.status</td><td>HTTP 状态码，默认是 200</td></tr><tr><td>.headers</td><td>Response 对应的头部信息</td></tr><tr><td>.body</td><td>Response 对应的内容信息，字符串类型</td></tr><tr><td>.flags</td><td>一组标记</td></tr><tr><td>.request</td><td>产生 Response 类型对应的 Request 对象</td></tr><tr><td>.copy()</td><td>复制该响应</td></tr></tbody></table><h4 id="4-1-5-3-Item-类">4.1.5.3 Item 类</h4><p><strong>Item 对象</strong>表示一个<strong>从 HTML 页面中提取的信息内容</strong>，由 Spider 生成，由 Item Pipeline 处理 Item，类似字典类型，可以按照字典类型操作</p><h2 id="4-2-Scrapy-中查找-HTML-元素-Xpath">4.2 Scrapy 中查找 HTML 元素 Xpath</h2><p>路径表达式+索引+属性</p><blockquote><p>xpath 的索引值从 1 开始</p></blockquote><h3 id="4-2-1-Xpath-常用表达式">4.2.1 Xpath 常用表达式</h3><table><thead><tr><th>表达式</th><th>描述</th><th>例子</th></tr></thead><tbody><tr><td>nodename</td><td>选取此节点</td><td><code>body</code>，选取 body 元素</td></tr><tr><td>/</td><td>绝对路径，表示当前节点的下一级节点元素</td><td><code>/body</code>，当前节点下一级的 body 元素，默认当前节点选取根元素</td></tr><tr><td>//</td><td>相对路径，全文档查找</td><td><code>//title</code>，全文档搜索 title 元素；<code>body//title</code>，在 body 元素后代中搜索所有 title 元素</td></tr><tr><td>.</td><td>当前节点</td><td><code>.//title</code>，在当前节点后代中搜索所有 title 元素</td></tr><tr><td>@</td><td>选取属性</td><td><code>//node[@attribute]</code>，包含 attribute 属性的节点 node</td></tr><tr><td>*</td><td>通配符</td><td><code>/*</code>，绝对路径匹配任意节点；<code>//*</code>，全文匹配任意节点；<code>@*</code>，匹配任意属性</td></tr></tbody></table><h2 id="4-3-Scrapy-爬取和存储数据">4.3 Scrapy 爬取和存储数据</h2><p><strong>总结：</strong></p><ul><li>scrapy 把<strong>数据爬取</strong>与<strong>数据存储</strong>分开处理，他们都是异步执行的，<strong>mySpider</strong>每爬取一个<strong>数据项目 item</strong>，就<strong>yield</strong>推送给<strong><a href="http://pipelines.py">pipelines.py</a> 程序存储</strong>；</li><li>等待存储完毕后又再次爬取 item 再次推送再次存储</li><li>以上过程一直进行直到爬取过程结束</li></ul><h1>第五章 爬取网站商品数据</h1><p>Selenium 脚本执行时后端六条实现的流程：</p><ul><li>对于每一条 Selenium 脚本，一个<strong>http 请求</strong>会被<strong>创建</strong>并且发送给浏览器的驱动</li><li>浏览器驱动中包含了一个 HTTP Server，用来<strong>接收</strong>这些<strong>http 请求</strong></li><li>HTTP Server 接收到请求后根据请求来<strong>具体操控</strong>对应的<strong>浏览器</strong></li><li><strong>浏览器执行</strong>具体的<strong>测试</strong>步骤</li><li>浏览器将步骤执行<strong>结果返回</strong>给 HTTP Server</li><li>HTTP Server 又将<strong>结果返回</strong>给 Selenium 的脚本，如果是错误的 http 代码我们就会在控制台看到对应的报错信息</li></ul><h2 id="5-1-Selenium-编写爬虫程序">5.1 Selenium 编写爬虫程序</h2><ul><li>程序先从 selenium 引入 webdriver，引入 chrome 程序的选择项目 Options：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.chrome.options <span class="hljs-keyword">import</span> Options<br></code></pre></td></tr></table></figure></li><li>设置启动 chrome 时不可见<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">chrome_options.add_argument(<span class="hljs-string">&#x27;-headless&#x27;</span>)<br>chrome_options.add_argument(<span class="hljs-string">&#x27;-disable-gpu&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li>创建 chrome 浏览器<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver = webdriver.Chrome(chrome_options=chrome_options)<br></code></pre></td></tr></table></figure><ul><li>这样创建的 chrome 浏览器是不可见的，仅仅使用：<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver = webdriver.Chrome()<br></code></pre></td></tr></table></figure></li><li>创建 chrome 浏览器，那么在程序执行时会弹出一个 chrome 浏览器</li></ul></li><li>使用 driver.get(url)方法访问网页<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.get(<span class="hljs-string">&quot;http://127.0.0.1:5000&quot;</span>)<br></code></pre></td></tr></table></figure></li><li>通过 driver.page_source 获取网页 HTML 代码（渲染后的数据页面）<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">html = driver.page_source<br></code></pre></td></tr></table></figure></li><li>driver.get_cookies()：获得页面的 cookies</li><li>driver.current_url：查看请求的 URL</li></ul><h2 id="5-2-Selenium-爬取-Ajax-网页数据">5.2 Selenium 爬取 Ajax 网页数据</h2><blockquote><p>Ajax 网页数据：后台与服务器进行少量数据交换，异步更新部分网页</p><p>模拟浏览器对下拉选项的点击选择，获得动态交互加载出更新后的网页数据</p></blockquote><h2 id="5-3-Selenium-等待-HTML-元素">5.3 Selenium 等待 HTML 元素</h2><blockquote><p><strong>为什么要等待 html 元素？</strong><br>HTML 元素还没加载完毕，无法获得该元素的控制和访问</p></blockquote><ul><li><strong>强制等待 1.5 秒</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">time.sleep(<span class="hljs-number">1.5</span>)<br></code></pre></td></tr></table></figure></li><li><strong>隐性等待 1.5 秒，即网页在加载时等待 1.5 秒</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">driver.implicitly_wait(<span class="hljs-number">1.5</span>)<br></code></pre></td></tr></table></figure></li><li><strong>循环等待</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">waitTime = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> waitTime &lt; <span class="hljs-number">10</span>:<br>    marks = driver.find_element(By.XPATH, <span class="hljs-string">&#x27;//select/option&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(marks) &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">break</span><br>    time.sleep(<span class="hljs-number">0.5</span>)<br>    waitTime += <span class="hljs-number">0.5</span><br>    <span class="hljs-keyword">if</span> waitTime &gt;= <span class="hljs-number">10</span>:<br>        <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">&quot;Waiting time out&quot;</span>)<br></code></pre></td></tr></table></figure></li><li><strong>显式等待</strong><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">locator = (By.XPATH, <span class="hljs-string">&quot;//select/option&quot;</span>)<br>WebDriverWait(driver, <span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>).until(EC.presence_of_element_located(locator))<br><span class="hljs-comment"># 等待判断准确，不会浪费多余的等待时间，在实际使用中可以提高执行效率</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="5-3-1-等待方法">5.3.1 等待方法</h3><ul><li><p><strong>EC.presence_of_element_located(locator)</strong></p><ul><li>等待 locator 指定的元素出现，也就是 HTML 文档中建立起了这个元素</li></ul></li><li><p><strong>EC.visibility_of_element_located(locator)</strong></p><ul><li>等待 locator 指定的元素可见</li></ul></li><li><p><strong>EC.element_to_be_clickable(locator)</strong></p><ul><li>等待 locator 指定的元素可以被点击</li></ul></li><li><p><strong>EC.element_to_be_selected(locator)</strong></p><ul><li>等待 locator 指定的元素可以被选择</li><li>可以被选择的元素一般是<code>&lt;select&gt;</code>中的选项<code>&lt;option&gt;</code>、输入的多选框<code>&lt;input type=&quot;checkbox&quot;&gt;</code>、输入的单选框<code>&lt;input type=&quot;radio&quot;&gt;</code></li></ul></li><li><p><strong>EC.text_to_be_present_in_element(locator, text)</strong></p><ul><li>等待 locator 指定的元素的文本中包含指定的 text 文本</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">locator = (By.ID, <span class="hljs-string">&quot;msg&quot;</span>)<br>WebDriverWait(driver, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>,<span class="hljs-number">5</span>).until(EC.text_to_be_present_in_element(locator, <span class="hljs-string">&quot;品&quot;</span>))<br><br><span class="hljs-comment"># 等待&lt;span id=&quot;msg&quot;&gt;...&lt;/span&gt;元素中的文本包含“品”，</span><br><span class="hljs-comment"># 由于在&lt;option&gt;出现后设置文本时“品牌”，因此爬虫程序可以爬取到手机品牌数据</span><br></code></pre></td></tr></table></figure></li></ul><h1>第七章 读取文档</h1><h2 id="7-1-文档编码">7.1 文档编码</h2><pre><code class=" mermaid">graph TBm(纯文本信息)--&gt;html(HTML展示)w(纯文本文件)--&gt;htmlt(图像文件)--&gt;htmls(视频文件)--&gt;html</code></pre><ul><li><strong>共同点</strong>：所有信息和文档都是由 0 和 1 编码而成</li><li><strong>不同点</strong>：面向用户的转换方式不同</li></ul><p>完整代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><br>headers = &#123;<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows; U; Windows NT 6.0 x64; en-US; rv:1.9pre) Gecko/2008072421 Minefield/3.0.2pre&quot;</span><br>    &#125;<br><br>req = urllib.request.Request(<span class="hljs-string">&quot;http://www.pythonscraping.com/pages/warandpeace/chapter1-ru.txt&quot;</span>, headers=headers)<br>resp = urllib.request.urlopen(req, timeout=<span class="hljs-number">10</span>)<br>html = resp.read()<br><br>rutxt = html.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><span class="hljs-built_in">print</span>(rutxt)<br></code></pre></td></tr></table></figure><p>检索该文本文档的编码方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> chardet<br><span class="hljs-built_in">type</span> = chardet.detect(html)<br>rutxt = html.decode(<span class="hljs-built_in">type</span>[<span class="hljs-string">&quot;encoding&quot;</span>])<br></code></pre></td></tr></table></figure><blockquote><p>网页中有注明编码方式，查询<code>&lt;meta&gt;</code>标签<br><code>&lt;meta charset=&quot;utf-8&quot;&gt;</code></p></blockquote><h2 id="7-2-不同格式文档的读取和存储">7.2 不同格式文档的读取和存储</h2><table><thead><tr><th></th><th>CSV</th><th>PDF</th><th>DOCX</th></tr></thead><tbody><tr><td>格式特点</td><td>以纯文本形式存储表格数据（数字和文本）</td><td>以 PostScript 语言图像模型为基础，是跨平台（应用程序、操作系统、硬件无关）支持多媒体集成文件</td><td>类 XML 格式标准</td></tr><tr><td>读取</td><td>csv.Reader()、csv.DictReader()方法，和引用 io 里面的 StringIO()</td><td>安装 pdfminer3k</td><td>from zipfile import ZipFile、from io import BytesIO、from bs4 import BeautitulSoup</td></tr><tr><td>存储</td><td>csv.writer()</td><td></td><td>不关注内容的转存，f.write(data)</td></tr></tbody></table><h2 id="7-3-PDF-读取和存储">7.3 PDF 读取和存储</h2><p>思路：PDF 读成字符串，然后用 StingIO 转换成文件对象</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 获取文档对象</span><br>fp = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;selenium_documentation_o.pdf&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br><br><span class="hljs-comment"># 创建一个与文档关联的解释器</span><br>parser = PDFParser(fp)<br><br><span class="hljs-comment"># PDF文档的对象</span><br>doc = PDFDocument()<br><br><span class="hljs-comment"># 链接解释器和文档对象</span><br>parser.set_document(doc)<br>doc.set_parser(parser)<br><br><span class="hljs-comment"># 初始化文档</span><br>doc.initialize(<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/img/post/16708474294608.png" alt=""></p><h3 id="7-3-1-读取-pdf">7.3.1 读取 pdf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> StringIO<br><span class="hljs-keyword">from</span> pdfminer.pdfinterp <span class="hljs-keyword">import</span> PDFResourceManager, process_pdf<br><span class="hljs-keyword">from</span> pdfminer.converter <span class="hljs-keyword">import</span> TextConverter<br><span class="hljs-keyword">from</span> pdfminer.layout <span class="hljs-keyword">import</span> LAParams<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> <span class="hljs-built_in">open</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">readPDF</span>(<span class="hljs-params">pdfFile</span>):<br>    rsrcmgr = PDFReasourceManager() <span class="hljs-comment"># 创建PDF资源管理对象</span><br>    retstr = StringIO() <span class="hljs-comment"># StingIO转换成文件对象</span><br>    laparams = LAParams()   <span class="hljs-comment"># 布局参数分析器</span><br>    device = TextConverter(rsrcmgr, retstr, laparams=laparams)  <span class="hljs-comment"># 创建设备对象</span><br>    process_pdf(rsrcmgr, device, pdfFile)   <span class="hljs-comment"># PDF页面解释器，等同于PDFPage.get_pages</span><br><br>    device.close()<br><br>    content = retstr.getvalue()<br>    retstr.close()<br>    <span class="hljs-keyword">return</span> content<br></code></pre></td></tr></table></figure><h4 id="7-3-1-1-下载服务器-pdf-文件">7.3.1.1 下载服务器 pdf 文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">req = urllib.request.Request(<span class="hljs-string">&quot;http://pythonscraping.com/pages/warandpeace/chapter1.pdf&quot;</span>,headers=headers)<br>pdfFile = urllib.request.urlopen(req, timeout=<span class="hljs-number">10</span>)<br><br>outputString = readPDF(pdfFile)<br><span class="hljs-built_in">print</span>(outputString)<br>pdfFile.close()<br></code></pre></td></tr></table></figure><h4 id="7-3-1-2-打开本地-PDF-文件">7.3.1.2 打开本地 PDF 文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">pdfFile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;F:\First Home work.pdf&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>)<br><br>outputString = readPDF(pdfFile)<br><span class="hljs-built_in">print</span>(outputString)<br>pdfFile.close()<br></code></pre></td></tr></table></figure><h3 id="7-3-2-PDF-文件的存储">7.3.2 PDF 文件的存储</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">req = urllib.request.Request(<span class="hljs-string">&quot;http://pythonscraping.com/pages/warandpeace/chapter1.pdf&quot;</span>, headers=headers)<br>pdfFile = urllib.request.urlopen(req, timeout=<span class="hljs-number">10</span>)<br><br>data = pdfFile.read()<br><span class="hljs-comment"># 存储PDF文件</span><br>pdfStoreFile = <span class="hljs-string">&quot;F:\warandpeace_chapter1.pdf&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(pdfStoreFile, <span class="hljs-string">&#x27;wb+&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(data)<br></code></pre></td></tr></table></figure><h3 id="7-3-3-网页信息转存为-pdf">7.3.3 网页信息转存为 pdf</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fpdf <span class="hljs-keyword">import</span> FPDF<br><span class="hljs-keyword">from</span> fpdf <span class="hljs-keyword">import</span> HTMLMixin<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML2PDF</span>(FPDF,HTMLMixin):<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">html2pdf</span>():<br>    html = <span class="hljs-string">&#x27;&#x27;&#x27;&lt;h1 align =&quot;center&quot;&gt;PyFPDF HTML Demo&lt;/h1&gt;</span><br><span class="hljs-string">    &lt;p&gt;This is regular text&lt;/p&gt;</span><br><span class="hljs-string">    &lt;p&gt;You can also &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italicize&lt;/i&gt; or &lt;u&gt;underline&lt;/u&gt;&lt;/p&gt;</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    pdf = HTML2PDF()<br>    pdf.add_page() <span class="hljs-comment"># 加一页</span><br>    pdf.write_html(html)<br>    pdf.output(<span class="hljs-string">&#x27;html2pdf.pdf&#x27;</span>)<br><br>html2pdf()<br></code></pre></td></tr></table></figure><h2 id="7-4-读取-docx-文件的正文内容">7.4 读取.docx 文件的正文内容</h2><ol><li>从.docx 文件读取 XML</li><li>从 XML 中找到包含在<code>&lt;w:t&gt;</code>标签的正文的信息</li></ol><pre><code class=" mermaid">graph LRy[远程打开docx文件]----&gt;f[封装为二进制文件对象]f----&gt;j[解压]----&gt;d[读取解压文件获得XML信息]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> zipfile <span class="hljs-keyword">import</span> ZipFile<br><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br>wordFile = urlopen(<span class="hljs-string">&quot;http://pythonscraping.com/pages/AWordDocument.docx&quot;</span>).read()<br>wordFile = BytesIO(workFile)<br>xml_content = document.read(<span class="hljs-string">&quot;word/document.xml&quot;</span>) <span class="hljs-comment"># 正文内容隐藏在xml里</span><br><span class="hljs-built_in">print</span>(xml_content.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br><span class="hljs-comment"># &lt;w:t&gt;非标准标签，需要解析器xml解析</span><br>wordObj = BeautifulSoup(xml_content.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>), <span class="hljs-string">&quot;xml&quot;</span>)<br>textString = wordObj.findAll(<span class="hljs-string">&quot;w:t&quot;</span>)    <span class="hljs-comment"># 找到包含在&lt;w:t&gt;标签的正文</span><br><span class="hljs-keyword">for</span> textElem <span class="hljs-keyword">in</span> textString:<br>    style = textElem.parent.parent.find(<span class="hljs-string">&#x27;w:pStyle&#x27;</span>)<br>    <span class="hljs-keyword">if</span> style <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> style[<span class="hljs-string">&#x27;w:val&#x27;</span>]==<span class="hljs-string">&quot;Title&quot;</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Title is :&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(textElem.text)) <span class="hljs-comment"># 按不同要求单独打印标题</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(textElem.txt)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python网络爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>selenium</tag>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
      <tag>正则表达式</tag>
      
      <tag>scrapy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH11 生成模型</title>
    <link href="/2022/12/19/CH11-%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/"/>
    <url>/2022/12/19/CH11-%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1>CH11 生成模型</h1><p>生成模型关注点是样本分布本身，解决的问题与任务，对样本分布建模，所以一定和概率分布有关，往往被称之为“概率生成模型”</p><p>给定训练数据，从相同分布生成新样本</p><blockquote><p>监督学习可以细分为判别模型和生成模型。通俗地讲，比如我有一堆猫狗的图片，我要对他们进行分类，判别的模型只是要找到猫狗的差异就可以，比如说狗的体型要大些，所以看到体型大的我都认为是狗;而生成模型是通过学习猫是什么样的，狗是什么样的，它有能力生成新的一张新的猫或狗的图片，就和小孩画画差不多，如果都有这能力了自然会判别什么是猫，什么是狗（但是天下没有免费的午餐，根据研究和实验，在分类问题上，判别模型一般比生成模型做得好[2]，因为不一定能画得好啊）。</p></blockquote><ul><li><strong>显式密度估计</strong>：明确定义并求解，显式对 P(x,y)建模</li><li><strong>隐式密度估计</strong>：学习可从样本采样而未明确定义的模型（从样本中生成新的样本）</li></ul><p>当今三种最受欢迎的生成模型：</p><ul><li>PixelRNN 与 PixelCNN</li><li>变分自编码（VAE）</li><li>生成对抗网络（GAN）</li></ul>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH10 卷积神经网络</title>
    <link href="/2022/12/18/CH10-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    <url>/2022/12/18/CH10-%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[<h1>CH10 卷积神经网络</h1><h2 id="10-1-卷积神经网络层级结构">10.1 卷积神经网络层级结构</h2><p><strong>左边</strong></p><ul><li>数据输入层，对数据做一些处理，比如去均值（把输入数据各个维度都中心化为 0，避免数据过多偏差，影响训练效果）、归一化（把所有的数据都归一到同样的范围）、PCA/白化等等。</li></ul><p><strong>中间</strong></p><ul><li>CONV：卷积计算层，线性乘积 求和</li><li>RELU：激励层（ReLU 是激活函数的一种）</li><li>POOL：池化层，简言之，即取区域平均或最大</li></ul><p><strong>右边</strong></p><ul><li>FC：全连接层</li></ul><h2 id="10-2-卷积操作">10.2 卷积操作</h2><p>组成成分：</p><ul><li>输入矩阵（Input）</li><li>核矩阵（Kernel），又称滤波器（Filter）</li></ul><p>卷积：卷积核在图片上滑动，计算点积<br>（28 = 32 - 5 + 1）</p><p><code>3</code>:一般 channel 的维度和 image 保持一致<br><img src="/img/post/16715481429767.jpg" alt=""><br><img src="/img/post/16715494695720.jpg" alt=""></p><h3 id="10-2-1-卷积操作-多通道">10.2.1 卷积操作-多通道</h3><p>输入矩阵，核矩阵可以由多个相同的矩阵叠加在一起</p><p>比如图像通常有 3 个通道（Channel），分别代表红黄蓝</p><p>如果输入通道数为 c1，输出通道数为 c2，则共需要 c1*c2 个核矩阵</p><p><img src="/img/post/16715504180869.jpg" alt=""></p><h3 id="10-2-1-数值计算练习">10.2.1 数值计算练习</h3><p><code>4</code>:左上角的九宫格与 filter 做内积<br>4 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>∗</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mn>0</mn><mo>+</mo><mn>2</mn><mo>∗</mo><mo>−</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mo>−</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mn>3</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mn>0</mn><mo>+</mo><mn>3</mn><mo>∗</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo>∗</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">3* 1+1 * 0+2*-1+1 * 1+1 * -1+1 * 3+1 * 0+3 * 1+1 * -1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span><br>其他类似，最后结果 2*2</p><p><img src="/img/post/16715482754278.jpg" alt=""><br><strong>输出大小公式：</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo>−</mo><mi>F</mi><mo>+</mo><mn>2</mn><mi>P</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">(N-F+2P)/stride + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p><ul><li>N：image 宽度</li><li>F：filter 宽度</li><li>P：padding，填充，在输入特征图的每一边添加一定数目的行列，使得输出的特征图的长、宽 = 输入的特征图的长、宽<ul><li>目的：希望每个输入方块都能作为卷积窗口的中心</li></ul></li><li>stride：步幅，卷积核经过输入特征图的采样间隔<ul><li>目的：希望减小输入参数的数目，减少计算量</li><li>作用：成倍缩小尺寸，比如步幅为 2，输出就是输入的 1/2（不严谨的 1/2）</li></ul></li></ul><blockquote><p>stride = 1,padding = 0（遍历采样，无填充：padding = ‘valid’）<br>stride = 1,padding = 1（遍历采样，有填充：padding = ‘same’）</p></blockquote><p><strong>例 1:</strong><br>纯代公式了<br><img src="/img/post/16715495787646.jpg" alt=""></p><p><strong>例 2:</strong><br>bias：偏置单元，对应的权重都为 1</p><p><img src="/img/post/16715496968611.jpg" alt=""></p><h2 id="10-3-池化层">10.3 池化层</h2><p>降低特征维度，易于计算</p><p>常见的池化：最大池化，平均池化</p><p><img src="/img/post/16715504845649.jpg" alt=""><br><strong>最大池化：</strong></p><ul><li>可以获取局部信息，更好的保留纹理上的特征</li><li>如果不用观察物体在图片中的具体位置，只关心其是否出现，则使用最大池化效果比较好</li></ul><p><strong>平均池化：</strong></p><ul><li>保留整体数据的特征，更适用于突出背景信息时使用</li><li>丢掉了一部分不重要的信息，而保留更重要、更有利于特定任务的信息</li><li>降维、减少计算复杂度</li></ul><p><strong>与卷积的关系：</strong></p><ul><li>池化操作也可以多通道，定义步幅、填补等参数</li><li>池化操作直接在单个矩阵上进行操作，而卷积需要核矩阵在输入矩阵上操作</li></ul>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>卷积神经网络</tag>
      
      <tag>神经网络</tag>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH9 神经网络</title>
    <link href="/2022/12/18/CH9-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    <url>/2022/12/18/CH9-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[<h1>CH9 神经网络</h1><h2 id="9-1-引子">9.1 引子</h2><p>神经元模型，是一个包含输入，输出与计算功能的模型。</p><p>下图包含 3 个输入，1 个输出，以及两个计算功能（求和、非线性函数）</p><p>注意中间的箭头线，这些线称为“连接”，每个箭头线上有一个“权值”<br><img src="/img/post/16714624264565.png" alt=""></p><p><strong>一个神经网络的训练算法就是让权重的值调整到最佳，使得整个网络的预测效果最好</strong></p><p>在神经元模型中，每个有向箭头表示的是值的加权传递<br><img src="/img/post/16714628640889.png" alt=""></p><p>将神经元图中的所有变量用符号表示，并写出输出的计算公式，如下图：<br><img src="/img/post/16714629376133.png" alt=""><br>可见 z 是在<strong>输入和权值的线性加权和叠加了一个函数 g 的值</strong>。在 MP 模型中，函数 g 是 sgn 函数，也就是取符号函数，这个函数当输入大于 0 时，输出 1，否则输出 0。</p><p>一个神经元可以引出多个代表输出的有向箭头，但值都是一样的。</p><p>神经元可以看作<strong>一个计算与存储单元</strong>，计算是神经元对其的输入进行计算功能，存储是神经元会暂存计算结果，并传递到下一层。</p><p><strong>理解：</strong></p><ul><li>一个数据，称之为样本，样本有四个属性，其中三个属性已知，一个属性未知，我们需要做的就是通过三个已知属性预测未知属性</li><li>具体方法就是使用神经元的公式进行计算，三个已知属性的值是 a1，a2，a3，未知属性的值是 z，z 可以通过公式计算出来</li><li>在这里，已知的属性称为<strong>特征</strong>，未知的属性称为<strong>目标</strong>。假设特征与目标之间确实是线性关系，并且我们已经得到表示这个关系的权值 w1，w2，w3，那么我们就可以通过神经元模型预测新样本的目标。</li></ul><h2 id="9-2-单层神经网络（感知器）">9.2 单层神经网络（感知器）</h2><p><strong>只能做简单的线性分类任务</strong></p><p>两个层次：</p><ul><li><strong>输入层：</strong> 输入单元只负责传输数据，不做计算</li><li><strong>输出层：</strong> 输出单元需要对前一层的输入进行计算</li></ul><p>带有两个输入单元的单层神经网络</p><p><img src="/img/post/16714653307526.png" alt=""></p><blockquote><p>用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{x,y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>来表达一个权值，下标中的 x 代表后一层神经元序号，y 代表前一层神经元序号（序号顺序从上到下）</p><p>如果我们仔细看输出的计算公式，会发现这两个公式就是线性代数方程组，因此可以用矩阵乘法来表达这两个公式</p></blockquote><p>输入的变量是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>3</mn></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[a_1,a_2,a_3]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>，用向量<strong>a</strong>表示，方程的左边是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>z</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>z</mi><mn>2</mn></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[z_1,z_2]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>，用向量<strong>z</strong>表示，系数则是矩阵<strong>W</strong>（2 行 3 列）。</p><p>于是，输出公式可写成 g(<strong>W</strong> * <strong>a</strong>) = <strong>z</strong></p><h3 id="9-2-1-感知器效果">9.2.1 感知器效果</h3><p>与神经元模型不同，感知器中的权值是通过训练得到的。感知器类似一个逻辑回归模型，可以做线性分类任务。</p><p>可以用<strong>决策分界</strong>来形象的表达分类的效果。决策分界就是在二维的数据平面中划出一条直线，当数据的维度是 3 维的时候，划出一个平面；当数据的维度是 n 维时，就是划出一个 n-1 维的超平面</p><p>下图显示了在二维平面中划出决策分界的效果，也就是感知器的分类效果<br><img src="/img/post/16714660086639.png" alt=""></p><h2 id="9-3-两层神经网络（多层感知器）">9.3 两层神经网络（多层感知器）</h2><p>包含输入层，输出层，对比单层神经网络还<strong>增加了一个中间层</strong>，此时，中间层和输出层都是计算层。</p><p>扩展上节的单层神经网络，在右边新加了一个层次（只含一个节点）。</p><p>现在权值矩阵增加到了两个，我们用上标来区分不同层次之间的变量。</p><p>例如<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_x^{(y)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1614em;vertical-align:-0.1166em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.5834em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1166em;"><span></span></span></span></span></span></span></span></span></span>表示第 y 层的第 x 个节点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">z_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">z_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 变成了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_1^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_2^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>，下图给出了中间层计算<br><img src="/img/post/16715099464146.png" alt=""></p><p>计算最终输出的 z 时利用了中间层的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_1^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">a_2^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111em;vertical-align:-0.2663em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span></span>和第二个权值矩阵计算得到，下图为输出层计算<br><img src="/img/post/16715100314036.png" alt=""></p><p>假设我们的预测目标是一个向量，那么与前面类似，只需要在“输出层”增加节点即可。</p><p>我们使用向量和矩阵来表示层次中的变量。a(1)，a(2)，z 是网络中传输的向量数据。W(1)和 W(2)是网络的矩阵参数。如下图。<br><img src="/img/post/16715100988137.png" alt=""></p><p>使用矩阵运算来表达整个计算公式如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>⋅</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">g(W^{(1)}\cdot a^{(1)}) = a^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>⋅</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">g(W^{(2)}\cdot a^{(2)}) = z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span></p><p>偏置节点：默认存在，本质上是一个只含有存储功能，且存储值永远为 1 的单元。在神经网络的每个层次中，除了输出层以外，都会含有这样一个偏执单元</p><p>前一层没有箭头指向他，一般情况下不会明确画出</p><p><img src="/img/post/16715498988352.png" alt=""></p><p>考虑了偏置节点以后的神经网络矩阵运算如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>⋅</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">g(W^{(1)}\cdot a^{(1)}+b^{(1)}) = a^{(2)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><msup><mi>W</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>⋅</mo><msup><mi>a</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">g(W^{(2)}\cdot a^{(2)}+b^{(2)}) = z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0213em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span></p><h3 id="9-3-1-激活函数">9.3.1 激活函数</h3><p>即函数 g，有以下激活函数我们一般会选择</p><blockquote><p>ReLU 对于大多数问题是一个很好的默认选择</p></blockquote><p><img src="/img/post/16715287738701.jpg" alt=""></p><h3 id="9-3-2-一个神经网络前向计算的例子（三层）">9.3.2 一个神经网络前向计算的例子（三层）</h3><p><img src="/img/post/16715288556136.jpg" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">f = <span class="hljs-keyword">lambda</span> x: <span class="hljs-number">1.0</span>/(<span class="hljs-number">1.0</span> + np.exp(-x))<br>x = np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>)   <span class="hljs-comment"># 随机的输入一个向量（3*1）</span><br>h1 = f(np.dot(W1, x) + b1)  <span class="hljs-comment"># 计算第一层，得到的结果（4*1）</span><br>h2 = f(np/dot(W2, h1) + b2) <span class="hljs-comment"># 计算第二层，得到的结果（4*1）</span><br>out = np.dot(W3, h2) + b3   <span class="hljs-comment"># 输出（1*1）</span><br></code></pre></td></tr></table></figure><ol><li><code>f</code>为一个函数，输入的值为<code>x</code>，输出的值为<code>1.0/(1.0 + np.exp(-x))</code>，其中<code>np.exp()</code>返回 e 的幂次方</li><li>随机输入一个(3 * 1)的向量，其中<code>randn(x,y)</code>表示返回由正态分布的随机数组成的 x*y 的矩阵<br><img src="/img/post/16715335280591.png" alt=""></li><li>计算第一层（这里假设按道理说权值是固定的，但是为了方便我就随机设了）<ol><li>先假设一个 W1 的值，4 个权值，3 个输入，所以设 4*3<br><img src="/img/post/16715337971715.png" alt=""></li><li>计算后得到结果是 4 _ 1 （4 _ 3 · 3 * 1）<br><img src="/img/post/16715339540122.png" alt=""></li></ol></li><li>计算第二层<ol><li>假设一个 W2 的值，4 个权值，给 4 个输入（上一层 4 个），所以设 4*4<br><img src="/img/post/16715340239769.png" alt=""></li><li>计算后得到的结果是 4 _ 1（4 _ 4 · 4 * 1）<br><img src="/img/post/16715341151703.png" alt=""></li></ol></li><li>输出结果<ol><li>假设一个 W3 的值，4 个权值，给一个输出，所以设 1*4<br><img src="/img/post/16715342884995.png" alt=""></li><li>计算后得到的结果是 1 _ 1（1 _ 4 · 4 * 1）<br><img src="/img/post/16715344707426.png" alt=""></li></ol></li></ol><h3 id="9-3-3-两层神经网络的训练">9.3.3 两层神经网络的训练</h3><p>首先给所有参数赋上随机值。我们使用这些随机生成的参数值，来预测训练数据中的样本。样本的预测目标为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">y_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，真实目标为 y，那么定义一个值 loss，计算公式如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>p</mi></msub><mo>−</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">loss = (y_p-y)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong>这个值称为损失，我们的目标就是使对所有训练数据的损失和尽可能小</strong></p><h3 id="9-3-3-1-完整的两层神经网络训练实现">9.3.3.1 完整的两层神经网络训练实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> numpy.random <span class="hljs-keyword">import</span> randn<br></code></pre></td></tr></table></figure><p><strong>网络定义：</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs py">N, D_in, H, D_out = <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span><br>x, y = randn(N, D_in), randn(N, D_out)<br>w1, w2 = randn(D_in, H), randn(H, D_out)<br></code></pre></td></tr></table></figure><p><strong>前向计算</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    h = <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x.dot(w1)))    <span class="hljs-comment"># 激活函数</span><br>    y_pred = h.dot(w2)                  <span class="hljs-comment"># 预测值</span><br>    loss = np.square(y_pred - y).<span class="hljs-built_in">sum</span>()  <span class="hljs-comment"># 损失函数</span><br>    <span class="hljs-built_in">print</span>(t, loss)<br></code></pre></td></tr></table></figure><p>其中<code>np.square()</code>表示求矩阵的平方</p><p><strong>计算解析梯度</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs py">grad_y_pred = <span class="hljs-number">2.0</span> * (y_pred-y)<br>grad_w2 = h.T.dot(grad_y_pred)<br>grad_h = grad_y_pred.dot(w2.T)<br>grad_w1 = x.T.dot(grad_h * h * (<span class="hljs-number">1</span>-h))<br></code></pre></td></tr></table></figure><p><strong>梯度下降</strong></p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs py">w1 -= <span class="hljs-number">1e-4</span> * grad_w1<br>w2 -= <span class="hljs-number">1e-4</span> * grad_w2<br></code></pre></td></tr></table></figure><p>反向修改权重</p><p><strong>最终结果</strong><br>形如：<br><img src="/img/post/16715384173487.png" alt=""><br>可以看到随着次数的增加损失函数的值是在下降的，这也是我们想要的结果</p><h2 id="9-3-反向传播算法">9.3 反向传播算法</h2><p><strong>正向传播求损失，反向传播回传误差</strong>，同时，神经网络每层的每个神经元都可以根据误差信号修正每层的权重。</p><p><strong>如何优化参数，能够让损失函数的值最小</strong></p><p><strong>梯度下降算法</strong></p><blockquote><p>梯度下降算法每次计算参数在当前的梯度，然后让参数向着梯度的反方向前进一段距离，不断重复，直到梯度接近零时截止。一般这个时候，所有参数恰好达到使损失函数达到一个最低值的状态</p></blockquote><p>在神经网络模型中，由于结构复杂，每次计算梯度的代价很大，因此还需要使用<strong>反向传播算法</strong>。</p><blockquote><p>反向传播算法是利用了神经网络的结构进行的计算，不一次计算所有参数的梯度，而是从后往前，首先计算<strong>输出层</strong>的梯度，然后是<strong>第二个参数矩阵</strong>的梯度，接着是<strong>中间层</strong>的梯度，再然后是<strong>第一个参数矩阵</strong>的梯度，最后是<strong>输入层</strong>的梯度。计算结束以后，所要的两个参数矩阵的梯度都有了</p></blockquote><p>如下图，梯度的计算从后往前，一层层反向传播。前缀 E 代表相对导数的意思。<br><img src="/img/post/16715282365658.png" alt=""></p><h3 id="9-3-1-一个简单的例子">9.3.1 一个简单的例子</h3><p>下图反应 f(x,y,z) = (x+y)z<br><img src="/img/post/16715388484001.jpg" alt=""></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>q</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>y</mi><mspace width="1em"/><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q = x+y\quad\frac{\partial q}{\partial x}=1,\frac{\partial q}{\partial y}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo>=</mo><mi>q</mi><mi>z</mi><mspace width="1em"/><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mo>=</mo><mi>z</mi><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">f = qz\quad\frac{\partial f}{\partial q} = z,\frac{\partial f}{\partial z}=q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2519em;vertical-align:-0.8804em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></p><p>想要得到：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo separator="true">,</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial f}{\partial x},\frac{\partial f}{\partial y},\frac{\partial f}{\partial z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>通过链式法则：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mrow></mstyle></mstyle></mstyle></menclose><mspace width="1em"/><mspace width="1em"/><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>q</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{\frac{\partial f}{\partial x} = \frac{\partial f}{\partial q}\frac{\partial q}{\partial x}}\quad\quad\boxed{\frac{\partial f}{\partial y} = \frac{\partial f}{\partial q}\frac{\partial q}{\partial y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9319em;vertical-align:-1.2204em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7114em;"><span style="top:-4.9319em;"><span class="pstrut" style="height:4.9319em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span style="top:-3.7114em;"><span class="pstrut" style="height:4.9319em;"></span><span class="stretchy fbox" style="height:2.9319em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2204em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7114em;"><span style="top:-4.9319em;"><span class="pstrut" style="height:4.9319em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span style="top:-3.7114em;"><span class="pstrut" style="height:4.9319em;"></span><span class="stretchy fbox" style="height:2.9319em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2204em;"><span></span></span></span></span></span></span></span></span></span></p><h3 id="9-3-2-反向传播图例">9.3.2 反向传播图例</h3><p><img src="/img/post/16715393943941.jpg" alt=""><br>L 是 z 的下一层，可以直接对 z 求偏导，x 和 y 则要通过 z</p><p>下行梯度 = 上行梯度 * 局部梯度</p><h3 id="9-3-3-反向传播实例：扁平化代码">9.3.3 反向传播实例：扁平化代码</h3><p>补充：sigmoid 局部梯度</p><p><img src="/img/post/16715411037021.jpg" alt=""></p><p><img src="/img/post/16715408777318.jpg" alt=""><br><img src="/img/post/16715409288975.jpg" alt=""></p><p><img src="/img/post/16715412541718.jpg" alt=""></p><p><img src="/img/post/16715412813947.jpg" alt=""><br>再接下去就类似了</p><h3 id="9-3-4-向量的反向传播">9.3.4 向量的反向传播</h3><p><strong>回顾：向量求导</strong></p><p><img src="/img/post/16715453685654.jpg" alt=""><br>雅可比矩阵：<br><img src="/img/post/16715453933164.png" alt=""><br>由于 z 是向量，所以局部梯度现在是雅可比矩阵，更新下游梯度的时候采用矩阵乘积</p><p><img src="/img/post/16715455237265.jpg" alt=""></p><p>代码：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs py">W = np.random.randn(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>)<br>X = np.random.randn(<span class="hljs-number">10</span>, <span class="hljs-number">3</span>)<br>D = W.dot(X)<br><br>dD = np.random.randn(*D.shape)  <span class="hljs-comment"># 与D同样的shape</span><br>dW = dD.dot(X.T)<br>dX = W.T.dot(dD)<br></code></pre></td></tr></table></figure><h2 id="9-4-神经网络训练">9.4 神经网络训练</h2><p>输入：数据集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{(x^{(i)},y^{(i)})\}^n_{i=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1467em;vertical-align:-0.2587em;"></span><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>，步长<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>，小批量大小 b，迭代次数 T</p><ol><li>初始化网络参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">t\in \{1,2,\cdots,T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mclose">}</span></span></span></span> 1. 从 m 个样本中均匀随机选取 b 个样本 2. <strong>前向传播</strong>逐层计算隐藏层，得到样本输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo stretchy="true">~</mo></mover></mrow><annotation encoding="application/x-tex">\widetilde{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.885em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6906em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span class="svg-align" style="width:calc(100% - 0.1111em);margin-left:0.1111em;top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg xmlns="http://www.w3.org/2000/svg" width='100%' height='0.26em' viewBox='0 0 600 260' preserveAspectRatio='none'><path d='M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span> 3. 根据<strong>损失函数</strong>计算误差，计算输出层梯数 4. 反向逐层计算隐藏层梯度 5. 计算连接参数梯度并更新参数<p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>←</mo><msub><mi>w</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><mfrac><mi>a</mi><mi>b</mi></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>m</mi><mi>b</mi></msub></mrow></munder><msub><mi mathvariant="normal">∂</mi><mi>w</mi></msub><msup><mi>J</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">     w_t \leftarrow w_{t-1}-\frac{a}{b}\sum_{i\in m_b}\partial_wJ^{(i)}(w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4911em;vertical-align:-1.3835em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3835em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span></span></p>输出：训练收敛的神经网络</li></ol><h2 id="9-5-搭建神经网络-例题">9.5 搭建神经网络 例题</h2><p>下图神经网络的学习率（更新步长）l=1，训练样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">}</mo><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">x=\{x_1,x_2\}=\{1,0\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span>，预期分类标号为 1；网络当前的连接权值和神经元偏置如下表，激励函数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>≥</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>&lt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">f(x) =\begin{cases}x, &amp; x\geq 1\\1, &amp; x&lt;1 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mpunct">,</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>；写出该网络采用 BP 算法的一轮训练过程和结果，要求列出如下分段计算公式和结果</p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{1,3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{1,4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>2</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{2,3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>2</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{2,4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>3</mn><mo separator="true">,</mo><mn>5</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{3,5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{4,5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\theta_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">\theta_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">\theta_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td>0</td><td>2</td><td>2</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr></tbody></table><pre><code class=" mermaid">graph LRa((`))--`x1`--&gt;b((1))--`w1,3`--&gt;c((3))--`w3,5`--&gt;d((5))e((`))--`x2`--&gt;f((2))--`w2,4`--&gt;g((4))--`w4,5`--&gt;db--`w1,4`--&gt;gf--`w2,3`--&gt;c</code></pre><p><strong>(1)节点 j 的输入 Sj 和输出 Oj，j=3,4,5</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>3</mn></msub><mo>=</mo><msub><mi>W</mi><mn>13</mn></msub><mo>⋅</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mrow><mn>2</mn><mo separator="true">,</mo><mn>3</mn></mrow></msub><mo>⋅</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>3</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S_3 = W_{13}\cdot x_1+W_{2,3}\cdot x_2 +\theta_3=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>4</mn></msub><mo>=</mo><msub><mi>W</mi><mrow><mn>1</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>⋅</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mrow><mn>2</mn><mo separator="true">,</mo><mn>4</mn></mrow></msub><mo>⋅</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>4</mn></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">S_4 = W_{1,4}\cdot x_1+W_{2,4}\cdot x_2 + \theta_4 = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>3</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">O_3 = f(S_3)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>4</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mn>4</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">O_4 = f(S_4) = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>5</mn></msub><mo>=</mo><msub><mi>W</mi><mrow><mn>3</mn><mo separator="true">,</mo><mn>5</mn></mrow></msub><mo>⋅</mo><msub><mi>O</mi><mn>3</mn></msub><mo>+</mo><msub><mi>W</mi><mrow><mn>4</mn><mo separator="true">,</mo><mn>5</mn></mrow></msub><mo>⋅</mo><msub><mi>O</mi><mn>4</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>5</mn></msub><mo>=</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>0</mn><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">S_5 = W_{3,5}\cdot O_3+W_{4,5}\cdot O_4 + \theta_5 = 1+2+0=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mpunct mtight">,</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mn>5</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mn>5</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">O_5 = f(S_5) = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></p><p><strong>(2)反向传播误差 Ej,j=3,4,5</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">E_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h2 id="9-5-总结">9.5 总结</h2><p><strong>（全连接）神经网络</strong>是一系列线性函数和非线性激活函数的堆叠，它们比起线性分类器有更加强大的表示能力</p><p><strong>反向传播</strong> = 沿着计算图递归应用<strong>链式法则</strong>来计算所有输入/参数/中间值的梯度</p><p><strong>前向计算</strong>：计算运算结果，并将梯度计算所需的任何中间值保存在内存中</p><p><strong>反向传播</strong>：应用链式法则来计算损失函数相对于输入的梯度</p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>神经网络</tag>
      
      <tag>机器学习</tag>
      
      <tag>神经网络训练</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH8 核学习</title>
    <link href="/2022/12/16/CH8-%E6%A0%B8%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/12/16/CH8-%E6%A0%B8%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>CH8 核学习</h1><h2 id="8-1-SVM">8.1 SVM</h2><p>支持向量机（support vector machines, SVM）是一种二分类模型，它将实例的特征向量映射为空间中的一些点，SVM 的目的就是想要画出一条线，以“最好地”区分这两类点。如果以后有了新的点，这条线也能做出很好的分类。<strong>SVM 适合中小型数据样本、非线性、高维的分类问题</strong>。</p><h3 id="8-1-1-SVM-基本概念">8.1.1 SVM 基本概念</h3><p>将实例的特征向量（以二维为例）映射为空间中的一些点，如下图的实心点和空心点，它们属于不同的两类。SVM 目的就是想要<u>画出一条线</u>，以“最好的”区分这两类点。</p><p><img src="/img/post/16714304015828.png" alt=""></p><p><strong>Q1:画线的标准是什么？</strong><br>线是有无数条可以画的，区别就在于效果好不好。SVM 将会寻找可以区分两个类别并且能使间隔（margin）最大的划分超平面。</p><blockquote><p>超平面：样本的特征很可能是高维的，此时样本空间的划分就不是一条线了</p><p><strong>Q2:间隔（margin）是什么？</strong><br>对于任意一个超平面，其两侧数据点都距离它有一个最小距离。如下图，虚线是由距离中央实线最近的两个点所确定出来的（也就是由<strong>支持向量</strong>决定），但此时 margin 比较小，如果用第二种方式，margin 明显变大也更接近我们的目标。</p></blockquote><p><img src="/img/post/16714307701638.png" alt=""></p><p><strong>Q3:支持向量是什么？</strong><br>从上图可以看出，虚线上的点到划分超平面的距离都是一样的，实际上只有这几个点共同确定了超平面的位置，因此被称作“支持向量”，“支持向量机”也是由此来的。</p><h3 id="8-1-2-SVM-可扩展到多分类问题">8.1.2 SVM 可扩展到多分类问题</h3><p>对于每个类，有一个当前类和其他类的二类分类器</p><p>将多分类问题转化为 n 个二分类问题，n 就是类别个数</p><h3 id="8-1-3-SVM-算法特性">8.1.3 SVM 算法特性</h3><ul><li>训练好的模型的算法复杂度是由<strong>支持向量的个数决定</strong>的，而不是由数据的维度决定的，所以 SVM 不太容易产生 overfitting</li><li>SVM 训练出来的模型<strong>完全依赖于支持向量</strong>，即使训练集里面的所有非支持向量的点都被去除，重复训练过程，结果仍然会得到完全一样的模型</li><li>一个 SVM 如果训练得出的支持向量个数比较少，那么 SVM 训练出的模型比较容易被泛化</li></ul><h2 id="8-2-核方法">8.2 核方法</h2><p>核方法主要思想：<br>在低维空间中不能线性分割的点集，通过转化为高维空间中的点集，很有可能变为线性可分的。</p><p><img src="/img/post/16714299016783.jpg" alt=""></p><h3 id="8-2-1-二维空间的例子">8.2.1 二维空间的例子</h3><p><img src="/img/post/16714299879391.jpg" alt=""></p><p>左边是一个原始的数据空间，虽然肉眼可见这个数据有明显的数据边界来进行区分，但是 SVM 并不能得到这样的边界，但是通过转换，例如转换到右边的空间，就可以称为线性可分的数据，公式如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>→</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\Phi(x) \to x_1^2, x_2^2,\sqrt{2}x_1x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2031em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Φ</span></span></span></span>是一个转换函数，其将 2-D 空间的数据转换到 3-D 空间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mn>2</mn></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.1328em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span></span></span></span>是为了后续的计算方便，有了这个 3-D 空间的数据，就可以利用直线或者平面将其分开，假设<strong>使用罗切斯特回归的方式</strong>，那么公式如下：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msub><mi>β</mi><mn>3</mn></msub><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_0+\beta_1x_1^2+\beta_2x_2^2+\beta_3\sqrt{2}x_1x_2 = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1505em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p><p>利用 SVM 也能得到这样的公式，在<strong>SVM 的计算过程</strong>中，需要利用到点积的操作，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&lt;\Phi(x_i),\Phi(x_j)&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>，先将某向量转换到高维空间，然后计算点积。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&lt;</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&gt;</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&lt;</mo><mo stretchy="false">{</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow><mn>2</mn></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo stretchy="false">}</mo><mo separator="true">,</mo><mo stretchy="false">{</mo><msubsup><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow><mn>2</mn></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo separator="true">,</mo><msqrt><mn>2</mn></msqrt><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub><mo stretchy="false">}</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&gt;</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow><mn>2</mn></msubsup><msubsup><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow><mn>2</mn></msubsup><msubsup><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\big&lt;\Phi(x_i),\Phi(x_j)\big&gt; &amp;= \big&lt;\{x_{i1}^2,x_{i2}^2,\sqrt{2}x_{i1}x_{i2}\},\{x_{j1}^2,x_{j2}^2,\sqrt{2}x_{j1}x_{j2}\}\big&gt;\\&amp;=x_{i1}^2x_{j1}^2+x_{i2}^2x_{j2}^2+2x_{i1}x_{i2}x_{j1}x_{j2}\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1864em;vertical-align:-1.3432em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8432em;"><span style="top:-3.8871em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="delimsizing size1">⟨</span></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">⟩</span></span></span></span><span style="top:-2.3399em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3432em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8432em;"><span style="top:-3.8871em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="delimsizing size1">⟨</span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9561em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span></span></span><span style="top:-2.9161em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0839em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mord"><span class="delimsizing size1">⟩</span></span></span></span><span style="top:-2.3399em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3432em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><strong>使用核函数：(直接在原始空间中进行卷积)</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&lt;</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>j</mi></msub><msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&gt;</mo><mn>2</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&lt;</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo stretchy="false">}</mo><mo separator="true">,</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub><mo stretchy="false">}</mo><msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">&gt;</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow><mn>2</mn></msubsup><msubsup><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow><mn>2</mn></msubsup><msubsup><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mrow><mi>j</mi><mn>2</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\big&lt;x_i,x_j\big&gt;^2 &amp;= \big&lt;\{x_{i1},x_{i2}\},\{x_{j1},x_{j2}\}\big&gt;^2 \\&amp;=(x_{i1}x_{j1}+x_{i2}x_{j2})^2\\&amp;=x_{i1}^2x_{j1}^2+x_{i2}^2x_{j2}^2+2x_{i1}x_{i2}x_{j1}x_{j2}\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.7853em;vertical-align:-2.1427em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6427em;"><span style="top:-4.6427em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"><span class="mord"><span class="delimsizing size1">⟨</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="delimsizing size1">⟩</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.054em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1186em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"></span></span><span style="top:-1.5944em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1427em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6427em;"><span style="top:-4.6427em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="delimsizing size1">⟨</span></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">}</span><span class="mord"><span class="mord"><span class="delimsizing size1">⟩</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.054em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.1186em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-1.5944em;"><span class="pstrut" style="height:3.054em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1427em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>从计算量来看前者比后者多很多，从计算空间看后者也更直接</p><h3 id="8-2-2-使用核方法的动机">8.2.2 使用核方法的动机</h3><p>在线性 SVM 中转化为最优化问题时求解的公式计算都是以内积形式出现的，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>是把训练集中的向量点转化为高维的非线性映射函数。</p><p>因为<strong>内积的算法复杂度非常大</strong>，所以我们利用核函数来取代计算非线性映射函数的内积。</p><p>以下核函数和非线性映射函数的内积等同，但核函数 K 的运算量要远少于求内积。</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K(X_i,X_j) = \Phi(X_i)\cdot\Phi(X_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h3 id="8-2-3-常用的核函数-kernel-functions">8.2.3 常用的核函数(kernel functions)</h3><p>h 度多项式核函数：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>h</mi></msup></mrow><annotation encoding="application/x-tex">K(X_i,X_j) = (X_i,X_j+1)^h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></p><p>高斯径向基核函数：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mfrac><mrow><mo>−</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>X</mi><mi>i</mi></msub><mo>−</mo><msub><mi>X</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></msup></mrow><annotation encoding="application/x-tex">K(X_i,X_j) = e^{\frac{-||X_i-X_j||^2}{2\sigma^2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4587em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.4587em;"><span style="top:-3.4587em;margin-right:0.05em;"><span class="pstrut" style="height:3.0053em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4361em;"><span style="top:-2.5062em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9384em;"><span style="top:-2.9384em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.6872em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">∣∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0785em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0785em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5092em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mtight">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0484em;"><span style="top:-3.0484em;margin-right:0.1em;"><span class="pstrut" style="height:2.6444em;"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4938em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>S 型核函数：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>K</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><msub><mi>X</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>X</mi><mi>j</mi></msub><mo>−</mo><mi>δ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K(X_i,X_j) = \tanh(kX_i\cdot X_j-\delta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mclose">)</span></span></span></span></span></p><p><strong>如何选择使用哪个 kernel？</strong></p><ol><li>根据先验知识，比如图像分类。通常使用 RBF（高斯径向基核函数），文字不使用 RBF</li><li>尝试不同的 kernel，根据结果准确度而定。</li></ol><p><strong>使用 kernel 的意义在于：</strong></p><ol><li>将向量的维度从低维映射到高维</li><li>降低运算复杂度</li></ol><h2 id="线性不可分">线性不可分</h2><p>无法用一条直线将两类样本点区分开</p><p><img src="/img/post/16714360342361.jpg" alt=""></p><p><img src="/img/post/16714360392171.jpg" alt=""></p><p><img src="/img/post/16714360518166.png" alt=""></p><p><strong>在线性不可分的情况下，数据集在空间中对应的向量无法被一个超平面区分开，如何处理：</strong></p><ol><li>利用一个非线性的映射把原数据集中的向量点转化到一个更高维度的空间中</li><li>在这个高维度的空间中找一个线性的超平面来根据线性可分的情况处理</li></ol><p><strong>如何利用非线性映射将原始数据转化到高维空间中去？</strong></p><p>例子：<br>有一个 3 维输入量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X=(x_1,x_2,x_3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，将其转化到 6 维空间 Z 中去：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="normal">Φ</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Φ</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Φ</mi><mn>3</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mn>3</mn></msub><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="normal">Φ</mi><mn>4</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo separator="true">,</mo><msub><mi mathvariant="normal">Φ</mi><mn>5</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Φ</mi><mn>6</mn></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}&amp;\Phi_1(X) = x_1,\Phi_2(X)=x_2,\Phi_3(X)=x_3,\\&amp;\Phi_4(X) = (x_1)^2,\Phi_5(X)=x_1x_2,\Phi_6(X) = x_1x_3\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0241em;vertical-align:-1.2621em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.7862em;"><span class="pstrut" style="height:2.8641em;"></span><span class="mord"></span></span><span style="top:-2.2621em;"><span class="pstrut" style="height:2.8641em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.9221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Φ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>新的决策超平面：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>W</mi><mi>Z</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">d(Z) = WZ+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>，其中<u>W 和 Z 是向量</u>，这个<strong>超平面是线性的</strong></p><p>解出 W 和 b 之后带入原方程</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><msub><mi>w</mi><mn>4</mn></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><msub><mi>w</mi><mn>5</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>6</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>z</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>z</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>3</mn></msub><msub><mi>z</mi><mn>3</mn></msub><mo>+</mo><msub><mi>w</mi><mn>4</mn></msub><msub><mi>z</mi><mn>4</mn></msub><mo>+</mo><msub><mi>w</mi><mn>5</mn></msub><msub><mi>z</mi><mn>5</mn></msub><mo>+</mo><msub><mi>w</mi><mn>6</mn></msub><msub><mi>z</mi><mn>6</mn></msub><mo>+</mo><mi>b</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}d(Z) &amp;= w_1x_1+w_2x_2+w_3x_3+w_4(x_1)^2+w_5x_1x_2+w_6x_1x_3+b\\&amp;=w_1z_1+w_2z_2+w_3z_3+w_4z_4+w_5z_5+w_6z_6+b\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0241em;vertical-align:-1.2621em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.8979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.8979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
      <tag>核学习</tag>
      
      <tag>SVM</tag>
      
      <tag>支持向量机</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH7 逻辑回归</title>
    <link href="/2022/12/16/CH7-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"/>
    <url>/2022/12/16/CH7-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/</url>
    
    <content type="html"><![CDATA[<h1>CH7 逻辑回归</h1><p>属于机器学习中的监督学习，主要用来解决<strong>二分类问题</strong>。</p><p>通过给定的 n 组数据（训练集）来训练模型，并在训练结束后对给定的一组或多组数据（测试集）进行分类。其中每一组数据都是由 p 个指标构成。</p><p>逻辑回归是用来分类的。例如，我们给出一个人的 [身高，体重] 这两个指标，然后判断这个人是属于”胖“还是”瘦“这一类。对于这个问题，我们可以先测量 n 个人的身高、体重以及对应的指标”胖“,&quot;瘦”，把胖和瘦分别用 0 和 1 来表示，把这 n 组数据输入模型进行训练。训练之后再把待分类的一个人的身高、体重输入模型中，看这个人是属于“胖”还是“瘦”。</p><p>从本质上来说，逻辑回归训练后的模型是平面的一条直线（p=2),或是平面（p=3)，超平面（p&gt;3)。并且这条线或平面把空间中的散点分成两半，<u>属于同一类的数据大多数分布在曲线或平面的同一侧。</u><br><img src="/img/post/16713803354164.jpg" alt=""></p><h2 id="7-1-算法原理">7.1 算法原理</h2><p>处理二分类问题，其中一类标签为 0，另一类为 1。我们需要一个函数，对于输入的每一组数据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>，都能映射成 0 ～ 1 之间的数，并且如果函数值大于 0.5，就判定属于 1，否则属于 0。</p><h3 id="7-1-1-预测函数推导过程">7.1.1 预测函数推导过程</h3><p>函数中需要待定参数，通过利用样本训练，使得这个参数能够对训练集中的数据有很准确的预测。这个函数就是<strong>sigmoid 函数</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sigma(x) = \frac{1}{1+e^{-x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>在这里我们设函数为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>x</mi><mi>i</mi></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">h(x^i) = \frac{1}{1+e^{-(w^Tx^i+b)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1256em;vertical-align:-0.8042em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2791em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8309em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7571em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8042em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>这里<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">x^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span>是测试集第 i 个数据，是 p 维列向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mn>1</mn><mi>i</mi></msubsup><mspace width="1em"/><msubsup><mi>x</mi><mn>2</mn><mi>i</mi></msubsup><mspace width="1em"/><mo>…</mo><mspace width="1em"/><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(x_1^i\quad x^i_2\quad \dots \quad x^i_p)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>是 p 维列向量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mspace width="1em"/><msub><mi>w</mi><mn>2</mn></msub><mspace width="1em"/><mo>…</mo><mspace width="1em"/><msub><mi>w</mi><mi>p</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(w_1\quad w_2\quad \dots \quad w_p)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>，为待求参数<br>b 是一个数，也是待求参数</p><p>对于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">w^Tx+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>，其结果是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>w</mi><mi>p</mi></msub><msub><mi>x</mi><mi>p</mi></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">w_1x_1+w_2x_2+\dots+w_px_p+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span><br>所以把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>写成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mspace width="1em"/><msub><mi>w</mi><mn>2</mn></msub><mspace width="1em"/><mo>…</mo><mspace width="1em"/><msub><mi>w</mi><mi>p</mi></msub><mspace width="1em"/><mi>b</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(w_1\quad w_2\quad \dots \quad w_p\quad b)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1274em;vertical-align:-0.2861em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">x^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span>写成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mn>1</mn><mi>i</mi></msubsup><mspace width="1em"/><msubsup><mi>x</mi><mn>2</mn><mi>i</mi></msubsup><mspace width="1em"/><mo>…</mo><mspace width="1em"/><msubsup><mi>x</mi><mi>p</mi><mi>i</mi></msubsup><mspace width="1em"/><mn>1</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(x_1^i\quad x^i_2\quad \dots \quad x^i_p\quad 1)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2244em;vertical-align:-0.3831em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.4519em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">w^Tx+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9247em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>就可以写成<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">w^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span>，则最终预测函数为：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>i</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><msup><mi>x</mi><mi>i</mi></msup></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">h(x^i) = \frac{1}{1+e^{-w^Tx^i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1247em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1256em;vertical-align:-0.8042em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2791em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8309em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7571em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8042em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="7-2-求解参数-证明题">7.2 求解参数(证明题)</h2><h3 id="7-2-1-极大似然估计">7.2.1 极大似然估计</h3><p>思想是，一个事件发生了，那么发生这个事件的概率就是最大的。</p><p>对于样本 i，其类别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_i\in(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>。对于样本 i，可以把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>看成一种概率。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>对应是 1 时，概率是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>属于 1 的可能性；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>对应是 0 时，概率是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1-h(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>属于 0 的可能性。<strong>构造极大似然函数</strong>：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{k}h(x_i)\prod^n_{i=k+1}(1-h(x_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1966em;vertical-align:-1.3604em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3604em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span></p><p>其中 i 从 0 到 k 是属于类别 1 的个数 k，从 k+1 到 n 是属于类别 0 的个数 n-k。由于 y 是标签 0 或 1，所以上式也可以写成：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><msub><mi>y</mi><mi>i</mi></msub></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mrow><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\prod^n_{i=1}h(x_i)^{y_i}(1-h(x_i))^{1-y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>为了方便我们对式子<strong>取对数</strong>。因为是求式子的最大值，所以<u>转换成式子乘负 1 然后求最小值</u>。可得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">-\sum^n_{i=1}y_i ln(h(x_i))-(1-y_i)ln(1-h(x_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span></p><h3 id="7-2-2-损失函数">7.2.2 损失函数</h3><p>同时对于 n 个数据，累加后值会很大，之后如果用梯度下降容易导致梯度爆炸，所以除以样本总数 n，得到的为<strong>损失函数</strong>：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo></mrow><annotation encoding="application/x-tex">L(w) = \frac{1}{n}\Big(\sum^n_{i=1}-y_i ln(h(x_i))-(1-y_i)ln(1-h(x_i))\Big)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord"><span class="delimsizing size2">)</span></span></span></span></span></span></p><p>损失函数是参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span>的函数</p><p>总的损失函数可以用来评价模型的好坏，损失函数越小越说明模型和参数越符合训练样本。</p><h3 id="7-2-3-梯度下降法求最小值">7.2.3 梯度下降法求最小值</h3><p>即求损失函数的导数</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(w) = \frac{1}{n}(\sum^n_{i=1}-y_i ln(h(x_i))-(1-y_i)ln(1-h(x_i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)))</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mfrac><mn>1</mn><mrow><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial L(w)}{\partial w} = \frac{1}{n}(\sum^n_{i=1}(-y_i\frac{1}{h(x_i)}\cdot\frac{\partial h(x_i)}{\partial w})+(1-y_i)\frac{1}{1-h(x_i)}\cdot\frac{\partial h(x_i)}{\partial w})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><hr><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>记：</mtext><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">记：\sigma(x) = \frac{1}{1+e^{-x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">记：</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(w^Tx) =\frac{1}{1+e^{-w^Tx}} = h(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1256em;vertical-align:-0.8042em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2791em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8309em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7741em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8042em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>σ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma&#x27;(x) = \sigma(x)(1-\sigma(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span></p><hr><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></msup></mrow></mfrac></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⋅</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}\frac{\partial h(x_i)}{\partial w} &amp;= \frac{\partial{\frac{1}{1+e^{-wx_i}}}}{\partial w} = \frac{\partial(\sigma (w^Tx_i))}{\partial w^Tx_i}\\&amp;=\sigma(w^Tx)(1-\sigma(w^Tx))\cdot \frac{\partial w^Tx_i}{\partial w}\\&amp;=\sigma(w^Tx)(1-\sigma(w^Tx))x_i\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.8301em;vertical-align:-3.1651em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6651em;"><span style="top:-5.6651em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0107em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"></span></span><span style="top:-1.1334em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1651em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.6651em;"><span style="top:-5.6651em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6384em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7933em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7492em;"><span style="top:-2.8326em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0107em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.1334em;"><span class="pstrut" style="height:3.6384em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.1651em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><hr><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>d</mi><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo>⋅</mo><mi>d</mi><msup><mi>w</mi><mi>T</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>⇒</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mi>x</mi><mspace width="1em"/><mtext>对上一步求导的解释</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}d(tr(w^Tx))&amp;=tr(dw^Tx)\\&amp;=tr(x\cdot dw^T)\\&amp;\Rightarrow \frac{\partial w^Tx}{\partial w} = x \quad\text{对上一步求导的解释}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.607em;vertical-align:-2.5535em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0535em;"><span style="top:-5.6805em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span><span style="top:-4.1292em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"></span></span><span style="top:-1.9508em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5535em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0535em;"><span style="top:-5.6805em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-4.1292em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.9508em;"><span class="pstrut" style="height:3.5183em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cjk_fallback">对上一步求导的解释</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.5535em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><hr><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mfrac><mn>1</mn><mrow><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>⋅</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>y</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>y</mi><mi>i</mi></msub><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\frac{\partial L(w)}{\partial w} &amp;= \frac{1}{n}\bigg(\sum^n_{i=1}-y_i\frac{1}{\sigma(w^Tx)}\sigma(w^Tx)(1-\sigma(w^Tx)x_i) + (1-y_i)\frac{1}{1-\sigma(w^Tx)}\cdot\sigma(w^Tx)(1-\sigma(w^Tx))x_i\bigg)\\&amp;=\frac{1}{n}\bigg(\sum^n_{i=1}-y_i(1-\sigma(w^Tx_i))x_i+y(1-y_i)\sigma(w^Tx_i)x_i\bigg)\\&amp;=\frac{1}{n}\bigg(\sum^n_{i=1}-y_ix_i+y_i\sigma(w^Tx_i)x_i-y_i\sigma(w^Tx_i)x_i + \sigma(w^Tx_i)x_i\bigg)\\&amp;=\frac{1}{n}\bigg(\sum^n_{i=1}-y_ix_i+\sigma(w^Tx_i)x_i\bigg)\\&amp;=\frac{1}{n}\bigg(\sum^n_{i=1}(\sigma(w^Tx_i)-y_i)x_i\bigg)\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.1453em;vertical-align:-7.8227em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.3227em;"><span style="top:-10.3227em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-7.0936em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span><span style="top:-3.8645em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span><span style="top:-0.6355em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span><span style="top:2.5936em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.8227em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.3227em;"><span style="top:-10.3227em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span><span style="top:-7.0936em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span><span style="top:-3.8645em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span><span style="top:-0.6355em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span><span style="top:2.5936em;"><span class="pstrut" style="height:3.6514em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:7.8227em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
      <tag>监督学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH6 贝叶斯方法</title>
    <link href="/2022/12/15/CH6-%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%96%B9%E6%B3%95/"/>
    <url>/2022/12/15/CH6-%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1>CH6 贝叶斯方法</h1><h2 id="6-1-贝叶斯公式">6.1 贝叶斯公式</h2><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mi mathvariant="normal">∣</mi><mi>A</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(A|B) = \frac{P(A,B)}{P(B)} = \frac{P(B|A)P(A)}{P(B)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="6-2-朴素贝叶斯">6.2 朴素贝叶斯</h2><p><strong>所有特征条件独立于决策（特征独立性）</strong>，即：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>d</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>d</mi></munderover><mi>P</mi><mo stretchy="false">(</mo><msub><mi>f</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(f_1,\dots,f_d|class) = \prod^d_{i=1}P(f_i|class)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1138em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mclose">)</span></span></span></span></span></p><p>对于连续属性可考虑为概率密度函数，假定<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mo stretchy="false">)</mo><mo>∼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x_i|c)\sim\mathcal{N}(\mu_{c,i},\sigma_{c,i}^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mu_{c,i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{c,i}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2089em;vertical-align:-0.3948em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em;"><span></span></span></span></span></span></span></span></span></span>分别是第 c 类样本在第 i 个属性上取值的均值和方差，则有：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt><msub><mi>σ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub></mrow></mfrac><mi>e</mi><mi>x</mi><mi>p</mi><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><mo>−</mo><mfrac><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><msubsup><mi>σ</mi><mrow><mi>c</mi><mo separator="true">,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></mrow></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow><annotation encoding="application/x-tex">p(x_i|c) = \frac{1}{\sqrt{2\pi}\sigma_{c,i}}exp\bigg(-\frac{(x_i-\mu_{c,i})^2}{2\sigma_{c,i}^2}\bigg)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.5333em;vertical-align:-1.0833em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.2028em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9072em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-2.8672em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1328em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0833em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.5901em;vertical-align:-1.099em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4231em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.099em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span></span></span></p><h2 id="6-3-例题">6.3 例题</h2><p>训练样本如下</p><p><img src="/img/post/16713739001569.jpg" alt=""></p><p>问题：现在又来了第七个病人，是一个打喷嚏的建筑工人，请问他患上感冒的概率有多大？</p><h3 id="6-3-1-贝叶斯">6.3.1 贝叶斯</h3><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>感冒</mtext><mi mathvariant="normal">∣</mi><mtext>打喷嚏，建筑工人</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>打喷嚏，建筑工人</mtext><mi mathvariant="normal">∣</mi><mtext>感冒</mtext><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mtext>感冒</mtext><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>打喷嚏，建筑工人</mtext><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(感冒|打喷嚏，建筑工人) = \frac{P(打喷嚏，建筑工人|感冒)P(感冒)}{P(打喷嚏，建筑工人)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">感冒</span><span class="mord">∣</span><span class="mord cjk_fallback">打喷嚏，建筑工人</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">打喷嚏，建筑工人</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">打喷嚏，建筑工人</span><span class="mord">∣</span><span class="mord cjk_fallback">感冒</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">感冒</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h3 id="6-3-2-朴素贝叶斯">6.3.2 朴素贝叶斯</h3><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>感冒</mtext><mi mathvariant="normal">∣</mi><mtext>打喷嚏，建筑工人</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>打喷嚏</mtext><mi mathvariant="normal">∣</mi><mtext>感冒</mtext><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mtext>建筑工人</mtext><mi mathvariant="normal">∣</mi><mtext>感冒</mtext><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mtext>感冒</mtext><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>打喷嚏</mtext><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mtext>建筑工人</mtext><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(感冒|打喷嚏，建筑工人) = \frac{P(打喷嚏|感冒)P(建筑工人|感冒)P(感冒)}{P(打喷嚏)P(建筑工人)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">感冒</span><span class="mord">∣</span><span class="mord cjk_fallback">打喷嚏，建筑工人</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">打喷嚏</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">建筑工人</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">打喷嚏</span><span class="mord">∣</span><span class="mord cjk_fallback">感冒</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">建筑工人</span><span class="mord">∣</span><span class="mord cjk_fallback">感冒</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">感冒</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h2 id="训练一个朴素贝叶斯分类器">训练一个朴素贝叶斯分类器</h2><p>数据集如下：<br><img src="/img/post/16713784456809.jpg" alt=""></p><p>对测试例子进行分类<br><img src="/img/post/16713785735041.jpg" alt=""></p><p><strong>首先估计类先验概率 P©</strong>，显然有：<br>P(好瓜 = 是) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>8</mn><mn>17</mn></mfrac><mo>≈</mo><mn>0.471</mn></mrow><annotation encoding="application/x-tex">\frac{8}{17} \approx 0.471</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">17</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.471</span></span></span></span><br>P(好瓜 = 否) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>9</mn><mn>17</mn></mfrac><mo>≈</mo><mn>0.529</mn></mrow><annotation encoding="application/x-tex">\frac{9}{17} \approx 0.529</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">17</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.529</span></span></span></span></p><p>然后，<strong>为每个属性估计条件概率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x_i|c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></strong><br><img src="/img/post/16713788373190.jpg" alt=""></p><p><img src="/img/post/16713788680162.jpg" alt=""></p><p>于是，有：<br><img src="/img/post/16713788964898.jpg" alt=""></p><p>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.038</mn><mo>&gt;</mo><mn>6.80</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">0.038 &gt; 6.80 \times 10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">0.038</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">6.80</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span>，因此，<strong>朴素贝叶斯分类器将测试样本判别为好瓜。</strong></p><blockquote><p>需要注意，若某个属性值在训练集中没有与某个类同时出现过，则直接按上述方法将会出现问题。<br>例如，在使用西瓜数据集 3.0 训练朴素贝叶斯分类器时，对一个“敲声 = 清脆”的测试用例，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mtext>清脆</mtext><mi mathvariant="normal">∣</mi><mtext>是</mtext></mrow></msub><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mtext>敲声</mtext><mo>=</mo><mtext>清脆</mtext><mi mathvariant="normal">∣</mi><mtext>好瓜</mtext><mo>=</mo><mtext>是</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>0</mn><mn>8</mn></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P_{清脆|是} = P(敲声 = 清脆|好瓜 = 是) = \frac{0}{8} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">清脆</span><span class="mord mtight">∣</span><span class="mord cjk_fallback mtight">是</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord cjk_fallback">敲声</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">清脆</span><span class="mord">∣</span><span class="mord cjk_fallback">好瓜</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">是</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span><br>则计算出的概率为 0，无论该样本的其他属性是什么，哪怕在其他属性上明显像好瓜，分类的结果都是否，这显然不太合理。</p></blockquote><p>为了避免其他属性携带的信息被训练集中未出现的属性值“抹去”，在估计概率值时通常需要进行“平滑”，常用“拉普拉斯修正”。<br>令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 表示训练集 D 中可能的类别数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">N_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示第 i 个属性可能的取值数，修正得：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><msub><mi>D</mi><mrow><mi>c</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></msub><mi mathvariant="normal">∣</mi><mo>+</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">∣</mi><msub><mi>D</mi><mi>c</mi></msub><mi mathvariant="normal">∣</mi><mo>+</mo><msub><mi>N</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(x_i|c) = \frac{|D_{c,x_i}|+1}{|D_c|+N_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>例如，本例子中，类先验概率可估计为：（2 为该属性可取“是”，“否”两个类别）<br>P(好瓜 = 是) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>8</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>17</mn><mo>+</mo><mn>2</mn></mrow></mfrac><mo>≈</mo><mn>0.474</mn></mrow><annotation encoding="application/x-tex">\frac{8+1}{17+2} \approx 0.474</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">17</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.474</span></span></span></span><br>P(好瓜 = 否) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>9</mn><mo>+</mo><mn>1</mn></mrow><mrow><mn>17</mn><mo>+</mo><mn>2</mn></mrow></mfrac><mo>≈</mo><mn>0.526</mn></mrow><annotation encoding="application/x-tex">\frac{9+1}{17+2} \approx 0.526</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2484em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">17</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.526</span></span></span></span></p><h2 id="6-4-贝叶斯网络">6.4 贝叶斯网络</h2><h3 id="6-4-1-贝叶斯网络示例">6.4.1 贝叶斯网络示例</h3><pre><code class=" mermaid">graph TBa((x1)) --&gt; d((x4))b((x2)) --&gt; d((x4))c((x3)) --&gt; dc --&gt; e((x5))a --&gt; ed --&gt; f((x6))d --&gt; g((x7))e --&gt; g</code></pre><p>直观上：</p><ul><li>x1 和 x2 独立</li><li>x6 和 x7 在 x4 给定的条件下独立</li></ul><p>联合分布：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>1</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>2</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>3</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>4</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mn>2</mn><mo separator="true">,</mo><mi>x</mi><mn>3</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>5</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mn>1</mn><mo separator="true">,</mo><mi>x</mi><mn>3</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>6</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mn>4</mn><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mn>7</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mn>4</mn><mo separator="true">,</mo><mi>x</mi><mn>5</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x1)P(x2)P(x3)P(x4|x1,x2,x3)P(x5|x1,x3)P(x6|x4)P(x7|x4,x5)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">2</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">3</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">4∣</span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord">3</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">5∣</span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord">3</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">6∣</span><span class="mord mathnormal">x</span><span class="mord">4</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">7∣</span><span class="mord mathnormal">x</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p><h3 id="6-4-2-例题">6.4.2 例题</h3><p>使用贝叶斯分类方法预测一个客户（<u>性别=女，婚姻状态=已婚，是否有房=无房</u>），是否会购买此保险，写出详细的计算过程</p><p><img src="/img/post/16713752978845.jpg" alt=""></p><p>解答过程：</p><p><strong>1.由训练集建立朴素贝叶斯网络</strong></p><pre><code class=" mermaid">graph TBa(购买保险) --&gt; b(性别)a --&gt; c(婚姻状态)a --&gt; d(是否有房)</code></pre><p><strong>2.由训练集得出先验概率与条件概率</strong></p><ul><li>P(购买保险 = 是) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>4</mn><mn>10</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{4}{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 0.4</li><li>P(购买保险 = 否) = 0.6</li><li>P(性别 = 女|购买保险 = 是) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 0.25</li><li>P(性别 = 女|购买保险 = 否) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>4</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{4}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 0.667</li><li>P(婚姻状态 = 已婚|购买保险 = 是) = 0</li><li>P(婚姻状态 = 已婚|购买保险 = 否) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>3</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{3}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 0.5</li><li>P(是否有房 = 无房|购买保险 = 是) = 0</li><li>P(是否有房 = 无房|购买保险 = 否) = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> = 0.167</li></ul><p><strong>3.计算联合条件概率</strong><br>记客户 X = (性别 = 女，婚姻状态 = 已婚，是否有房 = 无房)</p><p>P(X|购买保险 = 是) = P(性别 = 女|购买保险 = 是) _ P(婚姻状态 = 已婚|购买保险 = 是) _ P(是否有房 = 无房|购买保险 = 是) = 0.25 _ 0 _ 0 = 0</p><p>P(X|购买保险 = 否) = 0.667 _ 0.5 _ 0.167 = 0.056</p><p><strong>4.预测客户 X 是否购买保险</strong><br>P(X|购买保险 = 是) _ P(购买保险 = 是) = 0 _ 0.4 = 0<br>P(X|购买保险 = 否) _ P(购买保险 = 否) = 0.056 _ 0.6 = 0.0336</p><p>结论：预测客户 X 不会购买此保险</p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
      <tag>贝叶斯分类器</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH5 线性判别分析</title>
    <link href="/2022/12/15/CH5-%E7%BA%BF%E6%80%A7%E5%88%A4%E5%88%AB%E5%88%86%E6%9E%90/"/>
    <url>/2022/12/15/CH5-%E7%BA%BF%E6%80%A7%E5%88%A4%E5%88%AB%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1>CH5 线性判别分析（LDA）</h1><p><img src="/img/post/16713563311030.jpg" alt=""></p><h2 id="5-1-LDA-原理">5.1 LDA 原理</h2><p>将高维的样本数据投影到<strong>最佳判别向量空间</strong>，以达到特征提取（维数约简）的效果，投影后保证样本数据在新的子空间有<u>最大类间距和最小类内距离</u>，即在该子空间中具有最佳的可分离性</p><h2 id="5-2-中心思想">5.2 中心思想</h2><p>投影后类内方差最小，类间方差最大</p><p>投影后希望每一种类别的投影点尽可能的接近，而不同类别的数据的类别中心之间的距离尽可能大</p><h2 id="5-3-证明：什么是-LDA">5.3 证明：什么是 LDA</h2><p>给定任意的样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msup><mi>R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">x \in R^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">y = T(x) = w^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>∈</mo><msup><mi>R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">w\in R^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span>为待定向量</p><p><img src="/img/post/16713574643205.jpg" alt=""></p><p><strong>二分类问题：</strong> 设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>是一个两类的分类问题，记属于第一第二类的样本集合分别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_1,X_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，记<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_i(i=1,2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span>类的均值，即</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>i</mi></msub></mfrac><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></munder><mi>x</mi></mrow><annotation encoding="application/x-tex">\mu_i = \frac{1}{N_i}\sum_{x\in X_i}x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7159em;vertical-align:-1.3944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>经过变换后为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{z_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7806em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>（降维下的均值点）</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true">‾</mo></mover><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mfrac><mn>1</mn><msub><mi>N</mi><mi>i</mi></msub></mfrac><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></munder><mi>x</mi><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>i</mi></msub></mfrac><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></munder><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">\overline{z_i} = T(\mu_i)= w^T\mu_i = w^T\frac{1}{N_i}\sum_{x\in X_i}x = \frac{1}{N_i}\sum_{x\in X_i}w^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7806em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0858em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7159em;vertical-align:-1.3944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7159em;vertical-align:-1.3944em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">x</span></span></span></span></span></p><p>记<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">{</mo><mi>T</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">Z_i = \{T(x)|x\in X_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>，根据 LDA 的基本思想，我们希望：</p><ul><li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{z_1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7806em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{z_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7806em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>离的越远越好</strong><ul><li>类间离散度<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>J</mi><mi>b</mi></msub><mo>=</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mover accent="true"><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="true">‾</mo></mover><mo>−</mo><mover accent="true"><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="true">‾</mo></mover><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{J_b = ||\overline{z_1}-\overline{z_2}||}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.68em;vertical-align:-0.59em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.09em;"><span style="top:-3.68em;"><span class="pstrut" style="height:3.68em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">∣∣</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord">∣∣</span></span></span></span></span><span style="top:-3.09em;"><span class="pstrut" style="height:3.68em;"></span><span class="stretchy fbox" style="height:1.68em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.59em;"><span></span></span></span></span></span></span></span></span></li></ul></li><li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Z_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>中的元素越集中在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{z_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7806em;vertical-align:-0.15em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>附近越好</strong><ul><li>类内离散度<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>J</mi><mi>w</mi></msub><mo>=</mo><msubsup><mi>s</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>s</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{J_w = s_1^2 + s_2^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7911em;vertical-align:-0.587em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2041em;"><span style="top:-3.7911em;"><span class="pstrut" style="height:3.7911em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2041em;"><span class="pstrut" style="height:3.7911em;"></span><span class="stretchy fbox" style="height:1.7911em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.587em;"><span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>s</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><msub><mo>∑</mo><mrow><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>i</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><mover accent="true"><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="true">‾</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">s_i^2 = \sum_{z\in Z_i}(z-\overline{z_i})^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0728em;vertical-align:-0.2587em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1498em;vertical-align:-0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>（方差）</li></ul></li></ul><h3 id="5-3-1-线性判别目标函数">5.3.1 线性判别目标函数</h3><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mtext> </mtext><mi>m</mi><mi>a</mi><mi>x</mi><mi>J</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><msub><mi>J</mi><mi>b</mi></msub><msub><mi>J</mi><mi>w</mi></msub></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><mover accent="true"><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="true">‾</mo></mover><mo>−</mo><mover accent="true"><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="true">‾</mo></mover><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><mrow><msubsup><mi>s</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>s</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">arg\,maxJ(w) = \frac{J_b}{J_w} = \frac{|\overline{z_1}-\overline{z_2}|^2}{s_1^2+s_2^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><blockquote><p>注意：<br>目标函数要实现最大类间距离和最小类内距离<br>目标函数 J(w)中的比值在一定程度上可以看作是信噪比</p></blockquote><h4 id="5-3-1-1-目标函数简化">5.3.1.1 目标函数简化</h4><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>J</mi><mi>b</mi></msub><mo>=</mo><mi mathvariant="normal">∣</mi><mover accent="true"><msub><mi>z</mi><mn>1</mn></msub><mo stretchy="true">‾</mo></mover><mo>−</mo><mover accent="true"><msub><mi>z</mi><mn>2</mn></msub><mo stretchy="true">‾</mo></mover><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>=</mo><mi mathvariant="normal">∣</mi><msup><mi>w</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">∣</mi><mo>⇒</mo><msup><mi>w</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>μ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>μ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mi>μ</mi><mn>1</mn><mi>T</mi></msubsup><mo>−</mo><msubsup><mi>μ</mi><mn>2</mn><mi>T</mi></msubsup><mo stretchy="false">)</mo><mi>w</mi><mo>≜</mo><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>b</mi></msub><mi>w</mi></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">J_b = |\overline{z_1}-\overline{z_2}|^2 = |w^T(\mu_1-\mu_2)^2|\Rightarrow w^T(\mu_1-\mu_2)(\mu_1^T-\mu_2^T)w \triangleq \boxed{w^TS_bw}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6306em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5506em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1667em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">≜</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7213em;vertical-align:-0.49em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2313em;"><span style="top:-3.7213em;"><span class="pstrut" style="height:3.7213em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span><span style="top:-3.2313em;"><span class="pstrut" style="height:3.7213em;"></span><span class="stretchy fbox" style="height:1.7213em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.49em;"><span></span></span></span></span></span></span></span></span></span></p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≜</mo></mrow><annotation encoding="application/x-tex">\triangleq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9987em;vertical-align:-0.082em;"></span><span class="mrel amsrm">≜</span></span></span></span> 表示定义为</p></blockquote><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>J</mi><mi>w</mi></msub><mo>=</mo><msubsup><mi>s</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>s</mi><mn>2</mn><mn>2</mn></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><mrow><munder><mo>∑</mo><mrow><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>i</mi></msub></mrow></munder><mrow><mo stretchy="false">(</mo><mi>z</mi><mo>−</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>μ</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></munder><msup><mi>w</mi><mi>T</mi></msup><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>w</mi></mrow></mrow><annotation encoding="application/x-tex">J_w = s_1^2 + s_2^2 = \sum^2_{i=1}{\sum_{z\in Z_i}{(z-w^T\mu_i)^2} = \sum^2_{i=1}\sum_{x\in X_i}w^T(x-\mu_i)(x-\mu_i)^Tw}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1955em;vertical-align:-1.3944em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>=</mo><mspace linebreak="newline"></mspace><msup><mi>w</mi><mi>T</mi></msup><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>2</mn></munderover><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><msub><mi>X</mi><mi>i</mi></msub></mrow></munder><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">)</mo><mi>w</mi><mo>≜</mo><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>w</mi></msub><mi>w</mi></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">= \\w^T(\sum^2_{i=1}\sum_{x\in X_i}(x-\mu_i)(x-\mu_i)^T)w \triangleq \boxed{w^TS_ww}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:3.1955em;vertical-align:-1.3944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0785em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1667em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel amsrm">≜</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7213em;vertical-align:-0.49em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2313em;"><span style="top:-3.7213em;"><span class="pstrut" style="height:3.7213em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span><span style="top:-3.2313em;"><span class="pstrut" style="height:3.7213em;"></span><span class="stretchy fbox" style="height:1.7213em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.49em;"><span></span></span></span></span></span></span></span></span></span></p><h4 id="5-3-1-2-目标函数优化">5.3.1.2 目标函数优化</h4><blockquote><p>上述问题的 w 并不是唯一的，倘若 w 对应 J(w)的极大值点，则 a*w 仍然可以达到 J(w)的极大值点</p><p>问题转化为：</p></blockquote><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mtext> </mtext><mi>m</mi><mi>a</mi><mi>x</mi><msub><mi>J</mi><mi>b</mi></msub><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>b</mi></msub><mi>w</mi><mtext>，使得</mtext><mtext> </mtext><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>w</mi></msub><mi>w</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">arg\,maxJ_b(w) = w^TS_bw，使得\,w^TS_ww = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord cjk_fallback">，使得</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p><p>构造拉格朗日函数为</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>λ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>b</mi></msub><mi>w</mi><mo>−</mo><mi>λ</mi><mo stretchy="false">(</mo><msup><mi>w</mi><mi>T</mi></msup><msub><mi>S</mi><mi>w</mi></msub><mi>w</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}(w,\lambda) = w^TS_bw - \lambda(w^TS_ww-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord mathnormal">λ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><p>对拉格朗日函数求偏导并设其偏导数为零，得</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><mn>2</mn><msub><mi>S</mi><mi>b</mi></msub><mi>w</mi><mo>−</mo><mn>2</mn><mi>λ</mi><msub><mi>S</mi><mi>w</mi></msub><mi>w</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\frac{\partial\mathcal{L}}{\partial w} = 2S_bw-2\lambda S_ww = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathcal">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord mathnormal">λ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p><p>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">S_w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>可逆，那么</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>S</mi><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>S</mi><mi>b</mi></msub><mi>w</mi><mo>=</mo><mi>λ</mi><mi>w</mi></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{S_w^{-1}S_bw = \lambda w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7911em;vertical-align:-0.587em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2041em;"><span style="top:-3.7911em;"><span class="pstrut" style="height:3.7911em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">λ</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span><span style="top:-3.2041em;"><span class="pstrut" style="height:3.7911em;"></span><span class="stretchy fbox" style="height:1.7911em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.587em;"><span></span></span></span></span></span></span></span></span></span></p><h3 id="5-3-2-结论">5.3.2 结论</h3><p>最优 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> 就是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>S</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">S^{-1}_wS_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的特征向量，而这个公式也称为<strong>Fisher 线性判别</strong></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH4 主成分分析</title>
    <link href="/2022/12/13/CH4-%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90/"/>
    <url>/2022/12/13/CH4-%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1>CH4 主成分分析（PCA）</h1><p>利用<strong>正交变换</strong>来对一系列可能相关的变量的观测值进行线性变换，从而投影维一系列线性不相关变量的值，<strong>这些不相关变量称为主成分</strong></p><h2 id="4-1-概念与特点">4.1 概念与特点</h2><ul><li><strong>概念</strong><ul><li>思想是将 m 维特征映射到 k 维上（k&lt;m），这 k 维是全新的正交特征。这 k 维特征称为主成分（PC），是重新构造出来的 k 维特征</li></ul></li><li><strong>特点</strong><ul><li>源于质心的矢量</li><li>主成分#1 指向最大方差的方向</li><li>各后续主成分与前一主成分正交，且指向残差子空间最大方差的方向</li></ul></li></ul><h2 id="4-2-解释">4.2 解释</h2><p>对于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>P</mi><mi>X</mi></mrow><annotation encoding="application/x-tex">Y = PX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>c</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>c</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mn>1</mn><mi>m</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mn>2</mn><mi>m</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mi>n</mi><mi>m</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(\begin{matrix}    P_{11} &amp; P_{12} &amp; \dots &amp; P_{1n} \\    P_{21} &amp; P_{22} &amp; \dots &amp; P_{2n} \\    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\    P_{c1} &amp; P_{c2} &amp; \dots &amp; P_{cn}\end{matrix} \right)\left(\begin{matrix}    X_{11} &amp; X_{12} &amp; \dots &amp; X_{1m} \\    X_{21} &amp; X_{22} &amp; \dots &amp; X_{2m} \\    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\    X_{n1} &amp; X_{n2} &amp; \dots &amp; X_{nm}\end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,1884c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-1892c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.64em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.58em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.38em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,1809c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-1944c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,1884c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-1892c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.64em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.58em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.38em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">nm</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,1809c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-1944c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>=</mo><mspace linebreak="newline"></mspace><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>P</mi><mn>11</mn></msub><msub><mi>X</mi><mn>11</mn></msub><mo>+</mo><msub><mi>P</mi><mn>12</mn></msub><msub><mi>X</mi><mn>21</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>P</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>P</mi><mn>21</mn></msub><msub><mi>X</mi><mn>11</mn></msub><mo>+</mo><msub><mi>P</mi><mn>22</mn></msub><msub><mi>X</mi><mn>21</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>P</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>P</mi><mrow><mi>c</mi><mn>1</mn></mrow></msub><msub><mi>X</mi><mn>11</mn></msub><mo>+</mo><msub><mi>P</mi><mrow><mi>c</mi><mn>2</mn></mrow></msub><msub><mi>X</mi><mn>21</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>n</mi></mrow></msub><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">= \\\left(\begin{matrix}    P_{11}X_{11}+P_{12}X_{21}+\cdots+P_{1n}X_{n1} &amp; \dots\\    P_{21}X_{11}+P_{22}X_{21}+\cdots+P_{2n}X_{n1} &amp; \dots &amp; \vdots\\    \vdots &amp; \ddots &amp; \vdots \\    P_{c1}X_{11}+P_{c2}X_{21}+\cdots+P_{cn}X_{n1} &amp; \dots &amp; \vdots\\\end{matrix} \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:6.78em;vertical-align:-3.14em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.875em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='6.600em' viewBox='0 0 875 6600'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,3084c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-3092c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.64em;"><span style="top:-6.4875em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9075em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.14em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.64em;"><span style="top:-6.3em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.58em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-0.72em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.14em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.44em;"><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-0.9075em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.14em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.55em;"><span style="top:-5.55em;"><span class="pstrut" style="height:8.6em;"></span><span style="width:0.875em;height:6.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='6.600em' viewBox='0 0 875 6600'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,3009c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-3144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.05em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>如果 X 每一列表示一个样本，每一行表示 1 个属性，如上，X 经过 P 的投影从 n 维转化为了 c 维，如果 c&lt;n，那么我们就达到了降维的目的</p><h2 id="4-3-为什么要对输入数据进行中心化操作">4.3 为什么要对输入数据进行中心化操作</h2><p>如果有 m 个样本数据，中心化操作如下</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>←</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i \leftarrow x_i -\frac{1}{m}\sum^m_{i=1}x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>即：使特征的平均值为 0，方差为 1</p><p>如果中心不固定，虽然点的相对位置不变，但是坐标绝对值不同，就会导致没办法很好的量化点的分散程度。</p><p>我们求协方差的时候，先会将每个样本减去平均值，在进行取平方再平均的运算。中心化的操作可以看成求协方差的一部分。</p><h2 id="4-4-目的">4.4 目的</h2><p>我们希望通过降维使样本之间更加可分</p><ul><li>对同一个属性，不同样本在这个属性的方差要尽量大</li><li>投影之后样本与样本之间的线性相关性要尽量小</li></ul><h2 id="4-5-证明">4.5 证明</h2><p><strong>为什么计算样本的协方差矩阵，并作特征值分解？</strong></p><p>从以上两个目的出发我们来看 Y</p><p>对于一个方阵<br>记<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Y = (y_1, y_2, \dots, y_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><msup><mi>Y</mi><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>y</mi><mn>1</mn><mn>2</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>1</mn></msub><msub><mi>y</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>1</mn></msub><msub><mi>y</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>2</mn></msub><msub><mi>y</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>y</mi><mn>2</mn><mn>2</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mn>2</mn></msub><msub><mi>y</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mi>n</mi></msub><msub><mi>y</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>y</mi><mi>n</mi></msub><msub><mi>y</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">…</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>y</mi><mi>n</mi><mn>2</mn></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">YY^T =\left(\begin{matrix}    y_1^2 &amp; y_1y_2 &amp; \dots &amp; y_1y_n \\    y_2y_1 &amp; y_2^2 &amp; \dots &amp; y_2y_n \\    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\    y_ny_1 &amp; y_ny_2 &amp; \dots &amp; y_n^2\end{matrix}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.46em;vertical-align:-2.48em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,-36,557 l0,1884c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189l0,-1892c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.64em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span><span style="top:-2.58em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.38em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">…</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.98em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.48em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-4.95em;"><span class="pstrut" style="height:7.4em;"></span><span style="width:0.875em;height:5.400em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='5.400em' viewBox='0 0 875 5400'><path d='M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,1809c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558l0,-1944c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>的每一行均值为 0 的话，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><msup><mi>Y</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">YY^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><u>对角线上刚好是方差</u>，而<u>不在对角线上的刚好是样本之间的协方差</u></p><p>即：<br>若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>P</mi><mi>X</mi></mrow><annotation encoding="application/x-tex">Y = PX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span></span></span></span>：<br>则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><msup><mi>Y</mi><mi>T</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mi>P</mi><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>P</mi><mi>X</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mi>P</mi><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup><msup><mi>P</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">YY^T = (PX)(PX)^T = PXX^TP^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p><p>很明显，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">XX^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>是个实对称矩阵</p><blockquote><p>实对称矩阵一定可以正交对角化</p></blockquote><p>如果我们想要将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><msup><mi>Y</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">YY^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>中<u>除了对角线以外的元素全化为 0</u>，也就是求一个 P，让<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">XX^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>正交对角化，即：使</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup><msup><mi>P</mi><mi>T</mi></msup><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>λ</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>≥</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>≥</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">PXX^TP^T = diag(\lambda_1, \lambda_2, \dots, \lambda_n),\lambda_1\ge\lambda_2\ge\dots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">ia</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.123em;"></span><span class="minner">…</span></span></span></span></span></p><blockquote><p>对角线以外的元素全化为 0，即最小化 Y 的各个属性之间的协方差。因为各个属性之间没有相关，才能让属性差异最大，说明属性分布更加离散</p></blockquote><p>P 就是特征值按照位置对应的特征向量。<br>接着我们将原式拆解：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup><msup><mi>P</mi><mi>T</mi></msup><mo>≈</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>p</mi><mn>1</mn></msub><msubsup><mi>p</mi><mn>1</mn><mi>T</mi></msubsup><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>p</mi><mn>2</mn></msub><msubsup><mi>p</mi><mn>2</mn><mi>T</mi></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>λ</mi><mi>k</mi></msub><msub><mi>p</mi><mi>k</mi></msub><msubsup><mi>p</mi><mi>k</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">PXX^TP^T \approx \lambda_1p_1p_1^T+\lambda_2p_2p_2^T+\dots+\lambda_kp_kp_k^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1383em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>取前 k 大的特征值和对应的特征向量，能得到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>X</mi><msup><mi>X</mi><mi>T</mi></msup><msup><mi>P</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">PXX^TP^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">PX</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>的近似，所以用这些特征向量构成 P，P 的维度是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">k\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>，就得到我们需要的变换矩阵 P 了</p><h2 id="4-6-主成分分析的结论">4.6 主成分分析的结论</h2><ol><li>将 m 个样本沿着维度的方向 0 均值化后按行排成一个矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>m</mi><mo separator="true">,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{m,n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>并计算得到协方差矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi></mrow><annotation encoding="application/x-tex">A = X^TX</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></li><li>计算协方差矩阵 A 的 n 个特征值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>λ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_1, \lambda_2,\dots,\lambda_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>（可能有重复值）和对应的特征向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>u</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>u</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">u_1, u_2, \dots,u_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>将 n 个特征值按照从大到小的顺序进行排序，相应的将 n 个特征向量也排序</li><li>选前 k 个特征向量，按列排列得到一个变换矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>n</mi><mo separator="true">,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{n,k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，每个样本经过变换矩阵后得到降维后的样本（由 n 维变为 k 维）</li></ol>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH3 K-means聚类</title>
    <link href="/2022/12/13/CH3-K-means%E8%81%9A%E7%B1%BB/"/>
    <url>/2022/12/13/CH3-K-means%E8%81%9A%E7%B1%BB/</url>
    
    <content type="html"><![CDATA[<h1>CH3 K-means 聚类</h1><p><strong>随机选取 K 个对象作为初始的聚类中心</strong>，然后计算每个样本与各个聚类中心之间的距离，把每个样本分配给距离它最近的聚类中心，聚类中心以及分配给它们的对象就代表一个聚类</p><p>每分配一次样本，<strong>聚类的聚类中心会根据聚类中现有的对象被重新计算</strong></p><p>这个过程不断重复直到满足某个终止条件，可以是<u>没有（或最小数目）样本被重新分配给不同的聚类</u>，<u>没有（或最小数目）聚类中心再发生变化</u>，<u>误差平方和局部最小</u></p><p>在这里 K 就是我们想要分割的聚类个数</p><h2 id="3-1-算法步骤">3.1 算法步骤</h2><ul><li><p><strong>输入：</strong> 数据样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>x</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{x_i\}^n_{i=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>，聚类个数 K</p></li><li><p><strong>输出：</strong> 所有样本的聚类标签<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>y</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{y_i\}^n_{i=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span></p><ol><li><p>随机生成 K 个聚类中心，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">u_1,\ldots,u_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>重复如下至收敛：</p><ol><li><p>计算每个样本与每一个聚类中心的距离（如欧式距离），离哪个聚类中心近，就划分到哪个聚类所属的集合</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mtext> </mtext><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mspace width="1em"/><msub><mi>x</mi><mi>i</mi></msub><mtext>离哪个</mtext><msub><mi>μ</mi><mi>j</mi></msub><mtext>最近</mtext></mrow><annotation encoding="application/x-tex">cluster_i=arg\,min_j||x_i-\mu_j||\quad x_i\text{离哪个}\mu_j\text{最近}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord cjk_fallback">离哪个</span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord cjk_fallback">最近</span></span></span></span></span></span></p><blockquote><p>arg min 返回取得 min 值时 j 的值</p></blockquote><p>其实此时<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>就等于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">cluster_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，即标签</p></li><li><p>重新计算每个集合的聚类中心（集合中坐标的中心点）</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>μ</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>1</mn><mo stretchy="false">(</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">)</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>1</mn><mo stretchy="false">(</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mfrac><mspace width="1em"/><mtext>对所有集合取一个均值，坐标的中心点</mtext></mrow><annotation encoding="application/x-tex">\mu_j = \frac{\sum^n\limits_{i=1}1(cluster_i=j)x_i}{\sum^n\limits_{i=1}1(cluster_i=j)} \quad\text{对所有集合取一个均值，坐标的中心点}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.9381em;vertical-align:-2.2191em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7191em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.3514em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span><span style="top:-3.5814em;"><span class="pstrut" style="height:3.3514em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.7191em;"><span class="pstrut" style="height:3.3514em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2191em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cjk_fallback">对所有集合取一个均值，坐标的中心点</span></span></span></span></span></span></p></li></ol></li><li><p>返回所有样本的聚类标签</p></li></ol></li></ul><h2 id="3-2-算法图解">3.2 算法图解</h2><p><img src="/img/post/16712639265410.jpg" alt=""></p><h2 id="3-3-目标函数">3.3 目标函数</h2><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mspace width="1em"/><mtext>所有点到他距离中心的范数之和</mtext></mrow><annotation encoding="application/x-tex">J = \sum^n_{i=1}\sum^k_{j=1}r_{ij}||x_i-\mu_j||\quad\text{所有点到他距离中心的范数之和}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2499em;vertical-align:-1.4138em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cjk_fallback">所有点到他距离中心的范数之和</span></span></span></span></span></span></p><p>范数：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><mo>−</mo><msubsup><mi>μ</mi><mi>j</mi><mi>T</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mi>i</mi></msub><msub><mi>μ</mi><mi>j</mi></msub><mo>+</mo><msubsup><mi>μ</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>μ</mi><mi>j</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{split}||x_i-\mu_j|| &amp;= (x_i-\mu_j)^T(x_i-\mu_j)\\&amp;= (x_i^T-\mu_j^T)(x_i-\mu_j)\\&amp;=x_i^Tx_i-2x_i\mu_j+\mu_j^T\mu_j\end{split}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.7002em;vertical-align:-2.1001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6001em;"><span style="top:-4.7088em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span></span></span><span style="top:-3.1574em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.583em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6001em;"><span style="top:-4.7088em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.1574em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.583em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li>如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>被分配到第 j 个类簇中，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_{ij}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>，否则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r_{ij}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></li><li>通过对上式中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>求导可得类簇中心更新公式：<p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>μ</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>r</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mu_j = \frac{\sum^n\limits_{i=1}r_{ij}x_i}{\sum^n\limits_{i=1}r_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.9381em;vertical-align:-2.2191em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7191em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.3514em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.5814em;"><span class="pstrut" style="height:3.3514em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.7191em;"><span class="pstrut" style="height:3.3514em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.1223em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2191em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ul><h2 id="3-4-例题">3.4 例题</h2><p>假设有如下 8 个点：(3,1), (3,2), (4,1), (4,2), (1,3), (1,4), (2,3), (2,4)，使用 K- means 算法对其进行聚类。设初始聚类中心分别为(0,4)和(3,3)，请写出详细的计算过程</p><p><strong>1.数据</strong></p><table><thead><tr><th></th><th>X</th><th>Y</th></tr></thead><tbody><tr><td>A1</td><td>3</td><td>1</td></tr><tr><td>A2</td><td>3</td><td>2</td></tr><tr><td>A3</td><td>4</td><td>1</td></tr><tr><td>A4</td><td>4</td><td>2</td></tr><tr><td>A5</td><td>1</td><td>3</td></tr><tr><td>A6</td><td>1</td><td>4</td></tr><tr><td>A7</td><td>2</td><td>3</td></tr><tr><td>A8</td><td>2</td><td>4</td></tr></tbody></table><p><strong>2.初始聚类中心分别为 D1(0,4)，D2(3,3)计算各点到两中心的距离</strong></p><table><thead><tr><th></th><th>D1(0,4)</th><th>D2(3,3)</th></tr></thead><tbody><tr><td>A1(3,1)</td><td>4.242</td><td><u><strong>2</strong></u></td></tr><tr><td>A2(3,2)</td><td>3.605</td><td><u><strong>1</strong></u></td></tr><tr><td>A3(4,1)</td><td>5</td><td><u><strong>2.236</strong></u></td></tr><tr><td>A4(4,2)</td><td>4.472</td><td><u><strong>1.414</strong></u></td></tr><tr><td>A5(1,3)</td><td><u><strong>1.414</strong></u></td><td>2</td></tr><tr><td>A6(1,4)</td><td><u><strong>1</strong></u></td><td>2.236</td></tr><tr><td>A7(2,3)</td><td>2.236</td><td><u><strong>1</strong></u></td></tr><tr><td>A8(2,4)</td><td>2</td><td><u><strong>1.414</strong></u></td></tr></tbody></table><p><strong>3.根据上表分成两簇，{A1, A2, A3, A4, A7, A8}, {A5, A6}重新计算新的聚类中心</strong></p><ul><li>D3(3, 2.167)<ul><li>x = (3+3+4+4+2+2)/6 = 3 (各点横坐标平均值)</li><li>y = (1+2+1+2+3+4)/6 = 2.167 （各点纵坐标平均值）</li></ul></li><li>D4(1, 3.5)<ul><li>x = (1+1)/2 = 1</li><li>y = (3+4)/2 = 3.5</li></ul></li></ul><p><strong>4.计算新的距离表</strong></p><table><thead><tr><th></th><th>D3(3, 2.167)</th><th>D4(1, 3.5)</th></tr></thead><tbody><tr><td>A1(3,1)</td><td><strong><u>1.167</u></strong></td><td>3.201</td></tr><tr><td>A2(3,2)</td><td><strong><u>0.167</u></strong></td><td>2.5</td></tr><tr><td>A3(4,1)</td><td><strong><u>1.536</u></strong></td><td>3.905</td></tr><tr><td>A4(4,2)</td><td><strong><u>1.103</u></strong></td><td>3.354</td></tr><tr><td>A5(1,3)</td><td>2.166</td><td><strong><u>0.5</u></strong></td></tr><tr><td>A6(1,4)</td><td>2.712</td><td><strong><u>0.5</u></strong></td></tr><tr><td>A7(2.3)</td><td>1.301</td><td><strong><u>1.118</u></strong></td></tr><tr><td>A8(2,4)</td><td>2.088</td><td><strong><u>1.118</u></strong></td></tr></tbody></table><p><strong>5.根据上表分成两簇，{A1, A2, A3, A4}, {A5, A6, A7, A8}重新计算新的聚类中心</strong></p><ul><li>D5(3.5, 1.5)<ul><li>x = (3+3+4+4)/4 = 3.5</li><li>y = (1+2+1+2)/4 = 1.5</li></ul></li><li>D6(1.5, 3.5)<ul><li>x = (1+1+2+2)/4 = 1.5</li><li>y = (3+4+3+4)/4 = 3.5</li></ul></li></ul><p><strong>6.计算新的距离表</strong></p><table><thead><tr><th></th><th>D5(3.5, 1.5)</th><th>D6(1.5, 3.5)</th></tr></thead><tbody><tr><td>A1(3,1)</td><td><strong><u>0.707</u></strong></td><td>2.915</td></tr><tr><td>A2(3.2)</td><td><strong><u>0.707</u></strong></td><td>2.121</td></tr><tr><td>A3(4,1)</td><td><strong><u>0.707</u></strong></td><td>3.535</td></tr><tr><td>A4(4,2)</td><td><strong><u>0.707</u></strong></td><td>2.915</td></tr><tr><td>A5(1,3)</td><td>2.915</td><td><strong><u>0.707</u></strong></td></tr><tr><td>A6(1,4)</td><td>3.535</td><td><strong><u>0.707</u></strong></td></tr><tr><td>A7(2,3)</td><td>2.121</td><td><strong><u>0.707</u></strong></td></tr><tr><td>A8(2,4)</td><td>2.915</td><td><strong><u>0.707</u></strong></td></tr></tbody></table><p><strong>7.根据上表分成两簇，{A1, A2, A3, A4}, {A5, A6, A7, A8}，和上一次分簇一致，停止计算</strong></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH2 KNN分类算法</title>
    <link href="/2022/12/13/CH2-KNN%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/"/>
    <url>/2022/12/13/CH2-KNN%E5%88%86%E7%B1%BB%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1>CH2 KNN 分类算法</h1><p>每个样本都可以用它最接近的 K 个邻居来代表，KNN 是通过<strong>测量不同特征值之间的距离进行分类</strong></p><h2 id="2-1-算法图解">2.1 算法图解</h2><p><img src="/img/post/16712608560526.jpg" alt=""></p><h2 id="2-2-算法步骤">2.2 算法步骤</h2><ul><li><strong>输入：</strong> 训练样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{x_i, y_i\}^n_{i=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0087em;vertical-align:-0.2587em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em;"><span></span></span></span></span></span></span></span></span></span>，测试样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>，近邻个数 K，距离函数 dist</li><li><strong>输出：</strong> 测试样本<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>的预测类别<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><ol><li>计算测试数据与各个训练数据之间的距离</li><li>按照距离的递增关系进行排序</li><li>选取距离最小的 K 个点</li><li>确定前 K 个点所在类别的出现频率</li><li>返回前 K 个点中出现频率最高的类别作为测试数据的预测分类</li></ol></li></ul><h3 id="2-2-1-常用的距离度量方法">2.2.1 常用的距离度量方法</h3><p><strong>欧几里得距离</strong><br>多维空间中各个点之间的绝对距离</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">dist(X,Y) = \sqrt{\sum^n_{i=1}(x_i-y_i)^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.1568em;vertical-align:-1.2777em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791em;"><span class="svg-align" style="top:-5.1168em;"><span class="pstrut" style="height:5.1168em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391em;"><span class="pstrut" style="height:5.1168em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.1968em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='3.1968em' viewBox='0 0 400000 3196' preserveAspectRatio='xMinYMin slice'><path d='M702 80H40000040H742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span></span></span></span></span></p><p><strong>明可夫斯基距离</strong><br>欧式距离的推广，是对多个距离度量公式的概括性表述</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mi mathvariant="normal">∣</mi><mi>p</mi></msup><msup><mo stretchy="false">)</mo><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow><annotation encoding="application/x-tex">dist(X,Y) = (\sum^n_{i=1}|x_i-y_i|^p)^{\frac{1}{p}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2868em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0368em;"><span style="top:-3.4458em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4829em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>p=2 时得到欧式距离</p><p><strong>曼哈顿距离</strong><br>由明氏距离中 p=1 时得到的公式，将多个维度上的距离进行求和后的结果</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">dist(X,Y) = \sum^n_{i=1}|x_i-y_i|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p><p><strong>向量空间余弦相似度</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>=</mo><mfrac><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>y</mi><mo>⃗</mo></mover></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>⋅</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">sin(X,Y) = cos\theta = \frac{\vec{x}\cdot\vec{y}}{||x||\cdot||y||}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.327em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.391em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">x</span><span class="mord">∣∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∣∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1799em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH1 机器学习导论</title>
    <link href="/2022/12/13/CH1-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AF%BC%E8%AE%BA/"/>
    <url>/2022/12/13/CH1-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AF%BC%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<h1>CH1 机器学习导论</h1><h2 id="1-1-什么是机器学习">1.1 什么是机器学习</h2><p>对于<u>某类任务 T</u>和<u>性能度量 P</u>，如果一个计算机程序在 T 上以 P 衡量的性能随着<u>经验 E</u>而自我完善，那么为我们称这个计算机程序在从经验 E 中学习</p><p><strong>&lt;P,T,E&gt;</strong></p><h2 id="1-2-学习任务">1.2 学习任务</h2><ul><li>有监督学习<ul><li>分类</li><li>回归</li><li>降维</li></ul></li><li>无监督学习<ul><li>密度估计</li><li>聚类</li><li>降维</li><li>图像分割</li></ul></li><li>弱监督学习<ul><li>半监督学习</li><li>偏监督学习</li></ul></li><li>增强学习<ul><li>Q-learning</li></ul></li></ul><h2 id="1-3-监督学习">1.3 监督学习</h2><pre><code class=" mermaid">graph LRf(特征空间 X)--&gt;l(标签 Y)--&gt;c(分类)</code></pre><p><img src="/img/post/16712600393952.jpg" alt=""></p><blockquote><p>所谓监督学习，就是先利用有标签的训练数据学习得到一个模型，然后使用这个模型对新样本进行预测。在本质上，监督学习的目标在于，构建一个由输入到输出的映射，该映射用模型来表示。</p></blockquote><h2 id="1-4-无监督学习">1.4 无监督学习</h2><p>与监督学习的区别是没有标签<br><img src="/img/post/16712601848763.jpg" alt=""></p><blockquote><p>对没有概念标记（分类）的训练样本进行学习，以发现训练样本集中的结构性知识。这里，所有的标记（分类）是未知的。因此，训练样本的岐义性高。<strong>聚类就是典型的无监督学习</strong></p></blockquote><h2 id="1-5-半监督学习">1.5 半监督学习</h2><p>介于监督学习与无监督学习之间，使用大量的未标记数据，以及同时使用标记数据，来进行模式识别工作</p><h2 id="1-6-聚类与分类">1.6 聚类与分类</h2><ul><li>聚类<ul><li>将数据对象的集合分成相似的对象类的过程，使得同一个簇（类）中的对象之间具有较高的相似性，而不同簇中的对象具有较高的相异性，并且<strong>事先不知道数据集本身有多少类别</strong>，属于<strong>无监督学习</strong></li></ul></li><li>分类<ul><li>实现已知道数据集中包含多少种类，从而对数据集中每一样本进行分类，且所分配的标签必须包含在已知的标签集中，属于<strong>监督学习</strong></li></ul></li></ul><h2 id="1-7-分类精度-ACC">1.7 分类精度 ACC</h2><p>被正确分类的样本数占样本总数的个数</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mi>C</mi><mi>C</mi><mo>=</mo><mfrac><msub><mi>n</mi><mrow><mi>c</mi><mi>o</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>t</mi></mrow></msub><msub><mi>n</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">ACC = \frac{n_{correct}}{n_{total}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">CC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.9436em;vertical-align:-0.836em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">correc</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH5 数据库完整性</title>
    <link href="/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7/"/>
    <url>/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1>第五章 数据库完整性</h1><p>数据库完整性指数据的<strong>正确性、相容性</strong>和<strong>有效性</strong></p><p>为维护数据库的完整性，数据库管理系统需实现如下功能：</p><ul><li>提供定义完整性约束条件的机制</li><li>提供完整性检查方法</li><li>进行违约处理</li></ul><h2 id="5-1-实体完整性">5.1 实体完整性</h2><h3 id="5-1-1-定义实体完整性">5.1.1 定义实体完整性</h3><p>在 CREATE TABLE 中用<strong>PRIMARY KEY</strong>定义</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">Sno <span class="hljs-type">CHAR</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">PRIMARY</span> KEY     <span class="hljs-comment">/*在列级定义主码*/</span><br><br><span class="hljs-keyword">PRIMARY</span> KEY(Sno)            <span class="hljs-comment">/*在表级定义主码*/</span><br><br><span class="hljs-keyword">PRIMARY</span> KEY(Sno,Cno)        <span class="hljs-comment">/*多个属性构成的码只能在表级定义*/</span><br></code></pre></td></tr></table></figure><h3 id="5-1-2-实体完整性检查">5.1.2 实体完整性检查</h3><ul><li>检查主码值是否唯一，不唯一则拒绝插入或修改</li><li>检查主码的各个属性是否为空，有一个为空就拒绝插入或修改</li></ul><h2 id="5-2-参照完整性">5.2 参照完整性</h2><p>增删改都可能破坏参照完整性</p><h3 id="5-2-1-定义参照完整性">5.2.1 定义参照完整性</h3><p>在 CREATE TABLE 中用<strong>FOREIGN KEY</strong>短语定义哪些列为外码，用<strong>REFERENCES</strong>短语指明这些外码参照哪些表的主码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> SC<br>    (Sno <span class="hljs-type">CHAR</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>     Cno <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>     Grade <span class="hljs-type">SMALLINT</span>,<br>     <span class="hljs-keyword">PRIMARY</span> KEY(Sno,Cno),                      <span class="hljs-comment">/*表级定义实体完整性*/</span><br>     <span class="hljs-keyword">FOREIGN</span> KEY(Sno) <span class="hljs-keyword">REFERENCES</span> Student(Sno),  <span class="hljs-comment">/*表级定义参照完整性*/</span><br>     <span class="hljs-keyword">FOREIGN</span> KEY(Cno) <span class="hljs-keyword">REFERENCES</span> Course(Cno)    <span class="hljs-comment">/*表级定义参照完整性*/</span><br>    );<br></code></pre></td></tr></table></figure><h3 id="5-2-2-参照完整性检查和违约处理">5.2.2 参照完整性检查和违约处理</h3><table><thead><tr><th>被参照表</th><th>参照表</th><th>违约处理</th></tr></thead><tbody><tr><td>可能破坏参照完整性</td><td>插入元组</td><td>拒绝</td></tr><tr><td>可能破坏参照完整性</td><td>修改外码值</td><td>拒绝</td></tr><tr><td>删除元组</td><td>可能破坏参照完整性</td><td>拒绝(NO ACTION)/级联删除(CASCADE)/设置为空值</td></tr><tr><td>修改主码值</td><td>可能破坏参照完整性</td><td>拒绝(NO ACTION)/级联删除(CASCADE)/设置为空值</td></tr></tbody></table><p><strong>显式说明参照完整性的违约处理示例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> SC<br>    (Sno <span class="hljs-type">CHAR</span>(<span class="hljs-number">9</span>),<br>     Cno <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>),<br>     Grade <span class="hljs-type">SMALLINT</span>,<br>     <span class="hljs-keyword">PRIMARY</span> KEY(Sno, Cno),     <span class="hljs-comment">/*在表级定义实体完整性，Sno，Cno都不能取空值*/</span><br>     <span class="hljs-keyword">FOREIGN</span> KEY(Sno) <span class="hljs-keyword">REFERENCES</span> Student(Sno)   <span class="hljs-comment">/*表级定义参照完整性*/</span><br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> CASCADE<br>                        <span class="hljs-comment">/*当删除Student表中的元组时，级联删除SC表中相应的元组*/</span><br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> CASCADE<br>                        <span class="hljs-comment">/*当更新Student表中的元组时，级联更新SC表中相应的元组*/</span><br>     <span class="hljs-keyword">FOREIGN</span> KEY(Cno) <span class="hljs-keyword">REFERENCES</span> Course(Cno)<br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">NO</span> ACTION<br>                        <span class="hljs-comment">/*当删除Course表中的元组造成SC表不一致时，拒绝删除*/</span><br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> CASCADE<br>                        <span class="hljs-comment">/*当更新Course表中的元组时，级联更新SC表中相应的元组*/</span><br>    );<br></code></pre></td></tr></table></figure><h2 id="5-3-用户定义的完整性">5.3 用户定义的完整性</h2><h3 id="5-3-1-属性上的约束条件">5.3.1 属性上的约束条件</h3><ul><li>列值非空(NOT NULL)</li><li>列值唯一(UNIQUE)</li><li>检查列值是否满足一个条件表达式（CHECK 语句）<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*性别属性Ssex只允许取‘男’或‘女’*/</span><br>Ssex <span class="hljs-type">CHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">CHECK</span>(Ssex <span class="hljs-keyword">In</span>(<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;女&#x27;</span>))<br></code></pre></td></tr></table></figure></li></ul><h3 id="5-3-2-元组上的约束条件">5.3.2 元组上的约束条件</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*当性别为男时，其名字不能以Ms.开头*/</span><br><span class="hljs-keyword">CHECK</span>(Ssex<span class="hljs-operator">=</span><span class="hljs-string">&#x27;女&#x27;</span> <span class="hljs-keyword">OR</span> Sname <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;Ms.%&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="5-4-完整性约束命名子句">5.4 完整性约束命名子句</h2><h3 id="5-4-1-定义完整性约束命名子句">5.4.1 定义完整性约束命名子句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CONSTRAINT</span> <span class="hljs-operator">&lt;</span>完整性约束条件名<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>完整性约束条件<span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><p>例：建立学生登记表 Student，要求学号在 9000 ～ 99999 之间，姓名不能取空值，年龄小于 30，性别只能是“男”或“女”</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> Student<br>    (Sno <span class="hljs-type">NUMERIC</span>(<span class="hljs-number">6</span>)<br>        <span class="hljs-keyword">CONSTRAINT</span> C1 <span class="hljs-keyword">CHECK</span>(Sno <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">90000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">99999</span>)),<br>     Sname <span class="hljs-type">CHAR</span>(<span class="hljs-number">20</span>)<br>        <span class="hljs-keyword">CONSTRAINT</span> C2 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>     Sage <span class="hljs-type">NUMERIC</span>(<span class="hljs-number">3</span>)<br>        <span class="hljs-keyword">CONSTRAINT</span> C3 <span class="hljs-keyword">CHECK</span>(Sage<span class="hljs-operator">&lt;</span><span class="hljs-number">30</span>),<br>     Ssex <span class="hljs-type">CHAR</span>(<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">CONSTRAINT</span> C4 <span class="hljs-keyword">CHECK</span> (Ssex <span class="hljs-keyword">IN</span>(<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-string">&#x27;女&#x27;</span>))，<br>     <span class="hljs-keyword">CONSTRAINT</span> StudentKey <span class="hljs-keyword">PRIMARY</span> KEY(Sno)<br></code></pre></td></tr></table></figure><h3 id="5-4-2-修改表中的完整性限制">5.4.2 修改表中的完整性限制</h3><p>使用<code>ALTER TABLE</code>修改表中的完整性限制</p><p>例：去掉上例 Student 表中对性别的限制</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> Student<br>    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">CONSTRAINT</span> C4;<br></code></pre></td></tr></table></figure><p>修改约束条件需要先<code>DROP</code>原来的约束条件再<code>ADD</code>新约束条件</p><h2 id="5-5-触发器">5.5 触发器</h2><p>又叫作事件-条件-动作规则</p><h3 id="5-5-1-创建">5.5.1 创建</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TRIGGER</span> <span class="hljs-operator">&lt;</span>触发器名<span class="hljs-operator">&gt;</span><br>&#123;BEFORE<span class="hljs-operator">|</span>AFTER&#125; <span class="hljs-operator">&lt;</span>触发器事件<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span> <span class="hljs-comment">/*指明触发器激活的时间是在执行触发事件前或后*/</span><br><span class="hljs-keyword">REFERENCING</span> <span class="hljs-keyword">NEW</span><span class="hljs-operator">|</span><span class="hljs-keyword">OLD</span> <span class="hljs-type">ROW</span> <span class="hljs-keyword">AS</span> <span class="hljs-operator">&lt;</span>变量<span class="hljs-operator">&gt;</span>   <span class="hljs-comment">/*REFERENCING指出引用的变量*/</span><br><span class="hljs-keyword">FOR</span> <span class="hljs-keyword">EACH</span>&#123;<span class="hljs-type">ROW</span><span class="hljs-operator">|</span>STATEMENT&#125;            <span class="hljs-comment">/*定义触发器类型，行级触发器或语句级触发器*/</span><br>[<span class="hljs-keyword">WHEN</span> <span class="hljs-operator">&lt;</span>触发条件<span class="hljs-operator">&gt;</span>] <span class="hljs-operator">&lt;</span>触发动作体<span class="hljs-operator">&gt;</span>        <span class="hljs-comment">/*触发条件为真时才触发动作体*/</span><br></code></pre></td></tr></table></figure><p>同一表上多个触发器激活时遵循如下的执行顺序：</p><ol><li>执行该表上的 BEFORE 触发器</li><li>激活触发器的 SQL 语句</li><li>执行该表上的 AFTER 触发器</li></ol><h3 id="5-5-2-删除">5.5.2 删除</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TRIGGER</span> <span class="hljs-operator">&lt;</span>触发器名<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span>;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
      <tag>SQL语言</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH4 数据库安全性</title>
    <link href="/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E6%80%A7/"/>
    <url>/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<h1>第四章 数据库安全性</h1><h2 id="4-1-概述">4.1 概述</h2><p>数据库的安全性是指保护数据库以防止不合法使用所造成的数据泄露、更改和破坏</p><h3 id="4-1-1-不安全因素">4.1.1 不安全因素</h3><ul><li>非授权用户对数据库的恶意存取和破坏</li><li>数据库中重要或敏感的数据被泄露</li><li>安全环境的脆弱性</li></ul><h2 id="4-2-数据库安全性控制">4.2 数据库安全性控制</h2><h3 id="4-2-1-存取控制">4.2.1 存取控制</h3><p>主要包括定义用户权限和合法权限检查两部分</p><p>C2 级的数据库管理系统支持自主存取控制（DAC），B1 级的数据库管理系统支持强制存取控制（MAC）</p><ul><li><strong>自主存取控制</strong>中，用户对不同的数据对象有不同的存取权限，不同的用户对同一对象也有不同权限，而且用户还可将其拥有的存取权限转授给其他用户，<strong>自主存取控制非常灵活</strong></li><li><strong>强制存储控制</strong>中，每一个数据库对象被标一定的密级，每一个用户也被授予某一个级别的许可证，对任一对象只有具有合法许可证的用户才可以存取，<strong>强制存取控制相对严格</strong></li></ul><h3 id="4-2-2-自主存取控制">4.2.2 自主存取控制</h3><p><strong>大型数据库管理系统都支持自主存取控制</strong>，SQL 通过 GRANT 和 REVOKE 语句来实现</p><p>列权限包括 SELECT，REFERENCES，INSERT，UPDATE</p><ul><li>对列的<u>UPDATE 权限</u>指对于表中存在的某一列的值可以进行修改，当然在<strong>修改的过程中要遵守表在创建时定义的主码及其他约束</strong></li><li>列上的<u>INSERT 权限</u>指用户可以插入一个元组。<strong>在给用户授予列 INSERT 权限时，一定要包含主码的 INSERT 权限</strong>，否则用户的插入动作会因为主码为空而被拒绝。</li></ul><h3 id="4-2-3-授权">4.2.3 授权</h3><h4 id="4-2-3-1-GRANT">4.2.3.1 GRANT</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>对象名<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>对象名<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">TO</span> <span class="hljs-operator">&lt;</span>用户<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>用户<span class="hljs-operator">&gt;</span>]...  <span class="hljs-comment">/*用户可以是一个或多个，或PUBLIC即全体用户*/</span><br>[<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> OPTION]; <span class="hljs-comment">/*指定则获得某种权限的用户还可以把这个权限再授予其他用户*/</span><br></code></pre></td></tr></table></figure><p><strong>不允许循环授权！</strong></p><p>例：把对 Student 表和 Course 表的全部操作权限授予用户 U2 和 U3</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES<br><span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> Student,Course<br><span class="hljs-keyword">TO</span> U2,U3;<br></code></pre></td></tr></table></figure><p>例：把查询 Student 表和修改学生学号的权限授给用户 U4</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">UPDATE</span>(Sno),<span class="hljs-keyword">SELECT</span>    <span class="hljs-comment">/*对属性列授权时必须指定相应的属性列名*/</span><br><span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> Student<br><span class="hljs-keyword">TO</span> U4;<br></code></pre></td></tr></table></figure><h4 id="4-2-3-2-REVOKE">4.2.3.2 REVOKE</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span> <span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>对象名<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>对象名<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">FROM</span> <span class="hljs-operator">&lt;</span>用户<span class="hljs-operator">&gt;</span>[,[用户]]...[CASCADE<span class="hljs-operator">|</span>RESTRICT]<br></code></pre></td></tr></table></figure><ul><li><code>CASCADE</code>只收回直接或间接从该用户获取的权限的用户的该权限（意思是如果这个权限还有别的用户授予过来，那这个权限就不会被收回）</li></ul><h4 id="4-2-3-3-创建数据库模式的权限（创建用户）">4.2.3.3 创建数据库模式的权限（创建用户）</h4><p>GRANT 和 REVOKE 向用户授予或收回对数据的操作权限，对创建数据库模式一类的数据库对象的授权则由数据库管理员在创建用户时实现</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-operator">&lt;</span>username<span class="hljs-operator">&gt;</span> [<span class="hljs-keyword">WITH</span>][DBA<span class="hljs-operator">|</span>RESOURCE<span class="hljs-operator">|</span><span class="hljs-keyword">CONNECT</span>]<br></code></pre></td></tr></table></figure><p>只有系统的超级用户才有权创建一个新的数据库用户</p><table><thead><tr><th>拥有的权限</th><th>CREATE USER</th><th>CREATE SCHEMA</th><th>CREATE TABLE</th><th>登录数据库，执行数据查询和操纵</th></tr></thead><tbody><tr><td>DBA</td><td>可以</td><td>可以</td><td>可以</td><td>可以</td></tr><tr><td>RESOURCE</td><td>不可以</td><td>不可以</td><td>可以</td><td>可以</td></tr><tr><td>CONNECT</td><td>不可以</td><td>不可以</td><td>不可以</td><td>可以，但需拥有相应权限</td></tr></tbody></table><h3 id="4-2-4-数据库角色">4.2.4 数据库角色</h3><p>数据库角色是被命名的一组与数据库操作相关的权限，角色是权限的集合，<strong>相同权限通过角色来授权</strong></p><p>PUBLIC 角色自动获得所有默认权限，不可删除/指派<br>每个 DB 用户都是成员，每个 DB 都有 PUBLIC 角色</p><h4 id="4-2-4-1-角色创建">4.2.4.1 角色创建</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> ROLE <span class="hljs-operator">&lt;</span>角色名<span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4-2-4-2-给角色授权">4.2.4.2 给角色授权</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span>对象名<br><span class="hljs-keyword">TO</span> <span class="hljs-operator">&lt;</span>角色<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>角色<span class="hljs-operator">&gt;</span>]...<br></code></pre></td></tr></table></figure><h4 id="4-2-4-3-将一个角色授予其他的角色或用户">4.2.4.3 将一个角色授予其他的角色或用户</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-operator">&lt;</span>角色<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>角色<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">TO</span> <span class="hljs-operator">&lt;</span>角色<span class="hljs-number">3</span><span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>用户<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span>]...<br>[<span class="hljs-keyword">WITH</span> ADMIN OPTION] <span class="hljs-comment">/*指定则获得某种权限的角色和用户可以把这个权限再授予其他角色*/</span><br></code></pre></td></tr></table></figure><h4 id="4-2-4-4-角色权限的收回">4.2.4.4 角色权限的收回</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span> <span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>权限<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>对象类型<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>对象名<span class="hljs-operator">&gt;</span><br><span class="hljs-keyword">FROM</span> <span class="hljs-operator">&lt;</span>角色<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>角色<span class="hljs-operator">&gt;</span>]...<br></code></pre></td></tr></table></figure><hr><p><strong>例：通过角色实现将一组权限授予一个用户</strong></p><ol><li>首先创建一个角色 R1<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> ROLE R1;<br></code></pre></td></tr></table></figure></li><li>使角色 R1 拥有 Student 表的 SELECT、UPDATE、INSERT 权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>,<span class="hljs-keyword">UPDATE</span>,<span class="hljs-keyword">INSERT</span><br><span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> Student<br><span class="hljs-keyword">TO</span> R1;<br></code></pre></td></tr></table></figure></li><li>将这个角色授予王平，张明，使他们拥有角色 R1 所包含的全部权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> R1<br><span class="hljs-keyword">TO</span> 王平，张明;<br></code></pre></td></tr></table></figure></li><li>可以一次性通过 R1 来收回王平的三个权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span> R1<br><span class="hljs-keyword">FROM</span> 王平;<br></code></pre></td></tr></table></figure></li><li>角色权限的修改,使 R1 在原来的基础上增加了 DELETE 权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">DELETE</span><br><span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> Student<br><span class="hljs-keyword">TO</span> R1;<br></code></pre></td></tr></table></figure></li><li>角色权限的修改，使 R1 减少了 SELECT 权限<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">SELECT</span><br><span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> Student<br><span class="hljs-keyword">FROM</span> R1;<br></code></pre></td></tr></table></figure></li></ol><h3 id="4-2-5-强制存取控制">4.2.5 强制存取控制</h3><p>在强制存取控制中，数据库管理系统所管理的全部实体被分为主体和客体两大类</p><ul><li><strong>主体是系统中的活动实体</strong>，包括数据库管理系统所管理的实际用户和代表用户的各进程</li><li><strong>客体是系统中的被动实体</strong>，受主体操纵，包括文件、基本表、索引、视图等</li></ul><p><strong>对于主体和客体，数据库管理系统为它们每个实例（值）指派一个敏感度标记</strong>，主体称为许可证级别，客体称为密级</p><p>次序：绝密(TS) &gt;= 机密(S) &gt;= 可信© &gt;= 公开§</p><ul><li>规则 1: 主体 &gt;= 相应的客体，能读取</li><li>规则 2: 主体 &lt;= 相应的客体，能写</li></ul><blockquote><p>按照规则 2，用户可以为写入的数据对象赋予高于自己的许可证级别的密级，这样一旦数据被写入该用户自己也不能再读该数据对象，如果违反规则 2，可能把数据的密级从高流向低，造成数据的泄露<br>例如，某个 TS 密级的主体把一个密级为 TS 的数据恶意将为 P，然后写回，这样原来是 TS 密级的数据大家都可以读到了，造成了 TS 密级数据的泄露</p></blockquote><p><strong>实现强制存取控制时要首先实现自主存取控制（DAC），即<u>自主存取控制与强制存取控制共同构成数据库管理系统的安全机制</u></strong></p><h2 id="4-3-视图机制">4.3 视图机制</h2><p>通过视图机制把要保密的数据对无权存取的用户隐藏起来，提高安全性</p><p>例：建立计算机系学生的视图，把对该视图的 SELECT 权限授予王平，把该视图上的所有操作权限授予张明</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> CS_Student  <span class="hljs-comment">/*先建立视图，屏蔽计算机学生之外的数据*/</span><br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span>;<br><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>            <span class="hljs-comment">/*王平只能检索计算机系学生的数据*/</span><br><span class="hljs-keyword">ON</span> CS_Student<br><span class="hljs-keyword">TO</span> 王平;<br><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES    <span class="hljs-comment">/*张明有增删改查计算机系学生的所有权限*/</span><br><span class="hljs-keyword">ON</span> CS_Student<br><span class="hljs-keyword">TO</span> 张明;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
      <tag>SQL语言</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH3 SQL</title>
    <link href="/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%89%E7%AB%A0-SQL/"/>
    <url>/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%89%E7%AB%A0-SQL/</url>
    
    <content type="html"><![CDATA[<h1>第三章 关系数据库标准语言 SQL</h1><h2 id="3-1-SQL-动词">3.1 SQL 动词</h2><table><thead><tr><th>SQL 功能</th><th>动词</th></tr></thead><tbody><tr><td>数据查询</td><td>SELECT</td></tr><tr><td>数据定义</td><td>CREATE、DROP、ALTER</td></tr><tr><td>数据操纵</td><td>INSERT、UPDATE、DELETE</td></tr><tr><td>数据控制</td><td>GRANT、REVOKE</td></tr></tbody></table><h2 id="3-2-数据定义">3.2 数据定义</h2><h3 id="3-2-1-模式的定义和删除">3.2.1 模式的定义和删除</h3><h4 id="3-2-1-1-定义">3.2.1.1 定义</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> SCHEMA <span class="hljs-operator">&lt;</span>模式名<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">AUTHORIZATION</span> <span class="hljs-operator">&lt;</span>用户名<span class="hljs-operator">&gt;</span> [<span class="hljs-operator">&lt;</span>表定义子句<span class="hljs-operator">&gt;</span><span class="hljs-operator">|</span><span class="hljs-operator">&lt;</span>视图定义子句<span class="hljs-operator">&gt;</span><span class="hljs-operator">|</span><span class="hljs-operator">&lt;</span>授权定义子句<span class="hljs-operator">&gt;</span>];<br></code></pre></td></tr></table></figure><p>如果没有指定模式名，那么模式名隐含用户名</p><p><strong>例：为用户 ZHANG 创建一个模式 TEST，并在其中定义一个表 TAB1</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> SCHEMA TEST <span class="hljs-keyword">AUTHORIZATION</span> ZHANG  <span class="hljs-operator">/</span><span class="hljs-operator">/</span>创建模式<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> TAB1(                      <span class="hljs-operator">/</span><span class="hljs-operator">/</span>创建表<br>            COL1 <span class="hljs-type">INT</span>,<br>            COL2 <span class="hljs-type">CHAR</span>(<span class="hljs-number">20</span>)<br>            );<br></code></pre></td></tr></table></figure><h4 id="3-2-1-2-删除">3.2.1.2 删除</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> SCHEMA <span class="hljs-operator">&lt;</span>模式名<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>CASCADE<span class="hljs-operator">|</span>RESTRICT<span class="hljs-operator">&gt;</span>;<br></code></pre></td></tr></table></figure><ul><li><code>CASCADE</code> <strong>级联</strong>，表示删除模式时同时把该模式中所有数据库对象全部删除</li><li><code>RESTRICT</code> <strong>限制</strong>，如果该模式已经定义了下属的数据库对象（表、视图等），则拒绝该语句执行</li></ul><h3 id="3-2-2-基本表">3.2.2 基本表</h3><h4 id="3-2-2-1-定义">3.2.2.1 定义</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span> (<br>    <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>数据类型<span class="hljs-operator">&gt;</span> [列级完整性约束条件]<br>    [<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>数据类型<span class="hljs-operator">&gt;</span> [列级完整性约束条件]]<br>    ...<br>    [,<span class="hljs-operator">&lt;</span>表级完整性约束条件<span class="hljs-operator">&gt;</span>]);<br></code></pre></td></tr></table></figure><p><strong>例：建立学生选课表 SC</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> SC(<br>    Sno <span class="hljs-type">CHAR</span>(<span class="hljs-number">9</span>),<br>    Cno <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>),<br>    Grade <span class="hljs-type">SMALLINT</span>,     <span class="hljs-comment">/*短整数，2字节*/</span><br>    <span class="hljs-keyword">PRIMARY</span> KEY (Sno, Cno),<br>        <span class="hljs-comment">/*主码由两个属性构成，必须作为表级完整性进行定义*/</span><br>    <span class="hljs-keyword">FOREIGN</span> KEY (Sno) <span class="hljs-keyword">REFERENCES</span> Student(Sno),<br>        <span class="hljs-comment">/*表级完整性约束条件，Sno是外码，被参照表是Student*/</span><br>    <span class="hljs-keyword">FOREIGN</span> KEY (Cno) <span class="hljs-keyword">REFERENCES</span> Course(Cno)<br>        <span class="hljs-comment">/*表级完整性约束条件，Cno是外码，被参照表是Course*/</span><br>    );<br></code></pre></td></tr></table></figure><p><strong>数据类型</strong></p><table><thead><tr><th>数据类型</th><th>含义</th></tr></thead><tbody><tr><td>CHAR(n)</td><td>长度为 n 的定长字符串</td></tr><tr><td>VARCHAR(n)</td><td>最大长度为 n 的变长字符串</td></tr><tr><td>CLOB</td><td>字符串大对象</td></tr><tr><td>BLOB</td><td>二进制大对象</td></tr><tr><td>INT</td><td>长整数（4 字节）</td></tr><tr><td>SMALLINT</td><td>短整数（2 字节）</td></tr><tr><td>BIGINT</td><td>大整数（8 字节）</td></tr><tr><td>NUMERIC(p, d)</td><td>定点数，总共 p 位数字，小数点后 d 位数字</td></tr><tr><td>FLOAT(n)</td><td>精度至少为 n 位数字的浮点数</td></tr><tr><td>BOOLEAN</td><td>逻辑布尔量</td></tr><tr><td>DATE</td><td>日期，YYYY-MM-DD</td></tr><tr><td>TIME</td><td>时间，HH:MM:SS</td></tr><tr><td>TIMESTAMP</td><td>时间戳类型</td></tr></tbody></table><h4 id="3-2-2-2-修改">3.2.2.2 修改</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span><br>[<span class="hljs-keyword">ADD</span> [<span class="hljs-keyword">COLUMN</span>] <span class="hljs-operator">&lt;</span>新列名<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>数据类型<span class="hljs-operator">&gt;</span> [完整性约束]]<br>        <span class="hljs-comment">/*增加新列、新列级完整性*/</span><br>[<span class="hljs-keyword">ADD</span> <span class="hljs-operator">&lt;</span>表级完整性约束<span class="hljs-operator">&gt;</span>]<br>        <span class="hljs-comment">/*增加新的表完整性约束*/</span><br>[<span class="hljs-keyword">DROP</span> [<span class="hljs-keyword">COLUMN</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span> [CASCADE<span class="hljs-operator">|</span>RESTRICT]]<br>        <span class="hljs-comment">/*删除列。RESTRICT表示如果该列被其他对象引用则拒绝删除，CASCADE表示自动删除引用了该列的其他对象*/</span><br>[<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">CONSTRAINT</span> <span class="hljs-operator">&lt;</span>完整性约束名<span class="hljs-operator">&gt;</span> [RESTRICT<span class="hljs-operator">|</span>CASCADE]]<br>        <span class="hljs-comment">/*删除指定的完整型约束条件*/</span><br>[<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span> <span class="hljs-operator">&lt;</span>数据类型<span class="hljs-operator">&gt;</span>]<br>        <span class="hljs-comment">/*修改原有的列定义，包括修改列名和数据类型*/</span><br></code></pre></td></tr></table></figure><p><strong>例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*向Student表增加“S_entrance”列，数据类型为DATE*/</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> Student <span class="hljs-keyword">ADD</span> S_entrance <span class="hljs-type">DATE</span>;<br><br><span class="hljs-comment">/*将年龄(Sage)的数据类型由字符型改为整数*/</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> Student <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> Sage <span class="hljs-type">INT</span>;<br><br><span class="hljs-comment">/*增加课程名称(Cname)必须取唯一值的约束条件*/</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> Course <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">UNIQUE</span>(Cname);<br></code></pre></td></tr></table></figure><h4 id="3-2-2-3-删除">3.2.2.3 删除</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span> [RESTRICT<span class="hljs-operator">|</span>CASCADE];<br></code></pre></td></tr></table></figure><ul><li><code>RESTRICT</code>（默认情况）: 欲删除的基本表不能被其他表的约束所引用（如 CHECK，FOREIGN KEY 等），不能有视图，不能有触发器，不能有存储过程或函数</li><li><code>CASCADE</code> 删除没有限制，相关的依赖对象比如视图都会被删</li></ul><h3 id="3-2-3-索引">3.2.3 索引</h3><p>常见索引包括顺序文件上的索引、B+树索引，散列（hash）索引，位图索引</p><p>维护索引由 DBMS 自动完成</p><h4 id="3-2-3-1-建立">3.2.3.1 建立</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">UNIQUE</span>] [CLUSTER] INDEX <span class="hljs-operator">&lt;</span>索引名<span class="hljs-operator">&gt;</span><br><span class="hljs-keyword">ON</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span>(<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span> [<span class="hljs-operator">&lt;</span>次序<span class="hljs-operator">&gt;</span>] [,<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>[<span class="hljs-operator">&lt;</span>次序<span class="hljs-operator">&gt;</span>]]...)<br></code></pre></td></tr></table></figure><p>次序：ASC(升序，默认)，DESC(降序)</p><ul><li><code>UNIQUE</code> 此索引的每一个索引值只对应唯一的数据记录</li><li><code>CLUSTER</code> 表示要建立的索引是聚簇索引<ul><li>物理排序，在最常查询且少更新的列上进行</li><li>一个基本表最多一个聚簇索引</li></ul></li></ul><h4 id="3-2-3-2-修改">3.2.3.2 修改</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> INDEX <span class="hljs-operator">&lt;</span>旧索引名<span class="hljs-operator">&gt;</span> RENAME <span class="hljs-keyword">TO</span> <span class="hljs-operator">&lt;</span>新索引名<span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3-2-3-3-删除">3.2.3.3 删除</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> INDEX <span class="hljs-operator">&lt;</span>索引名<span class="hljs-operator">&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3-2-4-数据字典">3.2.4 数据字典</h3><p>关系数据库管理系统内部的一组系统表，记录了数据库中所有的定义信息。</p><p>执行 SQL 的数据定义语句时，实际上就是在跟新数据字典表中的相应信息，在进行查询优化和查询处理时，数据字典中的信是最重要的依据</p><h2 id="3-3-数据查询">3.3 数据查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">ALL</span><span class="hljs-operator">|</span><span class="hljs-keyword">DISTINCT</span>] <span class="hljs-operator">&lt;</span>目标列表达式<span class="hljs-operator">&gt;</span> [,<span class="hljs-operator">&lt;</span>目标列表达式<span class="hljs-operator">&gt;</span>]...<br><span class="hljs-keyword">FROM</span> <span class="hljs-operator">&lt;</span>表名或视图名<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>表名或视图名<span class="hljs-operator">&gt;</span>...]<span class="hljs-operator">|</span>(<span class="hljs-keyword">SELECT</span> 语句)[<span class="hljs-keyword">AS</span>]<span class="hljs-operator">&lt;</span>别名<span class="hljs-operator">&gt;</span><br>[<span class="hljs-keyword">WHERE</span> <span class="hljs-operator">&lt;</span>条件表达式<span class="hljs-operator">&gt;</span>]<br>[<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-operator">&lt;</span>列名<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span> [<span class="hljs-keyword">HAVING</span> <span class="hljs-operator">&lt;</span>条件表达式<span class="hljs-operator">&gt;</span>]]<br>[<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-operator">&lt;</span>列名<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span> [<span class="hljs-keyword">ASC</span><span class="hljs-operator">|</span><span class="hljs-keyword">DESC</span>]]<br></code></pre></td></tr></table></figure><ul><li>DISTINCT：取值唯一</li><li>GROUP BY：分组</li></ul><h3 id="3-3-1-单表查询">3.3.1 单表查询</h3><h4 id="3-3-1-1-选择表中若干列">3.3.1.1 选择表中若干列</h4><h5 id="3-3-1-1-1-查询指定列">3.3.1.1.1 查询指定列</h5><p><strong>例：查询全体学生的姓名、学号、所在系</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname,Sno,Sdept<br><span class="hljs-keyword">FROM</span> Student;<br></code></pre></td></tr></table></figure><h5 id="3-3-1-1-2-查询所有列">3.3.1.1.2 查询所有列</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student;<br></code></pre></td></tr></table></figure><h5 id="3-3-1-1-3-查询经过计算的值">3.3.1.1.3 查询经过计算的值</h5><p><strong>例：查询全体学生姓名及其出生年份</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname,<span class="hljs-number">2022</span><span class="hljs-operator">-</span>Sage  <span class="hljs-comment">/*&quot;2022-Sage&quot;是一个算数表达式*/</span><br><span class="hljs-keyword">FROM</span> Student;<br></code></pre></td></tr></table></figure><p><strong>目标列表达式还可以是字符串常量（整列都是那个常量），函数</strong></p><h5 id="3-3-1-1-4-通过指定别名来改变查询结果的列标题">3.3.1.1.4 通过指定别名来改变查询结果的列标题</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname NAME,<br>        <span class="hljs-string">&#x27;Year of Birth:&#x27;</span> BIRTH,<br>        <span class="hljs-number">2022</span><span class="hljs-operator">-</span>Sage BIRTHDAY,<br>        <span class="hljs-built_in">LOWER</span>(Sdept) DEPARTMENT <span class="hljs-comment">/*将Sdept改为小写*/</span><br><span class="hljs-keyword">FROM</span> Student;<br></code></pre></td></tr></table></figure><p>结果：</p><table><thead><tr><th>NAME</th><th>BIRTH</th><th>BIRTHDAY</th><th>DEPARTMENT</th></tr></thead><tbody><tr><td>李勇</td><td>Year of Birth:</td><td>1994</td><td>cs</td></tr></tbody></table><h4 id="3-3-1-2-选择表中若干元组">3.3.1.2 选择表中若干元组</h4><h5 id="3-3-1-2-1-消除取值重复的行-DISTINCT">3.3.1.2.1 消除取值重复的行 DISTINCT</h5><p>DISTINCT 作用范围是<u>所有目标列</u></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> Sno<br><span class="hljs-keyword">FROM</span> SC;<br></code></pre></td></tr></table></figure><h5 id="3-3-1-2-2-查询满足条件的元组-WHERE">3.3.1.2.2 查询满足条件的元组 WHERE</h5><ul><li><strong>比较大小</strong>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">!</mo><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">!&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span></span></span></span>（不大于），<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">!</mo><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">!&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span></span></span></span>(不小于)</li><li><strong>确定范围</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WHERE</span> Sage [<span class="hljs-keyword">NOT</span>] <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">20</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">30</span>; <span class="hljs-comment">/*包含边界*/</span><br></code></pre></td></tr></table></figure></li><li><strong>确定集合</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WHERE</span> Sdept [<span class="hljs-keyword">NOT</span>] <span class="hljs-keyword">IN</span> (<span class="hljs-string">&#x27;CS&#x27;</span>,<span class="hljs-string">&#x27;MA&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li><strong>字符匹配</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">[<span class="hljs-keyword">NOT</span>] <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;&lt;匹配串&gt;&#x27;</span> [<span class="hljs-keyword">ESCAPE</span><span class="hljs-string">&#x27;&lt;换码字符&gt;&#x27;</span>]<br></code></pre></td></tr></table></figure><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">%</span></span></span></span> 表示任意长度（长度可以为 0）的字符串</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">_</mi></mrow><annotation encoding="application/x-tex">\_</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;vertical-align:-0.31em;"></span><span class="mord" style="margin-right:0.02778em;">_</span></span></span></span> 表示单个字符</li><li><code>ESCAPE '&lt;换码字符&gt;'</code>对通配符进行转义<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WHERE</span> Cname <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;DB\_%i__&#x27;</span> <span class="hljs-keyword">ESCAPE</span> <span class="hljs-string">&#x27;\&#x27;</span><br></code></pre></td></tr></table></figure><code>\</code>为换码字符，第一个<code>_</code>为普通字符，后两个为通配符</li></ul></li><li><strong>涉及空值的查询</strong> <code>IS [NOT] NULL</code></li><li><strong>多重条件查询</strong> <code>AND</code> <code>OR</code><ul><li>AND 的优先级高于 OR，可以用括号</li></ul></li></ul><h4 id="3-3-1-3-ORDER-BY-子句">3.3.1.3 ORDER BY 子句</h4><p>对一个或多个属性列的升序或降序排列</p><p><strong>空值最大</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> Grade <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure><h4 id="3-3-1-4-聚集函数">3.3.1.4 聚集函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)                        <span class="hljs-comment">/*统计元组个数*/</span><br><span class="hljs-built_in">COUNT</span>([<span class="hljs-keyword">DISTINCT</span><span class="hljs-operator">|</span><span class="hljs-keyword">ALL</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>)     <span class="hljs-comment">/*统计一列中值的个数*/</span><br><span class="hljs-built_in">SUM</span> ([<span class="hljs-keyword">DISTINCT</span><span class="hljs-operator">|</span><span class="hljs-keyword">ALL</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>)      <span class="hljs-comment">/*总和（此列必须数值型）*/</span><br><span class="hljs-built_in">AVG</span> ([<span class="hljs-keyword">DISTINCT</span><span class="hljs-operator">|</span><span class="hljs-keyword">ALL</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>)      <span class="hljs-comment">/*平均值*/</span><br><span class="hljs-built_in">MAX</span> ([<span class="hljs-keyword">DISTINCT</span><span class="hljs-operator">|</span><span class="hljs-keyword">ALL</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>)      <span class="hljs-comment">/*最大值*/</span><br><span class="hljs-built_in">MIN</span> ([<span class="hljs-keyword">DISTINCT</span><span class="hljs-operator">|</span><span class="hljs-keyword">ALL</span>] <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>)      <span class="hljs-comment">/*最小值*/</span><br></code></pre></td></tr></table></figure><p><strong>除 COUNT(*)，都跳过空值只处理非空值</strong></p><p>WHERE 子句是不能用聚集函数做条件表达式的，<strong>聚集函数只能用于 SELECT 子句和 GROUP BY 中的 HAVING 子句</strong></p><h4 id="3-3-1-5-GROUP-BY-子句">3.3.1.5 GROUP BY 子句</h4><p><strong>例：求各个课程号及相应的选课人数</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Cno, <span class="hljs-built_in">COUNT</span>(Sno)<br><span class="hljs-keyword">FROM</span> SC<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Cno;<br></code></pre></td></tr></table></figure><p>结果</p><table><thead><tr><th>Cno</th><th>COUNT(Sno)</th></tr></thead><tbody><tr><td>1</td><td>22</td></tr><tr><td>2</td><td>34</td></tr></tbody></table><h5 id="3-3-1-5-1-用-HAVING-短语对组进行筛选">3.3.1.5.1 用 HAVING 短语对组进行筛选</h5><p><strong>WHERE</strong>与<strong>HAVING</strong>的区别：</p><ul><li><strong>WHERE</strong>作用于基本表或视图</li><li><strong>HAVING</strong>作用于组，从而选择满足条件的组（非属性约束）</li></ul><p><span style="color:red">下面语句是不对的：</span></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sno,<span class="hljs-built_in">AVG</span>(Grade)<br><span class="hljs-keyword">FROM</span> SC<br><span class="hljs-keyword">WHERE</span> <span class="hljs-built_in">AVG</span>(Grade)<span class="hljs-operator">&gt;=</span><span class="hljs-number">90</span>    <span class="hljs-comment">/*WHERE子句不能用聚集函数做条件表达式*/</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Sno;<br></code></pre></td></tr></table></figure><p>正确应是：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sno,<span class="hljs-built_in">AVG</span>(Grade)<br><span class="hljs-keyword">FROM</span> SC<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Sno<br><span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">AVG</span>(Grade)<span class="hljs-operator">&gt;=</span><span class="hljs-number">90</span>;<br></code></pre></td></tr></table></figure><h3 id="3-3-2-连接查询">3.3.2 连接查询</h3><h4 id="3-3-2-1-等值与非等值连接，自然连接">3.3.2.1 等值与非等值连接，自然连接</h4><p>运算符为<code>=</code>时为<strong>等值</strong>，其余为<strong>非等值</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Student.<span class="hljs-operator">*</span>,SC.<span class="hljs-operator">*</span>       <span class="hljs-comment">/*.*某表中的所有属性列*/</span><br><span class="hljs-keyword">FROM</span> Student,SC<br><span class="hljs-keyword">WHERE</span> Student.Sno<span class="hljs-operator">=</span>SC.Sno    <span class="hljs-comment">/*Student与 SC中同一学生的元组连接起来*/</span><br></code></pre></td></tr></table></figure><p><strong>自然连接</strong>：把目标列中重复的属性列去掉（两表中的 Sno 相同）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Student.Sno,Sname,Ssex,Sage,Sdept,Cno,Grade<br><span class="hljs-keyword">FROM</span> Student,SC<br><span class="hljs-keyword">WHERE</span> Student.Sno<span class="hljs-operator">=</span>SC.Sno<br></code></pre></td></tr></table></figure><h4 id="3-3-2-2-自身连接">3.3.2.2 自身连接</h4><p>为表取两个别名，<code>FIRST</code>和<code>SECOND</code></p><p><strong>例：对同一个表的 Cno 和 Cpno 连接</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> FIRST.Cno, SECOND.Cpno<br><span class="hljs-keyword">FROM</span> Course <span class="hljs-keyword">FIRST</span>, Course <span class="hljs-keyword">SECOND</span><br><span class="hljs-keyword">WHERE</span> FIRST.Cpno<span class="hljs-operator">=</span>SECOND.Cno;<br></code></pre></td></tr></table></figure><h4 id="3-3-2-3-外连接">3.3.2.3 外连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Student.Sno,Sname,Ssex,Sage,Sdept,Cno,Grade<br><span class="hljs-keyword">FROM</span> Student <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> SC <span class="hljs-keyword">ON</span>(Student.Sno<span class="hljs-operator">=</span>SC.Sno)<br><span class="hljs-comment">/*也可以用USING连接：FROM Student LEFT OUTER JOIN SC USING(Sno);*/</span><br></code></pre></td></tr></table></figure><ul><li>左外连接 <code>LEFT OUTER</code></li><li>右外连接 <code>RIGHT OUTER</code></li></ul><h4 id="3-3-2-4-多表连接">3.3.2.4 多表连接</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">WHERE</span> Student.Sno<span class="hljs-operator">=</span>SC.Sno <span class="hljs-keyword">AND</span> SC.Cno<span class="hljs-operator">=</span>Course.Cno<br></code></pre></td></tr></table></figure><h3 id="3-3-3-嵌套查询">3.3.3 嵌套查询</h3><h4 id="3-3-3-1-带有-IN-的子查询">3.3.3.1 带有 IN 的子查询</h4><p>子查询是个集合时</p><h4 id="3-3-3-2-带有比较运算符的子查询">3.3.3.2 带有比较运算符的子查询</h4><p>子查询返回单个值时</p><h4 id="3-3-3-3-带有-ANY（SOME）或-ALL-谓词的子查询">3.3.3.3 带有 ANY（SOME）或 ALL 谓词的子查询</h4><table><thead><tr><th>&gt; ANY</th><th>大于子查询结果某个值</th><th>等价于 &gt;MIN</th></tr></thead><tbody><tr><td>&gt; ALL</td><td>大于子查询结果所有值</td><td>等价于 &gt;MAX</td></tr><tr><td>&lt;ANY</td><td>小于子查询结果某个值</td><td>等价于 &lt;MAX</td></tr><tr><td>&lt; ALL</td><td>小于子查询结果所有值</td><td>等价于 &lt;MIN</td></tr><tr><td>&gt;= ANY</td><td>大于等于某个值</td><td></td></tr><tr><td>&gt;= ALL</td><td>大于等于所有值</td><td></td></tr><tr><td>&lt;= ANY</td><td>小于等于某个值</td><td></td></tr><tr><td>&lt;= ALL</td><td>小于等于所有值</td><td></td></tr><tr><td>= ANY</td><td>等于某个值</td><td>等价于 IN</td></tr><tr><td>= ALL</td><td>等于所有值（通常没有实际意义）</td><td></td></tr><tr><td>!= (&lt;&gt;) ANY</td><td>不等于某个值</td><td></td></tr><tr><td>!= (&lt;&gt;) ALL</td><td>不等于任何一个值</td><td>等价于 NOT IN</td></tr></tbody></table><p><strong>例：查询非计算机系中比计算机系任意一个学生年龄小的学生姓名和年龄</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname, Sage<br><span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sage<span class="hljs-operator">&lt;</span><span class="hljs-keyword">ANY</span>(<span class="hljs-keyword">SELECT</span> Sage          <span class="hljs-comment">/*子查询块*/</span><br>                <span class="hljs-keyword">FROM</span> Student        <span class="hljs-comment">/*查询计算机系所有学生的年龄*/</span><br>                <span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span>)<br><span class="hljs-keyword">AND</span> Sdept <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-string">&#x27;CS&#x27;</span>                   <span class="hljs-comment">/*父查询块中的条件*/</span><br></code></pre></td></tr></table></figure><h4 id="3-3-3-4-带有-EXISTS-谓词的子查询">3.3.3.4 带有 EXISTS 谓词的子查询</h4><p>若内层查询结果非空，则外层的 WHERE 子句返回真值，否则返回假值</p><p><code>NOT EXISTS</code>相反</p><p><strong>例：查询所有选修了 1 号课程的学生姓名</strong></p><blockquote><p>在 Student 中依次取每个元组的 Sno 值，用此值去检查 SC 表</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname<br><span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span><br>    (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> SC<br>    <span class="hljs-keyword">WHERE</span> Sno<span class="hljs-operator">=</span>Student.Sno <span class="hljs-keyword">AND</span> Cno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span>);<br></code></pre></td></tr></table></figure><p><strong>例：查询选修了全部课程的学生姓名（全称转换为存在）</strong></p><blockquote><p>SQL 中没有全称量词（for all），可将题目的意思转换成等价的用存在量词的形式<br>本题中，题目意思转换成：查询这样的学生，没有一门课程是他不选修的</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname<br><span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span><br>        (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Course<br>         <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span><br>                (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> SC<br>                 <span class="hljs-keyword">WHERE</span> Sno<span class="hljs-operator">=</span>Student.Sno<br>                    <span class="hljs-keyword">AND</span> Cno<span class="hljs-operator">=</span>Course.Cno));<br></code></pre></td></tr></table></figure><p><strong>例：查询至少选修了学生 201215122 选修的全部课程的学生号码（逻辑蕴涵转换为存在）</strong></p><blockquote><p>SQL 中没有蕴涵逻辑运算，蕴涵谓词转换<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>→</mo><mi>q</mi><mo>≡</mo><mi mathvariant="normal">¬</mi><mi>p</mi><mo>∨</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \to q\equiv \neg p\vee q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6582em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.1944em;"></span><span class="mord">¬</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p><p>分析：</p></blockquote><ul><li>本题语义为：查询学号为 x 的学号的学生，对所有课程 y，只要 201215122 学生选修了课程 y，则 x 也选修了 y。</li><li>形式化表示：<ul><li>p：“学生 201215122 选修了课程 y”</li><li>q：“学生 x 选修了课程 y”</li></ul></li><li>则上述查询为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">∃</mi><mi>y</mi><mo stretchy="false">)</mo><mi>p</mi><mo>→</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">(\exists y )p\to q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></li><li><span style="background-color:#C8D5F8"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="normal">∃</mi><mi>y</mi><mo stretchy="false">)</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo>≡</mo><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∃</mi><mi>y</mi><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi>p</mi><mo>→</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≡</mo><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi mathvariant="normal">∃</mi><mi>y</mi><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mi>p</mi><mo>∨</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>≡</mo><mi mathvariant="normal">¬</mi><mi mathvariant="normal">∃</mi><mi>y</mi><mo stretchy="false">(</mo><mi>p</mi><mo>∧</mo><mi mathvariant="normal">¬</mi><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\exists y)p \to q\equiv \neg (\exists y\neg (p\to q)) \equiv\neg(\exists y(\neg(\neg p \vee q)))\equiv \neg \exists y(p \wedge \neg q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6582em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mopen">(</span><span class="mord">∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">¬</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mopen">(</span><span class="mord">∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord">¬</span><span class="mopen">(</span><span class="mord">¬</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬∃</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span><span></li></ul><p>即：不存在这样的课程 y，学生 201215122 选修了 y，而学生 x 没有选</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> Sno<br><span class="hljs-keyword">FROM</span> SC SCX         <span class="hljs-comment">/*SC另称为SCX，以下同*/</span><br><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span><br>        (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> SC SCY       <span class="hljs-comment">/*查询课程表SC中201215122选修的全部课程*/</span><br>         <span class="hljs-keyword">WHERE</span> SCY.Sno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;201215122&#x27;</span><br>         <span class="hljs-keyword">AND</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span><br>                (<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> SC SCZ   <span class="hljs-comment">/*学生x选择了SCY筛选出来的即201215122学生学的课程*/</span><br>                 <span class="hljs-keyword">WHERE</span> SCZ.Sno<span class="hljs-operator">=</span>SCX.Sno<br>                 <span class="hljs-keyword">AND</span> SCZ.Cno<span class="hljs-operator">=</span>SCY.Cno))<br></code></pre></td></tr></table></figure><h3 id="3-3-4-集合查询">3.3.4 集合查询</h3><p>参加集合操作的各查询结果的列数必须相同；对应项的数据类型也必须相同</p><h4 id="3-3-4-1-UNION-并操作">3.3.4.1 UNION 并操作</h4><p><strong>例：查询计算机系的学生及年龄不大于 19 岁的学生</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span><br><span class="hljs-keyword">UNION</span>   <span class="hljs-comment">/*求并集*/</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sage<span class="hljs-operator">&lt;=</span><span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><p>UNION 会<strong>自动去掉重复元组</strong>，要保留重复元组则用<code>UNION ALL</code>操作符</p><h4 id="3-3-4-2-INTERSECT-交操作">3.3.4.2 INTERSECT 交操作</h4><p><strong>例：查询计算机系的学生与年龄不大于 19 岁的学生的交集</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span><br><span class="hljs-keyword">INTERSECT</span>   <span class="hljs-comment">/*求交集*/</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sage<span class="hljs-operator">&lt;=</span><span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><p>实际上就是查询计算机系年龄不大于 19 岁的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span><br>        <span class="hljs-keyword">AND</span> Sage<span class="hljs-operator">&lt;=</span><span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><h4 id="3-3-4-3-EXCEPT-差操作">3.3.4.3 EXCEPT 差操作</h4><p><strong>例：查询计算机系的学生与年龄不大于 19 岁的学生的差集</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span><br><span class="hljs-keyword">EXCEPT</span>      <span class="hljs-comment">/*求差集*/</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sage<span class="hljs-operator">&lt;=</span><span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><p>也就是查询计算机系中年龄大于 19 岁的学生</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span> <span class="hljs-keyword">AND</span> Sage<span class="hljs-operator">&gt;</span><span class="hljs-number">19</span>;<br></code></pre></td></tr></table></figure><hr><p>对集合操作结果的排序 <code>order by 1</code>(对第一列进行排序)，只能放在语句的最后</p><h3 id="3-3-5-基于派生表的查询">3.3.5 基于派生表的查询</h3><p>子查询出现在 FROM 子句中，生成临时派生表</p><p><strong>例：找出每个学生超过他自己选修课程平均成绩的课程号</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sno,Cno<br><span class="hljs-keyword">FROM</span> SC,(<span class="hljs-keyword">SELECT</span> Sno, <span class="hljs-built_in">AVG</span>(Grade) <span class="hljs-keyword">FROM</span> SC <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Sno)<br>        <span class="hljs-keyword">AS</span> Avg_sc(avg_sno, avg_grade)       <span class="hljs-comment">/*生成一个派生表Avg_sc，由avg_sno和avg_grade组成*/</span><br><span class="hljs-keyword">WHERE</span> SC.Sno<span class="hljs-operator">=</span>Avg_sc.avg_sno                 <span class="hljs-comment">/*按学号相等进行连接*/</span><br>        <span class="hljs-keyword">AND</span> SC.grade <span class="hljs-operator">&gt;=</span> Avg_sc.avg_grade    <span class="hljs-comment">/*选出修课成绩大于其平均成绩的课程号*/</span><br></code></pre></td></tr></table></figure><p>如果子查询中没有聚集函数，派生表可以不指定属性列</p><p><strong>例：查询所有选修了 1 号课程的学生姓名</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> Sname<br><span class="hljs-keyword">FROM</span> Student, (<span class="hljs-keyword">SELECT</span> Sno <span class="hljs-keyword">FROM</span> SC <span class="hljs-keyword">WHERE</span> Cno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span>) <span class="hljs-keyword">AS</span> SC1<br><span class="hljs-keyword">WHERE</span> Student.Sno<span class="hljs-operator">=</span>SC1.Sno;<br></code></pre></td></tr></table></figure><p>通过 FROM 子句生成派生表时。<strong><code>AS</code>关键字可省略，但必须为派生关系指定一个别名</strong></p><h2 id="3-4-数据更新">3.4 数据更新</h2><h3 id="3-4-1-插入数据">3.4.1 插入数据</h3><p>执行插入语句时会检查所插入元组是否破坏已定义的完整性</p><h4 id="3-4-1-1-插入元组">3.4.1.1 插入元组</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span><br><span class="hljs-keyword">INTO</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span>[(<span class="hljs-operator">&lt;</span>属性列<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span> [,<span class="hljs-operator">&lt;</span>属性列<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span>]...)]<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-operator">&lt;</span>常量<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>常量<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span>]...);<br></code></pre></td></tr></table></figure><ul><li>INTO 子句中没有出现的属性列，新元组在这些列上会取空值</li><li>表定义时说明了 NOT NULL 的属性列不能取空值否则会出错</li><li>INTO 子句没有指明任何属性列，则新插入的元组必须在每个属性列上均有值，且顺序要和 CREATE TABLE 中的次序相同</li><li>指明了的属性列的顺序可以和 CREATE TABLE 中的顺序不一样</li><li><strong>字符串常量要用<code>’‘</code>括起来</strong></li><li>明确空值<code>NULL</code></li></ul><p><strong>例：将学生张承敏的信息插入到 Student 表中</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span><br><span class="hljs-keyword">INTO</span> Student        <span class="hljs-comment">/*没有指定属性列，则每个属性都要有值*/</span><br><span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;201215126&#x27;</span>,<span class="hljs-string">&#x27;张成民&#x27;</span>,<span class="hljs-string">&#x27;男&#x27;</span>,<span class="hljs-number">18</span>,<span class="hljs-string">&#x27;CS&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="3-4-1-2-插入子查询结果（一次性插入多个元组）">3.4.1.2 插入子查询结果（一次性插入多个元组）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span><br><span class="hljs-keyword">INTO</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span> [<span class="hljs-operator">&lt;</span>属性列<span class="hljs-number">1</span><span class="hljs-operator">&gt;</span> [,<span class="hljs-operator">&lt;</span>属性列<span class="hljs-number">2</span><span class="hljs-operator">&gt;</span>...]]<br>子查询;<br></code></pre></td></tr></table></figure><p><strong>例：对每一个系求学生的平均年龄并把系名和平均年龄存入表中</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span><br><span class="hljs-keyword">INTO</span> Dept_age(Sdept,Avg_age)<br><span class="hljs-keyword">SELECT</span> Sdept,<span class="hljs-built_in">AVG</span>(age)<br><span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Sdept;         <span class="hljs-comment">/*按系分组求每个系的平均年龄*/</span><br></code></pre></td></tr></table></figure><h3 id="3-4-2-修改数据">3.4.2 修改数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span><br><span class="hljs-keyword">SET</span> <span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;=</span><span class="hljs-operator">&lt;</span>表达式<span class="hljs-operator">&gt;</span> [,<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;=</span><span class="hljs-operator">&lt;</span>表达式<span class="hljs-operator">&gt;</span>]...<br>[<span class="hljs-keyword">WHERE</span> <span class="hljs-operator">&lt;</span>条件<span class="hljs-operator">&gt;</span>];       <span class="hljs-comment">/*如果省略则表示要修改表中的所有元组*/</span><br></code></pre></td></tr></table></figure><h4 id="3-4-2-1-修改某一个元组的值">3.4.2.1 修改某一个元组的值</h4><p>例：将学生 201215121 的年龄改为 22 岁</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> Student<br><span class="hljs-keyword">SET</span> Sage<span class="hljs-operator">=</span><span class="hljs-number">22</span><br><span class="hljs-keyword">WHERE</span> Sno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;201215121&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="3-4-2-2-修改多个元组的值">3.4.2.2 修改多个元组的值</h4><p>例：将所有学生的年龄增加 1 岁</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> Student<br><span class="hljs-keyword">SET</span> Sage<span class="hljs-operator">=</span>Sage<span class="hljs-operator">+</span><span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><h4 id="3-4-2-3-带子查询的修改语句">3.4.2.3 带子查询的修改语句</h4><p>子查询嵌套在 UPDATE 语句中，用以构造修改的条件</p><p>例：将计算机系全体学生的成绩置零</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> SC<br><span class="hljs-keyword">SET</span> Grade<span class="hljs-operator">=</span><span class="hljs-number">0</span><br><span class="hljs-keyword">WHERE</span> Sno <span class="hljs-keyword">IN</span><br>        (<span class="hljs-keyword">SELECT</span> Sno<br>         <span class="hljs-keyword">FROM</span> Student<br>         <span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span>);<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">WHERE语句等同于：</span><br><span class="hljs-comment">WHERE &#x27;CS&#x27;=(SELECT Sdept FROM Student</span><br><span class="hljs-comment">            WHERE Student.Sno=SC.Sno);</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h3 id="3-4-3-删除数据">3.4.3 删除数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span><br><span class="hljs-keyword">FROM</span> <span class="hljs-operator">&lt;</span>表名<span class="hljs-operator">&gt;</span><br>[<span class="hljs-keyword">WHERE</span> <span class="hljs-operator">&lt;</span>条件<span class="hljs-operator">&gt;</span>];   <span class="hljs-comment">/*省略WHERE子句删除的是表中全部元组，但不删除表的定义*/</span><br></code></pre></td></tr></table></figure><h4 id="3-4-3-1-删除某一个元组的值">3.4.3.1 删除某一个元组的值</h4><p>例：删除学号为 201215128 的学生记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;201215128&#x27;</span>;<br></code></pre></td></tr></table></figure><h4 id="3-4-3-2-删除多个元组的值">3.4.3.2 删除多个元组的值</h4><p>例：删除所有学生的选课记录（SC 成为了空表）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> SC;<br></code></pre></td></tr></table></figure><h4 id="3-4-3-3-带子查询的删除语句">3.4.3.3 带子查询的删除语句</h4><p>例：删除计算机系所有学生的选课记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> SC<br><span class="hljs-keyword">WHERE</span> Sno <span class="hljs-keyword">IN</span><br>        (<span class="hljs-keyword">SELECT</span> Sno <span class="hljs-keyword">FROM</span> Student<br>         <span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CS&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="3-5-空值的处理">3.5 空值的处理</h2><p>判断：<code>IS NULL</code>、<code>IS NOT NULL</code></p><h3 id="3-5-1-空值的约束条件">3.5.1 空值的约束条件</h3><ul><li>属性定义中<strong>含有 NOT NULL</strong>的不能取空值</li><li>加了<strong>UNIQUE 限制</strong>的属性不能取空值</li><li><strong>码属性</strong>不能取空值</li></ul><h3 id="3-5-2-空值的算数运算，比较运算，逻辑运算">3.5.2 空值的算数运算，比较运算，逻辑运算</h3><ul><li>空值与另一个值（包括另一个空值）的<strong>算数运算</strong>结果为空值</li><li>空值与另一个值（包括另一个空值）的<strong>比较运算</strong>结果为 UNKNOWN</li><li>逻辑运算如下</li></ul><table><thead><tr><th style="text-align:center">x y</th><th style="text-align:center">x AND y</th><th style="text-align:center">x OR y</th><th style="text-align:center">NOT x</th></tr></thead><tbody><tr><td style="text-align:center">T U</td><td style="text-align:center">U</td><td style="text-align:center">T</td><td style="text-align:center">F</td></tr><tr><td style="text-align:center">U T</td><td style="text-align:center">U</td><td style="text-align:center">T</td><td style="text-align:center">U</td></tr><tr><td style="text-align:center">U U</td><td style="text-align:center">U</td><td style="text-align:center">U</td><td style="text-align:center">U</td></tr><tr><td style="text-align:center">U F</td><td style="text-align:center">F</td><td style="text-align:center">U</td><td style="text-align:center">U</td></tr><tr><td style="text-align:center">F U</td><td style="text-align:center">F</td><td style="text-align:center">U</td><td style="text-align:center">T</td></tr></tbody></table><h2 id="3-6-视图">3.6 视图</h2><h3 id="3-6-1-定义视图">3.6.1 定义视图</h3><h4 id="3-6-1-1-建立视图">3.6.1.1 建立视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> <span class="hljs-operator">&lt;</span>视图名<span class="hljs-operator">&gt;</span> [(<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>[,<span class="hljs-operator">&lt;</span>列名<span class="hljs-operator">&gt;</span>]...)]<br><span class="hljs-keyword">AS</span> <span class="hljs-operator">&lt;</span>子查询<span class="hljs-operator">&gt;</span>            <span class="hljs-comment">/*子查询可以是任意的SELECT语句*/</span><br>[<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">CHECK</span> OPTION]   <span class="hljs-comment">/*表示对视图进行UPDATE、INSERT、DELETE操作时要保证更新、插入</span><br><span class="hljs-comment">                        或删除的行满足视图定义中的谓词条件（即子查询中的条件表达式）*/</span><br></code></pre></td></tr></table></figure><p><strong>组成视图的属性列名或全部省略或全部指定</strong><br>在下列情况中必须明确指定组成视图的所有列名</p><ul><li>目标列是聚集函数或列表达式</li><li>多表连接时选出了几个同名列做视图的字段</li><li>在视图中为某个列启用新的更合适的名字</li></ul><p><strong>例：建立信息系学生的视图，并要求进行修改和插入操作时仍需保证该视图只有信息系的学生</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> IS_Student<br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">SELECT</span> Sno,Sname,Sage<br><span class="hljs-keyword">FROM</span> Student<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;IS&#x27;</span><br><span class="hljs-keyword">WITH</span> <span class="hljs-keyword">CHECK</span> OPTION;<br></code></pre></td></tr></table></figure><p>视图不仅可以建立在一个或多个基本表上，也可以建立在一个或多个已定义好的视图上，或建立在基本表与视图上</p><p><strong>例：建立信息系选修了 1 号课程的学生的视图（包括学号、姓名、成绩）</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> IS_S1(Sno,Sname,Grade)<br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">SELECT</span> Student.Sno,Sname,Grade<br><span class="hljs-keyword">FROM</span> Student,SC<br><span class="hljs-keyword">WHERE</span> Sdept<span class="hljs-operator">=</span><span class="hljs-string">&#x27;IS&#x27;</span> <span class="hljs-keyword">AND</span><br>      Student.Sno<span class="hljs-operator">=</span>SC.Sno <span class="hljs-keyword">AND</span>    <span class="hljs-comment">/*对Student和SC进行连接*/</span><br>      SC.Cno<span class="hljs-operator">=</span><span class="hljs-string">&#x27;1&#x27;</span>;<br></code></pre></td></tr></table></figure><p>可以用带有虚拟列（表达式）、聚集函数、GROUP BY 子句的查询来定义视图</p><p><strong>例：将学生学号及平均成绩定义为一个视图</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> S_G(Sno,Gavg)<br><span class="hljs-keyword">AS</span><br><span class="hljs-keyword">SELECT</span> Sno,<span class="hljs-built_in">AVG</span>(Grade)<br><span class="hljs-keyword">FROM</span> SC<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> Sno;<br></code></pre></td></tr></table></figure><h4 id="3-6-1-2-删除视图">3.6.1.2 删除视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">VIEW</span> <span class="hljs-operator">&lt;</span>视图名<span class="hljs-operator">&gt;</span> [CASCADE]<br><span class="hljs-comment">/*如果该视图还导出其他视图，CASCADE级联删除该视图以及由他导出的子图*/</span><br></code></pre></td></tr></table></figure><h3 id="3-6-2-查询视图">3.6.2 查询视图</h3><p>大部分情况与基本表相同</p><blockquote><p>由于 WHERE 子句中不能用聚集函数作为条件表达式，对于 WHERE 子句中带有聚集函数的视图的查询很可能出错，一般不使用视图而是使用基本表查询</p></blockquote><h3 id="3-6-3-更新视图">3.6.3 更新视图</h3><p>由于视图是不实际存储数据的虚表，因此对视图的更新最终要转换为对基本表的更新</p><p>在定义视图时加上<code>WITH CHECK OPTION</code>子句，在视图上增删改数据时关系数据库管理系统会检查视图定义中的条件，不满足条件则拒绝执行该操作</p><ul><li><strong>不可更新的视图：</strong> 并不是所有视图都是可更新的，例如视图中有平均成绩这一列，是由成绩表的成绩计算而来，想要修改平均成绩为 90，但是不可能修改成绩表的成绩使得平均成绩为 90，此时视图就是不可更新的。</li><li><strong>不允许更新的视图：</strong> 与不可更新的视图不同的是，前者是理论上证明其不可更新，后者指实际系统不支持其更新，但其本身可能可以更新</li></ul>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
      <tag>关系数据库标准语言SQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH2 关系数据库</title>
    <link href="/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <url>/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1>第二章 关系数据库</h1><p>典型商用数据库 ORACLE</p><p>关系模型由以下组成：</p><ul><li>关系数据结构：数据的表示（静态特性）</li><li>关系操作集合：基于关系运算</li><li>关系完整性约束：语义有效合理，允许定义</li></ul><h2 id="2-1-关系数据结构及形式化定义">2.1 关系数据结构及形式化定义</h2><h3 id="2-1-1-关系">2.1.1 关系</h3><ul><li><p><strong>域</strong></p><ul><li>一组具有相同数据类型的值的集合</li><li>一个域允许的不同取值个数称为这个域的基数</li></ul></li><li><p><strong>笛卡尔积</strong><br><img src="https://img-blog.csdnimg.cn/19d93f059fcc468d87d0c64088f9892e.jpeg#pic_center" alt=""></p></li><li><p><strong>关系</strong></p><ul><li>关系是笛卡尔积的有限子集<ul><li>笛卡尔积不满足交换律，关系满足（每列附加一个属性名取消有序性）</li></ul></li></ul></li></ul><h4 id="2-1-1-1-候选码">2.1.1.1 候选码</h4><p>某一属性组的值能唯一的标识一个元组，而其所有子集不能（是最小属性的集合），则称该属性组为<strong>候选码</strong></p><ul><li><strong>主码</strong><ul><li>若一个关系有多个候选码，则选定其中一个为主码</li></ul></li><li><strong>主属性</strong><ul><li>候选码的所有属性称为主属性，<u>不包含在任何候选码</u>的属性称为<strong>非主属性</strong></li></ul></li><li><strong>全码</strong><ul><li><u>关系模式的所有属性</u>是这个关系模式的候选码</li></ul></li></ul><h4 id="2-1-1-2-三种类型">2.1.1.2 三种类型</h4><ul><li><strong>基本关系</strong>（默认）<ul><li>通常又称基本表</li><li>实际存在的表，是实际存储数据的逻辑表示</li></ul></li><li><strong>查询表</strong><ul><li>查询结果对应的表</li></ul></li><li><strong>视图表</strong><ul><li>由基本表或其他视图表导出的表，是虚表，不对应实际存储的数据</li></ul></li></ul><h4 id="2-1-1-3-基本关系的-6-条性质">2.1.1.3 基本关系的 6 条性质</h4><ul><li>列是同质的，每一列中的分量是同一类型的数据，来自同一个域</li><li>不同的列可出自同一个域</li><li>列的次序可以任意交换</li><li>任意两个元组的候选码不能取相同的值（候选码唯一标识一条元组）</li><li>行的次序可以任意交换</li><li>分量必须取原子值，即每一个分量必须是不可分的数据项（最基本）<ul><li>规范化的关系简称为<strong>范式</strong></li></ul></li></ul><h3 id="2-1-2-关系模式">2.1.2 关系模式</h3><p>关系模式是对关系的描述</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>U</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mi>D</mi><mi>O</mi><mi>M</mi><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(U, D, DOM, F)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.10903em;">OM</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mclose">)</span></span></span></span></span></p><ul><li><strong>R：</strong> 关系名</li><li><strong>U：</strong> 组成该关系的属性名集合，如（学号，姓名。。。）</li><li><strong>D：</strong> U 中属性所来自的域</li><li><strong>DOM：</strong> 属性向域的映像集合</li><li><strong>F：</strong> 属性间数据的依赖关系集合</li></ul><p>关系是关系模式在某一时刻的状态或内容。</p><p>关系模式是<strong>静态的，稳定的</strong>，关系是<strong>动态的，随时间不断变化的</strong>，因为关系操作不断的更新着数据库中的数据</p><h2 id="2-2-关系的完整性">2.2 关系的完整性</h2><p>关系的两个不变性：实体完整性，参照完整性</p><p>保证数据正确（数据库内数据间的相容性和正确性）</p><h3 id="2-2-1-实体完整性">2.2.1 实体完整性</h3><p><strong>所有码不能取空值</strong></p><h3 id="2-2-2-参照完整性">2.2.2 参照完整性</h3><p><strong>外码或者取空值或者等于 S 中某个元组的主码值</strong></p><p><strong>外码</strong>：在所在的关系并不是码，但与其他关系有对应关系</p><ul><li><strong>外码属性可以为空</strong>：还未给外码赋值时</li><li><strong>外码属性不可以为空</strong>：外码是主码的一部分，外码被用户定义不能为空</li></ul><h2 id="2-3-集合运算">2.3 集合运算</h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">t \in R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> ：t 是 R 的一个元组<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(A_{1}, A_{2}, ..., A_{n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> ：</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">[</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t[A_{i}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 元组 t 的一个分量</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo stretchy="false">[</mo><mi>A</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t[A]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal">A</span><span class="mclose">]</span></span></span></span> 元组 t 的分量集合</li></ul><p>集合运算：</p><ul><li>并</li><li>交</li><li>差</li><li>笛卡尔积</li></ul><h2 id="2-4-关系运算">2.4 关系运算</h2><p><strong>象集</strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">Z_{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ：R 中属性组 X 上值为 x 的诸元组在 Z 上分量的集合<br>下表中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><msub><mi>x</mi><mn>1</mn></msub></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>Z</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>Z</mi><mn>3</mn></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">Z_{x_{1}} = \{Z_{1}, Z_{2}, Z_{3}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></p><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Z_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">Z_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Z_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr><tr><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td><td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">Z_{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td></tr></tbody></table><h3 id="2-4-1-选择">2.4.1 选择</h3><p><span style="background-color:#C8D5F8">$$\sigma_{F}® = { t\mid t \in R \wedge F(t)=‘真’}$$</span></p><p>F 表示选择条件，基本形式为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mi>θ</mi><msub><mi>Y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">X_{1}\theta Y_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>表示比较运算符，可以是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span></span></span></span> ,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span>等</p><p>实际上是<strong>从关系 R 中选取使逻辑表达式 F 为真的元组</strong>，是从<strong>行角度</strong>进行的运算</p><h3 id="2-4-2-投影">2.4.2 投影</h3><p><span style="background-color:#C8D5F8">$$\Pi_{A}® = { t[A]\mid t \in R }$$</span></p><p>是<strong>从列角度进行的运算</strong></p><p>投影之后不仅取消了原关系中的某些列，<u>还可能取消某些元组</u>，因为取消了某些属性列之后就可能出现重复行，应取消这些完全相同的行</p><h3 id="2-4-3-连接">2.4.3 连接</h3><p>选取属性间满足一定条件的元组</p><p><span style="background-color:#C8D5F8">$$R\Join_{A \theta B}S = { \widehat{t_{r}t_{s}}\mid t_{r} \in R \wedge t_{s} \in S \wedge t_{r}[A]\theta t_{s}[B] } $$</span></p><p>A 和 B 分别为 R 和 S 上列数相等且可比的属性组</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>为“=”的连接运算称为<strong>等值连接</strong></p><p><strong>自然连接</strong>：特殊的等值连接，要求两个关系中进行比较的分量必须是同名的属性组，并且在结果中把重复的属性列去掉</p><p><strong>同时从行和列的角度进行运算</strong></p><h3 id="2-4-4-除运算-div">2.4.4 除运算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>÷</mo></mrow><annotation encoding="application/x-tex">\div</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">÷</span></span></span></span></h3><p>蕴涵问题</p><p>选择元组，投影到属性<br><img src="https://img-blog.csdnimg.cn/b1c794ead46b412981fa30cf0f121463.jpeg#pic_center" alt=""></p>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CH1 绪论</title>
    <link href="/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%BB%AA%E8%AE%BA/"/>
    <url>/2022/12/05/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%BB%AA%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<h1>第一章 绪论</h1><h2 id="1-1-数据库系统概述">1.1 数据库系统概述</h2><h3 id="1-1-1-数据">1.1.1 数据</h3><ul><li><strong>数据</strong>是<u>数据库中存储的基本对象</u>，描述事物的符号记录称为数据，有多种表现形式</li><li><strong>特点：</strong> <u>数据的含义称为数据的语义</u>，数据与其语义是不可分的，信息是对数据语义的解释</li></ul><h3 id="1-1-2-数据处理与管理的区别">1.1.2 数据处理与管理的区别</h3><p><strong>数据处理：</strong> 从某些已知的数据推导加工新的数据<br><strong>数据管理：</strong> 对数据收集、整理、组织、存储、维护、检索、传送等操作</p><h3 id="1-1-3-数据库">1.1.3 数据库</h3><p>  <strong>数据库</strong>是<strong>长期存储在计算机内、有组织的、可共享的大量数据的集合。</strong> 数据库中的数据按一定的数据模型组织、描述和储存，具有<u>较小的冗余度，较高的数据独立性和易扩展性</u>（降低更新维护的代价），并可为各种用户共享。</p><h3 id="1-1-4-数据库管理系统-系统软件">1.1.4 数据库管理系统 - 系统软件</h3><p><strong>是位于用户与操作系统之间的一层数据管理软件</strong></p><p>与操作系统一样是计算机的基础软件</p><h4 id="1-1-4-1-功能">1.1.4.1 功能</h4><ul><li><strong>数据定义功能：</strong> 提供数据定义语言（DDL），定义数据库中的数据对象</li><li><strong>数据组织、存储和管理：</strong> 基本目标是<u>提高存储空间利用率和方便存取</u>，提供多种存取方法（索引查找，hash 查找，顺序查找）来提高存取效率</li><li><strong>数据操纵功能：</strong> 提供数据操纵语言（DML），基本操作：增删改查</li><li><strong>数据库的事务管理和运行管理：</strong> 在建立、运用和维护的时候统一管理和控制，保证事务的正确运行，发生故障后的系统恢复</li><li><strong>数据库的建立和维护功能：</strong> 初始数据的输入、转换功能，数据库的转储、恢复功能，数据库的重组织功能和性能监视、分析功能等。</li></ul><h3 id="1-1-5-数据库系统-应用系统">1.1.5 数据库系统 - 应用系统</h3><p><strong>数据库</strong>是<u>由数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员（DBA）组成</u>的<strong>存储、管理、处理和维护数据</strong>的系统</p><h3 id="1-1-6-数据管理技术等产生和发展">1.1.6 数据管理技术等产生和发展</h3><p>三个阶段</p><table><thead><tr><th></th><th>人工管理阶段</th><th>文件系统阶段</th><th>数据库系统阶段</th></tr></thead><tbody><tr><td>软件背景</td><td>没有操作系统</td><td>有文件系统</td><td>有数据库管理系统（DBMS）</td></tr><tr><td>处理方式</td><td>批处理</td><td>联机实时处理、批处理</td><td>联机实时处理、分布处理、批处理</td></tr><tr><td>数据库的管理者</td><td>用户（程序员）</td><td>文件系统</td><td>数据库管理系统</td></tr><tr><td>数据的共享程度</td><td>无共享，冗余度极大</td><td>共享性差，冗余度大</td><td>共享性高，冗余度小</td></tr><tr><td>数据的独立性</td><td>不独立，完全依赖于程序</td><td>独立性差，数据逻辑结构改变要修改应用程序</td><td>具有高度的物理独立性和一定的逻辑独立性</td></tr><tr><td>数据的结构化</td><td>无结构</td><td>记录内有结构，整体无结构</td><td>整体结构化，用数据模型描述</td></tr><tr><td>数据控制能力</td><td>应用程序自己控制</td><td>应用程序自己控制</td><td>由数据库管理系统提供数据安全性、完整性、并发控制能力和恢复能力</td></tr></tbody></table><h3 id="1-1-7-数据库系统特点">1.1.7 数据库系统特点</h3><ul><li><strong>数据结构化：</strong><ul><li>主要特征，也是数据库系统与文件系统的本质区别</li><li><strong>整体结构化：</strong><ul><li>数据库中的数据不再仅仅针对某一个应用，而是面向整个组织或企业</li><li>不仅数据内部是结构化的，而且整体是结构化的，数据之间是有联系的</li></ul></li><li>数据结构用数据模型描述，无需程序定义和解释</li><li>数据可变长，最小单位数据项</li></ul></li><li><strong>数据的共享性高、冗余度低且易扩充：</strong><ul><li><strong>数据共享的好处</strong><ul><li>大大减少数据冗余，节约存储空间</li><li>避免数据之间的不相容性与不一致性</li><li>使数据库系统弹性大，易于扩充</li></ul></li></ul></li><li><strong>数据独立性高：</strong><ul><li><strong>物理独立性：</strong> 用户的应用程序与数据库中数据的物理存储是相互独立的<ul><li>物理存储改变时应用程序不用改变</li></ul></li><li><strong>逻辑独立性：</strong> 用户的应用程序与数据库的逻辑结构是相互独立的<ul><li>逻辑结构改变时用户程序也可以不变</li></ul></li><li>由数据库管理系统提供的二级映像功能保证</li></ul></li><li><strong>数据由数据库管理系统统一管理和控制：</strong> 数据控制功能<ul><li><strong>数据的安全性保护</strong>（主动安全机制-防外部入侵）<ul><li>保护数据以防止不合法使用造成的数据泄密和破坏</li></ul></li><li><strong>数据的完整性检查</strong>（被动安全机制-防内部误操作）<ul><li>完整性指数据的正确性、有效性和相容性，将数据控制在有效范围内</li></ul></li><li><strong>并发控制</strong><ul><li>对并发操作加以协调和控制</li></ul></li><li><strong>数据库恢复</strong></li></ul></li></ul><h4 id="1-1-7-1-数据库系统的优势">1.1.7.1 数据库系统的优势</h4><p>使信息系统从以加工数据的程序为中心转向围绕共享的数据库为中心的阶段</p><ul><li>提高了数据的利用率和相容性</li><li>简化应用程序的研制和维护</li><li>便于数据的集中管理</li></ul><h2 id="1-2-数据模型">1.2 数据模型</h2><p><u>数据模型是对现实世界数据特征的抽象</u>，现实世界用数据模型来抽象、表示和处理。</p><p><strong>数据模型是数据库系统的核心和基础</strong></p><p>根据模型应用的不同目的划分：</p><ul><li><strong>概念模型</strong><ul><li>也称信息模型，按用户的观点对数据和信息建模，主要用于数据库设计</li></ul></li><li><strong>逻辑模型和物理模型</strong> - <strong>逻辑模型：</strong> 按计算机系统的观点对数据建模，主要用于数据库管理系统的实现 - <strong>物理模型：</strong> 数据最底层的抽象，具体是现实数据库管理系统的任务<br><img src="/img/post/16700603684573.jpg" alt=""></li></ul><h3 id="1-2-1-概念模型">1.2.1 概念模型</h3><p>信息世界中的基本概念：</p><ul><li><strong>实体</strong><ul><li>客观存在并可相互区别的事物</li></ul></li><li><strong>属性</strong><ul><li>实体所具有的某一特性称为属性</li><li>若干属性的聚集组成了实体</li><li>属性不能再具有需要描述的性质</li><li>属性不能与其他实体具有联系</li></ul></li><li><strong>域</strong>（domain）<ul><li>属性的取值范围称为该属性的域</li></ul></li><li><strong>码</strong><ul><li>唯一标识实体的属性集称为码（键）</li><li>码是实体属性集的子集</li></ul></li><li><strong>实体型</strong> （class）<ul><li>用实体名及其属性名集合来抽象和刻画同类实体，称为实体型</li></ul></li><li><strong>实体集</strong>（Array/Set）<ul><li>同一类型实体的集合称为实体集</li></ul></li><li><strong>联系</strong><ul><li>实体（型）内部的联系和实体（型）之间的联系</li><li>有一对一，一对多和多对多</li></ul></li></ul><h4 id="1-2-1-1-表示方法">1.2.1.1 表示方法</h4><p>E-R 图</p><h3 id="1-2-2-数据模型组成要素（背）">1.2.2 数据模型组成要素（背）</h3><ul><li><strong>数据结构</strong><ul><li>描述数据库的组成对象以及对象之间的联系</li><li>是所描述的对象类型的集合，是对系统<strong>静态特性</strong>的描述</li></ul></li><li><strong>数据操作</strong><ul><li>对数据库中各种对象（型）的实例（值）允许执行的操作的集合，包括操作及有关的操作规则</li><li>主要有<strong>查询</strong>和<strong>更新</strong>（包括插入、删除、修改）两大类操作</li><li>是对系统<strong>动态特性</strong>的描述</li></ul></li><li><strong>数据的完整性约束条件</strong><ul><li>是一组完整性规则</li><li>制约和依存规则，保证数据的正确、有效和相容</li></ul></li></ul><h3 id="1-2-3-常用的数据模型">1.2.3 常用的数据模型</h3><ul><li>非关系模型<ul><li><strong>层次模型：</strong> 用树形结构表示各类实体以及实体之间的联系<ul><li>结构简单清晰，查询效率最高</li><li>性能优于关系数据库，不低于网状数据库</li><li>提供了良好的完整性支持</li><li>多对多联系无法用层次模型直接表示</li></ul></li><li><strong>网状模型</strong><ul><li>直接描述现实世界，存取效率较高</li><li>结构比较复杂；不容易掌握，不容易使用</li></ul></li></ul></li><li>关系模型</li><li>面向对象数据模型</li></ul><h4 id="1-2-3-1-关系模型">1.2.3.1 关系模型</h4><p>数据结构：</p><ul><li><strong>关系：</strong> 一个关系对应通常说的一张表</li><li><strong>元组：</strong> 表中的一行即为一个元组</li><li><strong>属性：</strong> 表中的一列即为一个属性</li><li><strong>码：</strong> 可以唯一确定一个元组</li><li><strong>域：</strong> 域是一组具有相同数据类型的值的集合</li><li><strong>分量：</strong> 元组中的一个属性值</li><li><strong>关系模式：</strong> 对关系的描述，一般表示为：关系名（属性 1，属性 2…）</li></ul><p>关系模型要求关系必须是规范化的，关系的每一个分量必须是一个不可分的数据项（不允许表中还有表）</p><p>数据操纵：查询、插入、删除、更新</p><p>完整性约束条件：实体完整性（实体可区分（码））、参照完整性（分量存在）、用户定义的完整性（业务逻辑需要）</p><p>优缺点：</p><ul><li>建立在严格的数学概念</li><li>概念单一，所以数据结构简单清晰</li><li>存取路径对用户透明，所以具有更高的数据独立性、更好的安全保密性</li><li>查询效率往往不如格式化数据模型，增加了开发数据库管理系统的难度</li></ul><h2 id="1-3-数据库系统模式">1.3 数据库系统模式</h2><h3 id="1-3-1-三级模式结构">1.3.1 三级模式结构</h3><p><img src="/img/post/16700710079279.jpg" alt=""></p><h4 id="1-3-1-1-模式">1.3.1.1 模式</h4><p>也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图</p><p>实际上是数据库数据在逻辑集上的视图</p><p><strong>一个数据库只有一个模式</strong></p><p>提供<strong>模式数据定义语言（模式 DDL）</strong> 来严格地定义模式，定义逻辑结构，联系，安全性，完整性要求</p><h4 id="1-3-1-2-外模式">1.3.1.2 外模式</h4><p>面向具体应用</p><p>也称子模式或用户模式，是数据库用户能够看见和使用的<strong>局部数据结构和特征的描述</strong>，<u>是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示</u></p><p>通常是模式的子集，一个数据库可以有多个外模式。结构、类型、长度、保密级别等都可以不同</p><p>是保证数据库安全性的一个有力措施</p><p>提供<strong>外模式数据定义语言（外模式 DDL）</strong> 来严格定义外模式</p><h4 id="1-3-1-3-内模式">1.3.1.3 内模式</h4><p>也称存储模式</p><p><strong>一个数据库只有一个内模式</strong></p><p>是数据<strong>物理结构和存储方式的描述</strong>，是数据在数据库内部的<u>组织方式</u></p><h3 id="1-3-2-二级映像功能">1.3.2 二级映像功能</h3><p><img src="/img/post/16700725337253.jpg" alt=""></p><h4 id="1-3-2-1-外模式-模式映像-逻辑独立性">1.3.2.1 外模式/模式映像 -&gt; 逻辑独立性</h4><p><strong>视图级抽象</strong></p><p>描述的是数据的局部逻辑结构</p><h4 id="1-3-2-2-模式-内模式映像-物理独立性">1.3.2.2 模式/内模式映像 -&gt; 物理独立性</h4><p>模式 - 概念级抽象<br>内模式 - 物理级抽象</p>]]></content>
    
    
    <categories>
      
      <category>数据库</category>
      
    </categories>
    
    
    <tags>
      
      <tag>数据库</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>python爬虫实践复习</title>
    <link href="/2022/12/01/python%E7%88%AC%E8%99%AB%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0/"/>
    <url>/2022/12/01/python%E7%88%AC%E8%99%AB%E5%AE%9E%E8%B7%B5%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>简答题</h1><h2 id="总结-selenium-的特点">总结 selenium 的特点</h2><ul><li>开源、免费</li><li>跨平台：Linux,windows,MAC, Solaris</li><li>支持多浏览器：chrome, IE, firefox, Edge, Oprea</li><li>支持多语言：C#, Java, Perl, PHP, Python, Ruby</li></ul><h2 id="selenium-常用-API">selenium 常用 API</h2><h3 id="元素定位">元素定位</h3><p><strong>定位方法：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># selenium 4.x 版本使用：</span><br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.xxx, xxx)<br></code></pre></td></tr></table></figure><h4 id="id-定位">id 定位</h4><p>通过 id 属性来定位元素</p><blockquote><p>HTML 规定 id 属性在整个 HTML 文档中必须是唯一的</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.ID, <span class="hljs-built_in">id</span>)<br></code></pre></td></tr></table></figure><h4 id="name-定位">name 定位</h4><p>以 name 属性定位</p><blockquote><p>HTML 文档中 name 属性值可以重复</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.NAME, name)<br></code></pre></td></tr></table></figure><h4 id="class-name-定位">class_name 定位</h4><p>根据元素 class 属性定位</p><blockquote><p>HTML 通过使用 class 来定义元素的样式</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.CLASS_NAME, class_name)<br></code></pre></td></tr></table></figure><h4 id="tag-name-定位">tag_name 定位</h4><p>通过标签名定位</p><blockquote><p>HTML 本质是由不同 tag 组成，每一个 tag 会在页面中存在多个，所以不方便进行精确定位，一般很少使用</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.TAG_NAME, tag_name)<br></code></pre></td></tr></table></figure><h4 id="link-text-定位">link_text 定位</h4><p>专门用来定位超链接元素<code>&lt;a&gt;标签&lt;/a&gt;</code>，并且是通过超链接的文本内容来定位元素</p><blockquote><p>link_text 为超链接的全部文本内容</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.LINK_TEXT, link_text)<br></code></pre></td></tr></table></figure><h4 id="partial-link-text-定位">partial_link_text 定位</h4><p>对 link_text 的补充，可以使用局部文本匹配元素</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.PARTIAL_LINK_TEXT, partial_link_text)<br></code></pre></td></tr></table></figure><h4 id="XPath-定位">XPath 定位</h4><ul><li><strong>路径-定位</strong><ul><li><strong>绝对路径：</strong> /html 根结点开始，使用/分隔元素层级（不建议使用）</li><li><strong>相对路径：</strong> 以 // 开始，//input 或 //*</li></ul></li><li><strong>元素属性-定位</strong><ul><li><code>//input[@id='属性值']</code> 或者 <code>//*[@id='属性值']</code></li></ul></li><li><strong>属性与逻辑结合-定位（多个属性）</strong><ul><li><code>//*[@name='属性值' and @class='属性值']</code></li></ul></li><li><strong>层级与属性结合-定位（找父属性）</strong><ul><li><code>//*[@id='p1']/input</code></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.XPATH, xpath)<br></code></pre></td></tr></table></figure><p><strong>Xpath-延伸</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">//*[text()=<span class="hljs-string">&quot;xxx&quot;</span>]   <span class="hljs-comment"># 文本内容是xxx的元素</span><br><br>//*[contains(@attribute, <span class="hljs-string">&#x27;xxx&#x27;</span>)]    <span class="hljs-comment"># 属性中含有xxx的元素</span><br><br>//*[starts-<span class="hljs-keyword">with</span>(@attribute, <span class="hljs-string">&#x27;xxx&#x27;</span>)] <span class="hljs-comment"># 属性以xxx开头的元素</span><br></code></pre></td></tr></table></figure><h4 id="CSS-定位">CSS 定位</h4><ul><li><strong>id 选择器</strong><ul><li>#id</li></ul></li><li><strong>class 选择器</strong><ul><li>.class</li></ul></li><li><strong>元素选择器</strong><ul><li>根据元素的标签名选择</li><li>element</li></ul></li><li><strong>属性选择器</strong><ul><li>根据元素的属性名和值选择</li><li>[attribute=value] 或者 element[attribute=value]</li></ul></li><li><strong>层级选择器</strong><ul><li>根据元素的父子关系选择</li><li>element1&gt;element2，element2 必须为 element1 的直接子元素</li><li>element1 element2，element2 为 element1 的后代元素</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><br>driver.find_element(By.CSS_SELECTOR, css_selector)<br></code></pre></td></tr></table></figure><p><strong>CSS 延伸</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">input</span>[<span class="hljs-built_in">type</span>^=<span class="hljs-string">&#x27;p&#x27;</span>]    <span class="hljs-comment"># type属性以p字母开头的元素</span><br><br><span class="hljs-built_in">input</span>[<span class="hljs-built_in">type</span>$=<span class="hljs-string">&#x27;d&#x27;</span>]    <span class="hljs-comment"># type属性以d字母结束的元素</span><br><br><span class="hljs-built_in">input</span>[<span class="hljs-built_in">type</span>*=<span class="hljs-string">&#x27;w&#x27;</span>]    <span class="hljs-comment"># type属性包含w字母的元素</span><br></code></pre></td></tr></table></figure><h3 id="元素操作、浏览器操作方法">元素操作、浏览器操作方法</h3><ul><li><strong>元素常用的操作方法</strong><ul><li>使用方法：定位元素.方法</li><li>例：<code>driver.find_element(By.ID, 'su').click()</code></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">click() <span class="hljs-comment"># 单击元素</span><br><br>send_keys(value)    <span class="hljs-comment"># 模拟输入</span><br><br>clear() <span class="hljs-comment"># 清除文本</span><br></code></pre></td></tr></table></figure><ul><li><strong>操作浏览器的常用方法</strong><ul><li>使用方法：driver.方法（前提：<code>driver = webdriver.Chrome()</code>）</li><li>例：<code>driver.maximize_window() # 窗口最大化</code></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">maximize_window()                 <span class="hljs-comment"># 最大化浏览器窗口 --&gt; 模拟浏览器最大化按钮</span><br>set_window_size(width, height)    <span class="hljs-comment"># 设置浏览器窗口大小 --&gt; 设置浏览器宽、高(像素点)</span><br>set_window_position(x, y)         <span class="hljs-comment"># 设置浏览器窗口位置 --&gt; 设置浏览器位置</span><br>back()                            <span class="hljs-comment"># 后退 --&gt; 模拟浏览器后退按钮</span><br>forward()                         <span class="hljs-comment"># 前进 --&gt; 模拟浏览器前进按钮</span><br>refresh()                         <span class="hljs-comment"># 刷新 --&gt; 模拟浏览器F5刷新</span><br>close()                           <span class="hljs-comment"># 关闭当前窗口 --&gt; 模拟点击浏览器关闭按钮</span><br>quit()                            <span class="hljs-comment"># 关闭浏览器驱动对象 --&gt; 关闭所有程序启动的窗口</span><br>title                             <span class="hljs-comment"># 获取页面title</span><br>current_url                       <span class="hljs-comment"># 获取当前页面URL</span><br></code></pre></td></tr></table></figure><blockquote><p>close()和 quit()区别：</p><ul><li>close():关闭当前主窗口</li><li>quit():关闭由 driver 对象启动的所有窗口<br>当前只有一个窗口二者没有区别</li></ul></blockquote><ul><li><strong>获取元素信息的常用方法</strong><ul><li>使用方法：定位元素.方法</li><li>例：<code>driver.find_element(By.ID, 'su').get_attribute(&quot;id&quot;)</code></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">size                  <span class="hljs-comment"># 返回元素大小</span><br>text                  <span class="hljs-comment"># 获取元素的文本</span><br>get_attribute(<span class="hljs-string">&quot;xxx&quot;</span>)  <span class="hljs-comment"># 获取属性值，传递的参数为元素的属性名</span><br>is_displayed()        <span class="hljs-comment"># 判断元素是否可见</span><br>is_enabled()          <span class="hljs-comment"># 判断元素是否可用</span><br>is_selected()         <span class="hljs-comment"># 判断元素是否选中，用来检查复选框或单选按钮是否被选中</span><br></code></pre></td></tr></table></figure><blockquote><ul><li>text 和 size 调用时没有括号</li><li>get_attribute 使用场景：判断一组元素是否为想要的元素或者判断元素属性值是否正确</li></ul></blockquote><h3 id="鼠标和键盘操作">鼠标和键盘操作</h3><ul><li><strong>鼠标操作的方法</strong><ul><li>说明：在 Selenium 中将操作鼠标的方法封装在 ActionChains 类中</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">导包：<span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br><br>实例化对象：action = ActionChains(driver)<br></code></pre></td></tr></table></figure><p><strong>方法</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">context_click(element).perform()        <span class="hljs-comment"># 右击</span><br>double_click(element).perform()         <span class="hljs-comment"># 双击</span><br>drag_and_drop(source, target).perform() <span class="hljs-comment"># 拖动</span><br>move_to_element(element).perform()      <span class="hljs-comment"># 悬停</span><br></code></pre></td></tr></table></figure><ul><li><strong>键盘操作的方法</strong><ul><li>使用方法：定位元素.send_keys(方法)</li><li>例：<code>driver.find_element(By.ID, 'su').send_keys(Keys.BACKSPACE)</code></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">导包：<span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> Keys<br></code></pre></td></tr></table></figure><p><strong>方法</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">send_keys(Keys.BACK_SPACE)      <span class="hljs-comment"># 删除键(BackSpace)</span><br>send_keys(Keys.SPACE)           <span class="hljs-comment"># 空格键(Space)</span><br>send_keys(Keys.TAB)             <span class="hljs-comment"># 制表键(Tab)</span><br>send_keys(Keys.ESCAPE)          <span class="hljs-comment"># 回退键(Esc)</span><br>send_keys(Keys.ENTER)           <span class="hljs-comment"># 回车键(Enter)</span><br>send_keys(Keys.CONTROL,<span class="hljs-string">&#x27;a&#x27;</span>)     <span class="hljs-comment"># 全选(Ctrl+A)</span><br>send_keys(Keys.CONTROL,<span class="hljs-string">&#x27;c&#x27;</span>)     <span class="hljs-comment"># 复制(Ctrl+C)</span><br></code></pre></td></tr></table></figure><h3 id="元素等待">元素等待</h3><ul><li>隐式等待</li><li>显式等待</li></ul><h4 id="显式等待">显式等待</h4><blockquote><p>针对单个元素生效</p></blockquote><p>定位指定元素时，如果能定位到元素则直接返回该元素，不触发等待；如果不能定位到该元素，则间隔一段时间后再去定位元素；如果达到最大时长还没有找到指定元素，则抛出超时异常 TimeoutException</p><p><strong>导包 等待类</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> selenium.webdriver.support.wait <span class="hljs-keyword">import</span> WebDriverWait<br></code></pre></td></tr></table></figure><p><strong>WebDriverWait()</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">WebDriverWait(driver, timeout, poll_frequency=<span class="hljs-number">0.5</span>)<br>    - driver:浏览器驱动对象<br>    - timeout:超时的时长，单位：秒<br>    - poll_frequecy:检测间隔时间，默认为<span class="hljs-number">0.5</span>秒<br></code></pre></td></tr></table></figure><p><strong>调用方法：until(method):直到。。。时</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">- method:函数名称，该函数用来实现对元素的定位<br>- 一般使用匿名函数来实现：<br>    - <span class="hljs-keyword">lambda</span> x: x.find_element_by_id(<span class="hljs-string">&quot;userA&quot;</span>)<br></code></pre></td></tr></table></figure><p><strong>应用</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">element = webDriverWait(driver, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>).until(<span class="hljs-keyword">lambda</span> x: x.find_element_by_id(<span class="hljs-string">&quot;userA&quot;</span>))<br></code></pre></td></tr></table></figure><h3 id="验证码处理">验证码处理</h3><p><strong>cookie 跳过登录方法</strong></p><ul><li>使用方法：driver.方法</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">- get_cookie(name)<br>    - name:为cookie的名称<br>- get_cookies() <span class="hljs-comment"># 获取本网站所有本地cookie</span><br>- add_cookie(cookie_dict) <span class="hljs-comment"># 添加cookie</span><br>    - cookie_dict:一个字典对象，必选的键包括：<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&quot;value&quot;</span><br></code></pre></td></tr></table></figure><blockquote><p>添加 cookie 后必须使用 driver.refresh()刷新方法，否则看不到登录效果</p></blockquote><h2 id="python-操作-mysql-数据库">python 操作 mysql 数据库</h2><p><strong>python 操作数据库的过程：</strong><br>创建连接-获取游标-执行命令-关闭游标-关闭连接</p><h3 id="创建连接">创建连接</h3><p><strong>python 访问 mysql 需要用 pymysql 库</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pymysql<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mysql_db</span>():<br>    conn = pymysql.connect(<br>        host=<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>        port=<span class="hljs-number">3306</span>,<br>        database=<span class="hljs-string">&quot;spider&quot;</span>,<br>        charset=<span class="hljs-string">&quot;utf8&quot;</span>,<br>        user=<span class="hljs-string">&quot;root&quot;</span>,<br>        passwd=<span class="hljs-string">&quot;root&quot;</span><br>    )<br></code></pre></td></tr></table></figure><h3 id="关于游标，执行-SQL，查询数据">关于游标，执行 SQL，查询数据</h3><p>游标需要创建游标还要关闭游标，为防止忘关游标，所以用 with</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 打开数据库可能有风险，所以添加异常捕捉</span><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> conn.cursor() <span class="hljs-keyword">as</span> cursor:<br>        <span class="hljs-comment"># 准备sql语句</span><br>        sql = <span class="hljs-string">&quot;select * from user&quot;</span><br>        cursor.execute(sql)<br>        <span class="hljs-comment">## 执行完SQL语句后的返回结果都是保存到cursor中，所以要从cursor中获取全部数据</span><br>        datas = cursor.fetchall()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;获取的数据：\n&quot;</span>, datas)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据库操作异常：\n&quot;</span>, e)<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-comment"># 不管成功还是失败，都要关闭数据库连接</span><br>    conn.close()<br></code></pre></td></tr></table></figure><p><strong>curcor 中获取数据的 fetchall, fetchone, fetchmany</strong></p><ul><li><strong>fetchall:</strong> 获取当前 SQL 语句能查出来的全部数据</li><li><strong>fetchone:</strong> 每次获取一条数据，但是获取到这条数据之后指针会往后移一行数据</li><li><strong>fetchmany:</strong> 直接告诉他想要多少条数据<code>cursor.fetchmany(3) # 获取三条数据</code></li></ul><h3 id="插入一条数据">插入一条数据</h3><blockquote><p>重点一个是 commit，一个是 rollback。有提交的地方一定要有回滚，回滚到上次提交的地方</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> conn.cursor() <span class="hljs-keyword">as</span> cursor:<br>        <span class="hljs-comment"># 准备sql语句</span><br>        value = <span class="hljs-string">&quot;12, &#x27;zj&#x27;&quot;</span><br>        sql = <span class="hljs-string">f&quot;insert into user values (<span class="hljs-subst">&#123;value&#125;</span>);&quot;</span><br>        <span class="hljs-comment"># 执行SQL语句</span><br>        cursor.execute(sql)<br>        <span class="hljs-comment"># 执行完SQL语句之后要提交</span><br>        conn.commit()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;提交成功&quot;</span>)<br><span class="hljs-keyword">except</span> Exeption <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-comment"># 如果执行失败要回滚</span><br>    conn.rollback()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据库操作异常：\n&quot;</span>, e)<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-comment"># 不管成功还是失败，都要关闭数据库连接</span><br>    conn.close()<br></code></pre></td></tr></table></figure><h3 id="添加多条数据">添加多条数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> conn.cursor() <span class="hljs-keyword">as</span> cursor:<br>        <span class="hljs-comment"># 准备要插入的数据</span><br>        value = <span class="hljs-string">&quot;(13,&#x27;张三&#x27;),(14,&#x27;李四&#x27;),(15,&#x27;王五&#x27;)&quot;</span><br>        <span class="hljs-comment"># 准备SQL语句</span><br>        sql = <span class="hljs-string">f&quot;insert into user values <span class="hljs-subst">&#123;value&#125;</span>;&quot;</span><br>        <span class="hljs-comment"># 执行SQL语句</span><br>        cursor.execute(sql)<br>        <span class="hljs-comment"># 执行完要提交</span><br>        conn.commit()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;提交成功&quot;</span>)<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-comment"># 如果执行失败要回滚</span><br>    conn.rollback()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据库操作异常：\n&quot;</span>, e)<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-comment"># 不管成功还是失败，都要关闭数据库连接</span><br>    conn.close()<br></code></pre></td></tr></table></figure><h3 id="修改、更新数据">修改、更新数据</h3><p>只需要修改添加的 SQL 语句，其他不变</p><p><strong>增删改查，除了查询，其他都要提交</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> conn.cursor() <span class="hljs-keyword">as</span> cursor:<br>        <span class="hljs-comment"># 准备sql语句</span><br>        sql = <span class="hljs-string">f&quot;update user set name=&#x27;封校&#x27;&quot;</span><br>        <span class="hljs-comment"># 执行SQL语句</span><br>        cursor.execute(sql)<br>        <span class="hljs-comment"># 执行完提交</span><br>        conn.commit()<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-comment"># 执行失败回滚</span><br>    conn.rollback()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据库操作异常：\n&quot;</span>, e)<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-comment"># 无论是否执行成功都要关闭数据库连接</span><br>    conn.close()<br></code></pre></td></tr></table></figure><h3 id="删除数据">删除数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-keyword">with</span> conn.cursor() <span class="hljs-keyword">as</span> cursor:<br>        sql = <span class="hljs-string">&quot;delete from user where id=12;&quot;</span><br>        cursor.execute(sql)<br>        conn.commit()<br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    conn.rollback()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;数据库操作异常：\n&quot;</span>, e)<br><span class="hljs-keyword">finally</span>:<br>    conn.close()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python网络爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>selenium</tag>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实验三：验证码处理与识别</title>
    <link href="/2022/11/29/%E5%AE%9E%E9%AA%8C%E4%B8%89%EF%BC%9A%E9%AA%8C%E8%AF%81%E7%A0%81%E5%A4%84%E7%90%86%E4%B8%8E%E8%AF%86%E5%88%AB/"/>
    <url>/2022/11/29/%E5%AE%9E%E9%AA%8C%E4%B8%89%EF%BC%9A%E9%AA%8C%E8%AF%81%E7%A0%81%E5%A4%84%E7%90%86%E4%B8%8E%E8%AF%86%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<h1>实验三：验证码处理与识别</h1><h2 id="实验目的">实验目的</h2><p>针对常见的验证机制：验证码进行分析和识别，可以使用传统和 OCR 技术或者基于神经网络的机器学习技术</p><h2 id="环境">环境</h2><ul><li>Selenium 库，PyQuery 库，Chrome 和对应的 ChromeDr iver</li><li><strong>深度机器学习库和图像处理库：</strong> pytorch, python-opencv</li><li><strong>OCR 库：</strong> python 第三方模块 tesserocr（这里我使用的是 pytesseract）</li></ul><h2 id="实验要求-1">实验要求 1</h2><p>使用一个合适的技术将登录网站 1 的验证码进行识别，并由代码自动登录。注意事项：所有信息必须由代码自动填入并且自动操作，如果人工填入任何信息或使用人工交互，此项目不得分。</p><h2 id="实验过程">实验过程</h2><h3 id="需要导入的包">需要导入的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pytesseract<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> retrying <span class="hljs-keyword">import</span> retry<br><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> ec<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.support.wait <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.common.exceptions <span class="hljs-keyword">import</span> TimeoutException<br><br><span class="hljs-comment">#   retrying库是用来设置浏览器重登次数的，io库是用来获取图片的</span><br></code></pre></td></tr></table></figure><h3 id="处理验证码">处理验证码</h3><ul><li>pytesseract 将图像识别为文本</li><li><code>txt = pytesseract.image_to_string(image)</code><br><img src="/img/post/2022-11-27-19-46-50.png" alt=""></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 将处理验证码的方法封装成一个函数方便调用</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_image</span>(<span class="hljs-params">image</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    图片处理函数提取出正确的验证码</span><br><span class="hljs-string">    :param image: 验证码图片</span><br><span class="hljs-string">    :return: 返回字符串</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># 将图片转换为灰度图像，只有黑和白两种颜色</span><br>    demo = image.convert(<span class="hljs-string">&#x27;L&#x27;</span>)<br>    <span class="hljs-comment"># 将图像转换为多维数组</span><br>    arr = np.array(demo)<br>    <span class="hljs-comment"># 设置灰度阈值</span><br>    threshold = <span class="hljs-number">100</span><br>    <span class="hljs-comment"># 进行筛选，超过阈值的像素变为白色，没有超过的变为黑色</span><br>    arr = np.where(arr &gt; threshold, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-comment"># 将筛选过的数组又转换为图像</span><br>    final_image = Image.fromarray(arr.astype(<span class="hljs-string">&#x27;uint8&#x27;</span>))<br>    <span class="hljs-comment"># 将图像内容识别为文本</span><br>    txt = pytesseract.image_to_string(final_image)<br>    <span class="hljs-comment"># 匹配</span><br>    result = re.sub(<span class="hljs-string">r&#x27;\W&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>, txt)<br>    <span class="hljs-keyword">return</span> result<br></code></pre></td></tr></table></figure><h3 id="设置重登次数">设置重登次数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 设置了10次重登次数，当函数返回结果为false的时候就进行重试&#x27;</span><br><span class="hljs-meta">@retry(<span class="hljs-params">stop_max_attempt_number=<span class="hljs-number">10</span>, retry_on_result=<span class="hljs-keyword">lambda</span> x: x <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span></span>)</span><br></code></pre></td></tr></table></figure><h3 id="登录函数">登录函数</h3><ul><li><p><strong>css-selector 元素定位方式</strong></p><ul><li><strong>右键直接 copy css_selector</strong></li><li><strong>如果元素某个属性是唯一的</strong><ul><li>例：<code>&lt;input value=&quot;1&quot;&gt;</code></li><li>应用：<code>driver.find_element(By.CSS_SELECTOR, '[value=&quot;1&quot;]')</code></li></ul></li><li><strong>用多个属性组合的方式定位一个元素</strong><ul><li>例：<code>&lt;input class=&quot;a b c d&quot; value=&quot;1&quot;&gt;</code></li><li>应用：<code>driver.find_element(By.CSS_SELECTOR, '.a.b.c.d[value=&quot;1&quot;]')</code></li></ul></li><li><strong>各种符合的意义</strong><ul><li><code>#</code>表示 id 属性</li><li><code>.</code>表示 class 属性</li><li><code>[]</code>表示所有属性：<code>[id=&quot;1&quot;]</code>, <code>[class=&quot;a&quot;]</code></li><li>如果使用标签名就不需要在前面加任何符号<ul><li>例：<code>a</code></li><li>例：<code>input[value=&quot;1&quot;]</code>, input 标签和 value 值组合去定位</li></ul></li><li><code>&gt;</code>表示父子元素之间的关系<ul><li>例：<code>div &gt; input</code>表示我们要找的元素有一个父节点是 div</li></ul></li><li>空格表示祖先和子孙之间的关系<ul><li>例：<code>div#id input.class</code></li><li>表示页面中有一个<code>id=&quot;id&quot;</code>的 div 元素，在该 div 元素的子孙节点中有个 input 标签，该 input 标签中有个<code>class=&quot;class&quot;</code>的属性，我们要定位的就是这个 input 标签</li><li><pre><code class="hljs">  &lt;html&gt;  &lt;body&gt;  &lt;div id=&quot;id&quot;&gt;  &lt;...&gt;  &lt;input class=&quot;class&quot;&gt;<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br>- **用户名节点并输入 admin 用户名**<br>  !<span class="hljs-literal">[]</span>(/img/post/<span class="hljs-number">2022</span>-<span class="hljs-number">11</span>-<span class="hljs-number">27</span>-<span class="hljs-number">20</span>-<span class="hljs-number">18</span>-<span class="hljs-number">29.</span>png)<br>  ```python<br>  browser.find<span class="hljs-constructor">_element(By.CSS_SELECTOR, &#x27;.<span class="hljs-params">username</span> <span class="hljs-params">input</span>[<span class="hljs-params">type</span>=<span class="hljs-string">&quot;text&quot;</span>]&#x27;)</span>.send<span class="hljs-constructor">_keys(&#x27;<span class="hljs-params">admin</span>&#x27;)</span><br></code></pre></td></tr></table></figure></code></pre></li></ul></li></ul></li></ul></li><li><p><strong>密码节点并输入密码</strong><br><img src="/img/post/2022-11-27-20-20-57.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.password input[type=&quot;password&quot;]&#x27;</span>).send_keys(<span class="hljs-string">&#x27;admin&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li><p><strong>验证码节点并输入验证码</strong><br><img src="/img/post/2022-11-27-20-22-27.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.captcha input[type=&quot;text&quot;]&#x27;</span>).send_keys(txt)<br></code></pre></td></tr></table></figure></li><li><p><strong>点击登录按钮</strong><br><img src="/img/post/2022-11-27-20-23-54.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.login&#x27;</span>).click()<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 设置登录函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    <span class="hljs-comment"># 模拟浏览器访问练习网址</span><br>    browser.get(<span class="hljs-string">&#x27;https://captcha7.scrape.center/&#x27;</span>)<br>    <span class="hljs-comment"># 找到用户名输入这个节点并输入admin用户名</span><br>    browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.username input[type=&quot;text&quot;]&#x27;</span>).send_keys(<span class="hljs-string">&#x27;admin&#x27;</span>)<br>    <span class="hljs-comment"># 同理，找到密码输入这个节点并输入admin</span><br>    browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.password input[type=&quot;password&quot;]&#x27;</span>).send_keys(<span class="hljs-string">&#x27;admin&#x27;</span>)<br>    <span class="hljs-comment"># 验证码节点</span><br>    captcha = browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;#captcha&#x27;</span>)<br>    <span class="hljs-comment"># 获取验证码图片</span><br>    image = Image.<span class="hljs-built_in">open</span>(BytesIO(captcha.screenshot_as_png))<br>    <span class="hljs-comment"># 调用函数处理图片识别验证码</span><br>    txt = process_image(image)<br>    <span class="hljs-comment"># 输入验证码</span><br>    browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.captcha input[type=&quot;text&quot;]&#x27;</span>).send_keys(txt)<br>    <span class="hljs-comment"># 点击登录按钮</span><br>    browser.find_element(By.CSS_SELECTOR, <span class="hljs-string">&#x27;.login&#x27;</span>).click()<br>    <span class="hljs-comment"># 当登录成功这个文本所在元素出现说明登录成功，页面保留10秒后退出浏览器</span><br>    <span class="hljs-keyword">try</span>:<br>        WebDriverWait(browser, <span class="hljs-number">10</span>).until(<br>            ec.presence_of_element_located((By.XPATH, <span class="hljs-string">&#x27;//h2[contains(., &quot;登录成功&quot;)]&#x27;</span>))<br>        )<br>        time.sleep(<span class="hljs-number">10</span>)<br>        browser.close()<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">except</span> TimeoutException:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><h3 id="模拟浏览器并调用登录函数">模拟浏览器并调用登录函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;设置模拟chrome浏览器并调用登录函数&#x27;</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    browser = webdriver.Chrome()<br>    login()<br></code></pre></td></tr></table></figure><h2 id="实验要求-2">实验要求 2</h2><p>实现对于带有验证登录方式（如验证码，滑动条，拼图，语序点击，空间推理，图文点击等）的常见网站</p><h2 id="实验过程-2">实验过程</h2><blockquote><p>登录 csdn，验证方式：滑动条</p></blockquote><h3 id="导入的包">导入的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><br><span class="hljs-keyword">from</span> selenium.webdriver <span class="hljs-keyword">import</span> ActionChains<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Login</span>():<br>    <span class="hljs-comment"># 打开浏览器驱动</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.url = <span class="hljs-string">&#x27;https://passport.csdn.net/login?code=applets&#x27;</span><br>        self.browser = webdriver.Chrome()<br><br>    <span class="hljs-comment"># 获取登录按钮对象   选择   账号密码登录</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_pass_button</span>(<span class="hljs-params">self</span>):<br><br>        button = self.browser.find_element(By.XPATH, <span class="hljs-string">&#x27;/html/body/div[2]/div/div[2]/div[2]/div[1]/div[1]/div[1]/span[4]&#x27;</span>)<br>        <span class="hljs-keyword">return</span> button<br><br>    <span class="hljs-comment"># 打开网址，输入用户名。密码</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">open</span>(<span class="hljs-params">self, username, password</span>):<br>        self.browser.get(self.url)<br>        self.get_pass_button().click()<br><br>        self.browser.find_element(By.XPATH, <span class="hljs-string">&#x27;//input[@autocomplete=&quot;username&quot;]&#x27;</span>).send_keys(username)<br>        time.sleep(<span class="hljs-number">2</span>)<br>        self.browser.find_element(By.XPATH, <span class="hljs-string">&#x27;//input[@autocomplete=&quot;current-password&quot;]&#x27;</span>).send_keys(password)<br><br>    <span class="hljs-comment"># 调用    open方法，输入用户名。密码，</span><br>    <span class="hljs-comment"># 调用  get_geetest_button方法，点击按钮</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># 输入用户名密码</span><br>        self.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;***&#x27;</span>, <span class="hljs-string">&#x27;***&#x27;</span>)<br><br>        time.sleep(<span class="hljs-number">2</span>)<br>        <span class="hljs-comment"># 点击登录按钮</span><br><br>        self.browser.find_element(By.XPATH, <span class="hljs-string">&#x27;//button[@class=&quot;base-button&quot;]&#x27;</span>).click()<br><br>        time.sleep(<span class="hljs-number">2</span>)<br><br>        <span class="hljs-comment">#    获取拖拽的滑动验证码块</span><br>        <span class="hljs-comment">#  按钮xpath</span><br>        slideblock = self.browser.find_element(By.XPATH, <span class="hljs-string">&#x27;//*[@id=&quot;nc_1_n1z&quot;]&#x27;</span>)<br><br>        <span class="hljs-comment"># 鼠标点击滑动块不松开</span><br>        ActionChains(self.browser).click_and_hold(slideblock).perform()<br>        <span class="hljs-comment"># 将圆球滑至相对起点位置的      右边xx</span><br>        ActionChains(self.browser).move_by_offset(xoffset=<span class="hljs-number">80</span>, yoffset=<span class="hljs-number">0</span>).perform()<br>        ActionChains(self.browser).move_by_offset(xoffset=<span class="hljs-number">160</span>, yoffset=<span class="hljs-number">80</span>).perform()<br>        ActionChains(self.browser).move_by_offset(xoffset=<span class="hljs-number">260</span>, yoffset=<span class="hljs-number">160</span>).perform()<br><br>        time.sleep(<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># 放开滑动块</span><br>        ActionChains(self.browser).release(slideblock).perform()<br><br><br>        time.sleep(<span class="hljs-number">10</span>)<br><br><br><span class="hljs-comment"># 关闭浏览器，释放资源</span><br><span class="hljs-comment">#  self.browser.close()</span><br><br><span class="hljs-comment"># 程序主入口</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    login = Login()<br>    login.log()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python网络爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
      <tag>pytesseract</tag>
      
      <tag>Selenium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实验二：模拟登陆和数据持久化</title>
    <link href="/2022/11/28/%E5%AE%9E%E9%AA%8C%E4%BA%8C%EF%BC%9A%E6%A8%A1%E6%8B%9F%E7%99%BB%E9%99%86%E5%92%8C%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    <url>/2022/11/28/%E5%AE%9E%E9%AA%8C%E4%BA%8C%EF%BC%9A%E6%A8%A1%E6%8B%9F%E7%99%BB%E9%99%86%E5%92%8C%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1>实验二：模拟登陆和数据持久化</h1><h2 id="实验目的">实验目的</h2><ul><li>熟悉两种常见的登录模式：<strong>基于 Session 与 Cookie 的登录</strong>，<strong>基于 JWT 登录</strong></li><li>掌握使用<strong>MySQL 数据库基本操作</strong>，持久化爬取数据</li></ul><h2 id="环境">环境</h2><ul><li>安装<strong>Mysql</strong>和相应的 python 库：<strong>pymysql</strong></li><li><strong>Selenium</strong>库，<strong>PyQuery</strong>库，Chrome 和对应的 ChromeDriver</li></ul><h2 id="基本要求">基本要求</h2><p>实现<strong>基于 JWT 登录模式</strong>,实现对 <a href="https://login3.scrape.center/login">https://login3.scrape.center/login</a> 数据的爬取，并把数据持久化到 MySQL，存储的表名为：spider_books，字段名称自定义，存储的字段信息包含：书名、作者、封面图像本地路径、评分、简介、标签、定价、出版社、出版时间、页数、ISBM</p><h2 id="实验过程">实验过程</h2><h3 id="分析过程">分析过程</h3><p>先来在浏览器里面操作登录，观察下其网络请求过程<br><img src="/img/post/2022-11-27-16-58-57.png" alt=""></p><p>这里我们发现登录时其请求的 URL 为 <a href="https://login3.scrape.center/api/login">https://login3.scrape.center/api/login</a> ，是通过 Ajax 请求的，返回状态码为 200。</p><p>然后再看下返回结果，如图所示。<br><img src="/img/post/2022-11-27-17-02-16.png" alt=""><br>可以看到返回结果是一个 JSON 格式的数据，包含一个 token 字段，其结果为：</p><blockquote><p>token:“eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjY3MjQ3NTcyLCJlbWFpbCI6ImFkbWluQGFkbWluLmNvbSIsIm9yaWdfaWF0IjoxNjY3MjA0MzcyfQ.sk-QJ7U5qezyn9bzr_l7naDHfHaKmYbmuNhjsi5VGy4”</p></blockquote><p>那么有了这个 JWT 之后，后续的数据怎么获取呢？下面我们再来观察下后续的请求内容，如图所示。<br><img src="/img/post/2022-11-27-17-04-42.png" alt=""><br>这里我们可以发现，后续获取数据的 Ajax 请求中的 Request Headers 里面就多了一个 Authorization 字段，其结果为 jwt 然后加上刚才的 JWT 的内容，返回结果就是 JSON 格式的数据。</p><p>模拟请求登录结果，带上必要的登录信息，获取 JWT 的结果。<br>后续的请求在 Request Headers 里面加上 Authorization 字段，值就是 JWT 对应的内容。<br>定义了登录接口和获取数据的接口，分别为 LOGIN_URL 和 INDEX_URL，接着通过 post 请求进行了模拟登录，这里提交的数据由于是 JSON 格式，所以这里使用 json 参数来传递。接着获取了返回结果中包含的 JWT 的结果。第二步就可以构造 Request Headers，然后设置 Authorization 字段并传入 JWT 即可，这样就能成功获取数据了</p><h3 id="导入的包">导入的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> urllib.request<br><br><span class="hljs-keyword">import</span> pymysql<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urljoin <span class="hljs-comment"># 连接url</span><br></code></pre></td></tr></table></figure><p>固定参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">BASE_URL = <span class="hljs-string">&#x27;https://login3.scrape.center/&#x27;</span><br>LOGIN_URL = urljoin(BASE_URL, <span class="hljs-string">&#x27;/api/login&#x27;</span>)<br>INDEX_URL = urljoin(BASE_URL, <span class="hljs-string">&#x27;/api/book&#x27;</span>)<br>USERNAME = <span class="hljs-string">&#x27;admin&#x27;</span><br>PASSWORD = <span class="hljs-string">&#x27;admin&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="requests-常用方法之-post-请求">requests 常用方法之 post 请求</h3><ul><li><strong>作用：</strong> 提交资源，新增资源</li><li><strong>调用：</strong> <code>r = requests.post(url, json/data, headers)</code> #r: 响应对象</li><li><strong>获取响应对象：</strong><ul><li><strong>响应状态码：</strong> 响应对象.status_code</li><li><strong>响应信息：</strong> 响应对象.json()/响应对象.text</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">response_login = requests.post(LOGIN_URL, json=&#123;<br>    <span class="hljs-string">&#x27;username&#x27;</span>: USERNAME,<br>    <span class="hljs-string">&#x27;password&#x27;</span>: PASSWORD<br>&#125;)<br><br>data = response_login.json()<br><span class="hljs-comment"># print(&#x27;Response JSON&#x27;, data)</span><br>jwt = data.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br><span class="hljs-comment"># print(&#x27;JWT&#x27;, jwt)</span><br></code></pre></td></tr></table></figure><ul><li><img src="/img/post/2022-11-27-16-50-56.png" alt=""></li><li><img src="/img/post/2022-11-27-16-51-14.png" alt=""></li></ul><h3 id="jwt-登录的基本框架">jwt 登录的基本框架</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">headers = &#123;<br>    <span class="hljs-string">&#x27;Authorization&#x27;</span>: <span class="hljs-string">f&#x27;jwt <span class="hljs-subst">&#123;jwt&#125;</span>&#x27;</span><br>&#125;<br>response_index = requests.get(INDEX_URL, params=&#123;<br>    <span class="hljs-string">&#x27;limit&#x27;</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-string">&#x27;offset&#x27;</span>: <span class="hljs-number">0</span><br>&#125;, headers=headers)<br><span class="hljs-comment"># print(&#x27;Response Status&#x27;, response_index.status_code)</span><br><span class="hljs-comment"># print(&#x27;Response URL&#x27;, response_index.url)</span><br><span class="hljs-comment"># print(&#x27;Response Data&#x27;, response_index.json())</span><br></code></pre></td></tr></table></figure><p><img src="/img/post/2022-11-27-16-52-41.png" alt=""><br><img src="/img/post/2022-11-27-16-53-54.png" alt=""></p><h3 id="获得书本在主页的信息">获得书本在主页的信息</h3><p>response_index.json()中书籍的信息存在’results’下<br><img src="/img/post/2022-11-27-17-12-07.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">books = response_index.json()[<span class="hljs-string">&#x27;results&#x27;</span>]<br></code></pre></td></tr></table></figure><p>提取出来是一个个字典<br><img src="/img/post/2022-11-27-17-12-56.png" alt=""></p><h3 id="保存书籍图片和保存路径">保存书籍图片和保存路径</h3><ul><li><strong>urlopen()方法：</strong> 利用 Request 类来构造请求</li><li><strong>使用方法：</strong> <code>urllib.request.Request(url, data=None, headers=&#123;&#125;）</code></li><li><strong>基本用法：</strong> （例）<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">request = urllib.request.Request(<span class="hljs-string">&#x27;https://python.org&#x27;</span>)<br>response = urllib.request.urlopen(request)<br><span class="hljs-built_in">print</span>(response.read().decode(<span class="hljs-string">&#x27;urf-8&#x27;</span>))<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#   save image</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">save_image</span>(<span class="hljs-params">url, name</span>):<br>    <span class="hljs-keyword">if</span> url <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        req_image = urllib.request.Request(url)<br>        image = urllib.request.urlopen(req_image).read()<br>        <span class="hljs-string">&#x27;&#x27;&#x27;保存路径：image/name.jpg&#x27;&#x27;&#x27;</span><br>        f_image = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;image\\&quot;</span> + name + <span class="hljs-string">&quot;.jpg&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>)<br>        f_image.write(image)<br>        f_image.close()<br>        path = <span class="hljs-string">&quot;image\\&quot;</span> + name + <span class="hljs-string">&quot;.jpg&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        path = <span class="hljs-string">&quot;null&quot;</span><br>    <span class="hljs-keyword">return</span> path<br></code></pre></td></tr></table></figure><h3 id="连接-mysql">连接 mysql</h3><ul><li>port: 数据库端口，默认 3306</li><li><strong>游标：</strong><ul><li>连接完数据库接着就该获取游标，之后才能进行执行、提交等操作</li><li>游标(cursor)是系统为用户开设的一个数据缓冲区，存放 SQL 语句的执行结果</li><li><strong>语法：</strong> <code>db.cursor()</code></li><li>默认返回的数据类型为元组</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">db = pymysql.connect(host=<span class="hljs-string">&#x27;localhost&#x27;</span>, user=<span class="hljs-string">&#x27;root&#x27;</span>, password=<span class="hljs-string">&#x27;4869&#x27;</span>, port=<span class="hljs-number">3306</span>, db=<span class="hljs-string">&#x27;spiders&#x27;</span>)<br>cursor = db.cursor()<br></code></pre></td></tr></table></figure><h3 id="将每一本书的数据存入数据库">将每一本书的数据存入数据库</h3><ul><li><strong>执行 SQL 语句</strong><ul><li><code>cursor.execute(sql, args)</code></li><li>参数 args 可以是: tuple, list, dict</li></ul></li><li><strong>每一本书籍详细信息的路径</strong><br><img src="/img/post/2022-11-27-17-19-14.png" alt=""></li><li>要爬取的书籍信息<br><img src="/img/post/2022-11-27-17-23-35.png" alt=""></li></ul><h4 id="爬取一本书的信息">爬取一本书的信息</h4><p><strong>以第三本书为例</strong><br><img src="/img/post/2022-11-27-17-27-40.png" alt=""></p><p><strong>首页的信息</strong><br><img src="/img/post/2022-11-27-17-32-13.png" alt=""></p><p><strong>详细信息，也是 json 格式</strong><br><img src="/img/post/2022-11-27-17-34-26.png" alt=""></p><ul><li>介绍 <code>introduce = html['introduction']</code><br><img src="/img/post/2022-11-27-17-37-34.png" alt=""></li><li>tag<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">tag = <span class="hljs-string">&quot;&quot;</span><br>tag_list = html[<span class="hljs-string">&#x27;tags&#x27;</span>]<br><span class="hljs-keyword">if</span> tag_list <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tag_list)):<br>        tag += tag_list[j] + <span class="hljs-string">&quot; &quot;</span><br><span class="hljs-keyword">else</span>:<br>    tag = <span class="hljs-string">&quot;null&quot;</span>`<br></code></pre></td></tr></table></figure><img src="/img/post/2022-11-27-17-39-33.png" alt=""></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(books)):<br>    book_id = books[i][<span class="hljs-string">&#x27;id&#x27;</span>]<br>    book_name = books[i][<span class="hljs-string">&#x27;name&#x27;</span>] <span class="hljs-keyword">if</span> books[i][<span class="hljs-string">&#x27;name&#x27;</span>] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;null&quot;</span> + <span class="hljs-built_in">str</span>(i + <span class="hljs-number">1</span>)<br>    author = <span class="hljs-string">&quot;&quot;</span><br>    author_list = books[i][<span class="hljs-string">&#x27;authors&#x27;</span>]<br>    <span class="hljs-keyword">if</span> author_list <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(author_list)):<br>            <span class="hljs-comment">#   .strip()方法删除多余空格</span><br>            author += author_list[j].strip() + <span class="hljs-string">&quot;/&quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        author = <span class="hljs-string">&quot;null&quot;</span><br>    image_url = books[i][<span class="hljs-string">&#x27;cover&#x27;</span>]<br>    image_path = save_image(image_url, book_name)<br>    score = books[i][<span class="hljs-string">&#x27;score&#x27;</span>]<br><br>    <span class="hljs-comment">#   书本详细信息的路径</span><br>    req = requests.get(<span class="hljs-string">&quot;https://login3.scrape.center/api/book/&quot;</span> + book_id + <span class="hljs-string">&quot;/&quot;</span>, headers=headers)<br>    html = req.json()<br><br>    introduce = html[<span class="hljs-string">&#x27;introduction&#x27;</span>]<br>    tag = <span class="hljs-string">&quot;&quot;</span><br>    tag_list = html[<span class="hljs-string">&#x27;tags&#x27;</span>]<br>    <span class="hljs-keyword">if</span> tag_list <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(tag_list)):<br>            tag += tag_list[j] + <span class="hljs-string">&quot; &quot;</span><br>    <span class="hljs-keyword">else</span>:<br>        tag = <span class="hljs-string">&quot;null&quot;</span><br>    price = html[<span class="hljs-string">&#x27;price&#x27;</span>]<br>    publisher = html[<span class="hljs-string">&#x27;publisher&#x27;</span>]<br>    published_time = html[<span class="hljs-string">&#x27;published_at&#x27;</span>]<br>    page_num = html[<span class="hljs-string">&#x27;page_number&#x27;</span>]<br>    isbn_num = html[<span class="hljs-string">&#x27;isbn&#x27;</span>]<br><br>    <span class="hljs-comment">#   插入数据的语句</span><br>    sql = <span class="hljs-string">&#x27;INSERT INTO spi_book(b_name,author,cover,score,intro,label,price,publish_house,publish_date,page,ISBM) &#x27;</span> \<br>          <span class="hljs-string">&#x27;values (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)&#x27;</span><br>    <span class="hljs-comment"># print(book_name, author, image_path, score, introduce, tag, price)</span><br>    <span class="hljs-comment"># print(publisher, published_time, page_num, isbn_num)</span><br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment">#   执行sql语句</span><br>        cursor.execute(sql, (<br>            book_name, author, image_path, score, introduce, tag, price, publisher, published_time, page_num, isbn_num))<br>        <span class="hljs-comment">#   提交</span><br>        db.commit()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Insert successfully&#x27;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<br>        <span class="hljs-comment">#   事件回滚</span><br>        db.rollback()<br>        <span class="hljs-built_in">print</span>(err)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Insert failure&#x27;</span>)<br><br>db.close()<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python网络爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
      <tag>JWT</tag>
      
      <tag>pymysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实验一：文本反爬网站的分析和爬取</title>
    <link href="/2022/11/28/%E5%AE%9E%E9%AA%8C%E4%B8%80%EF%BC%9A%E6%96%87%E6%9C%AC%E5%8F%8D%E7%88%AC%E7%BD%91%E7%AB%99%E7%9A%84%E5%88%86%E6%9E%90%E5%92%8C%E7%88%AC%E5%8F%96/"/>
    <url>/2022/11/28/%E5%AE%9E%E9%AA%8C%E4%B8%80%EF%BC%9A%E6%96%87%E6%9C%AC%E5%8F%8D%E7%88%AC%E7%BD%91%E7%AB%99%E7%9A%84%E5%88%86%E6%9E%90%E5%92%8C%E7%88%AC%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<h1>实验一：文本反爬网站的分析和爬取</h1><h2 id="实验目的">实验目的</h2><p>熟悉使用 Selenium，Puppeteer 等工具爬取网站基本内容</p><h2 id="环境">环境</h2><ul><li>Selenium 库</li><li>PyQuery 库</li><li>Chrome 和对应版本的 ChromeDriver</li></ul><h2 id="基本要求">基本要求</h2><p>将网站<code>https://antispider3.scrape.center/</code>一页每本书的信息保存在一个 json 文件中，每个 json 文件命名为书名.json，内容为保存书籍相应的信息</p><h2 id="实验过程">实验过程</h2><h3 id="导入的包">导入的包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> bs4<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.common.by <span class="hljs-keyword">import</span> By<br><span class="hljs-keyword">from</span> selenium.webdriver.support <span class="hljs-keyword">import</span> expected_conditions <span class="hljs-keyword">as</span> EC<br><span class="hljs-keyword">from</span> selenium.webdriver.support.wait <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> pyquery <span class="hljs-keyword">import</span> PyQuery <span class="hljs-keyword">as</span> pq<br></code></pre></td></tr></table></figure><h3 id="启动-ChromeDriver">启动 ChromeDriver</h3><ul><li><strong>显式等待 WebDriverWait()</strong><ul><li><strong>driver:</strong> webdriver 的驱动</li><li><strong>timeout:</strong> 最长超时时间</li><li>在设置时间 timeout 内，每隔一段时间检测一次当前页面元素是否存在，超过设置时间检测不到抛出异常 ignored_exceptions，元素存在则立即反馈</li><li>配合 until()，能够判断条件灵活等待<ul><li><code>EC.presence_of_all_elements_located()</code>：定位的元素范围内，是否至少有一个元素存在于页面当中，如果是，<strong>返回满足条件的所有元素组成的 List</strong>，否则返回空 List</li></ul></li></ul></li><li><strong>每本书的 HTML 结构</strong><ul><li><img src="/img/post/2022-11-27-15-23-45.png" alt=""></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">browser = webdriver.Chrome() <span class="hljs-comment"># 声明浏览器对象</span><br>browser.get(<span class="hljs-string">&#x27;https://antispider3.scrape.center/&#x27;</span>)<br><br><span class="hljs-comment"># CSS_SELECTOR 选择所有class为item的元素，没有返回值对象，再进行等待</span><br><br>WebDriverWait(browser, <span class="hljs-number">10</span>).until(<br>        EC.presence_of_all_elements_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;.item&#x27;</span>))<br>    )<br>html = browser.page_source <span class="hljs-comment"># 拿到的是下一页的内容源码</span><br></code></pre></td></tr></table></figure><p><strong>pyquery 用法：</strong></p><ul><li>通过该对象可以访问字符串中的 title 节点</li><li>还会将残缺的 html 文档补全</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">doc = pq(html)<br><br><span class="hljs-comment"># print(html)</span><br></code></pre></td></tr></table></figure><p><strong>定义标题，作者，路径</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">titles = []<br>authors = []<br>urls = []<br></code></pre></td></tr></table></figure><h3 id="创建-BeautifulSoup-对象">创建 BeautifulSoup 对象</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">soup = BeautifulSoup(html, <span class="hljs-string">&quot;html.parser&quot;</span>) <span class="hljs-comment"># 固定用法</span><br></code></pre></td></tr></table></figure><h3 id="爬取书籍信息">爬取书籍信息</h3><ul><li><code>soup.find_all()</code> 搜索当前 tag 的所有 tag 子节点，并判断是否符合过滤器条件</li><li><code>.text</code> 节点的文本</li></ul><h4 id="观察书籍的节点特征">观察书籍的节点特征</h4><ul><li><p><code>class=&quot;name whole&quot;</code> 此时书籍 title 是正序排列<br><img src="/img/post/2022-11-27-15-49-20.png" alt=""></p></li><li><p><code>class=&quot;m-b-sn name&quot;</code> 此时书籍 title 变了顺序，需要进一步处理 <em>get_title()</em><br><img src="/img/post/2022-11-27-15-55-36.png" alt=""></p></li></ul><h4 id="取得-title-的函数">取得 title 的函数</h4><ul><li><strong>re 库</strong><ul><li><code>re.findall()</code>函数返回包含所有匹配项的列</li></ul></li><li><code>numpy.argsort()</code> 返回的是数组值从小到大的索引值<ul><li>例：</li><li><pre><code class="language-python">&gt;&gt;&gt; import numpy as np&gt;&gt;&gt; x=np.array([1,4,3,-1,5,9])&gt;&gt;&gt; x.argsort()array([3,0,2,1,4,5)]<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs awk">- 根据偏移量取 title<br>  ![](<span class="hljs-regexp">/img/</span>post/<span class="hljs-number">2022</span>-<span class="hljs-number">11</span>-<span class="hljs-number">27</span>-<span class="hljs-number">16</span>-<span class="hljs-number">23</span>-<span class="hljs-number">16</span>.png)<br><br>```python<br>def get_title(tag: bs4.Tag) -&gt; str:<br>    tokens = [] <span class="hljs-comment"># 存储span标签的text</span><br>    tokens_pos = [] <span class="hljs-comment"># 存储style中的像素值</span><br>    <span class="hljs-keyword">for</span> span <span class="hljs-keyword">in</span> tag.childGenerator():<br>        <span class="hljs-comment"># \S+表示匹配任意多个空白字符</span><br>        <span class="hljs-keyword">if</span> len(re.findall(<span class="hljs-string">&quot;\S+&quot;</span>, span.text)) &gt; <span class="hljs-number">0</span>:<br>            token = re.findall(<span class="hljs-string">&quot;\S+&quot;</span>, span.text)[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">else</span>:<br>            token = <span class="hljs-string">&quot; &quot;</span><br>        tokens.append(token)<br>        style = span[<span class="hljs-string">&quot;style&quot;</span>]<br>        <span class="hljs-comment">#&quot;\d+&quot;表示匹配数字部分</span><br>        token_pos = int(re.findall(<span class="hljs-string">r&quot;\d+&quot;</span>, style)[<span class="hljs-number">0</span>])<br>        tokens_pos.append(token_pos)<br>    <span class="hljs-comment">#argsort()返回的是数组值从小到大的索引值</span><br>    idxs = np.array(tokens_pos).argsort()<br>    name = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> idxs:<br>        name += tokens[idx]<br>    return name<br></code></pre></td></tr></table></figure></code></pre></li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 爬取title</span><br>h3s = soup.find_all(<span class="hljs-string">&quot;h3&quot;</span>)<br><br><span class="hljs-keyword">for</span> h3 <span class="hljs-keyword">in</span> h3s: <span class="hljs-comment"># 对h3中类的不同做不同的操作</span><br>    title = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">if</span> h3[<span class="hljs-string">&quot;class&quot;</span>] == [<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;whole&quot;</span>]:<br>        title = h3.text<br>    <span class="hljs-keyword">elif</span> h3[<span class="hljs-string">&quot;class&quot;</span>] == [<span class="hljs-string">&quot;m-b-sm&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>]:<br>        title = get_title(h3)<br>    titles.append(title)<br>    <span class="hljs-built_in">print</span>(title)<br></code></pre></td></tr></table></figure><h4 id="爬取书籍封面图片的-url">爬取书籍封面图片的 url</h4><p><img src="/img/post/2022-11-27-16-37-47.png" alt=""></p><ul><li>筛选 {“class”:“cover”}</li><li><code>tag[&quot;src&quot;]</code> src=“”</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 爬取url</span><br>tag_img = soup.find_all(<span class="hljs-string">&quot;img&quot;</span>, &#123;<span class="hljs-string">&quot;class&quot;</span>: <span class="hljs-string">&quot;cover&quot;</span>&#125;)<br><span class="hljs-keyword">for</span> tag <span class="hljs-keyword">in</span> tag_img:<br>    url = tag[<span class="hljs-string">&quot;src&quot;</span>]<br>    urls.append(url)<br></code></pre></td></tr></table></figure><h4 id="爬取作者名称">爬取作者名称</h4><p><img src="/img/post/2022-11-27-16-39-12.png" alt=""></p><ul><li><code>author.text()</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 爬取作者名称 .authors是.item的子节点</span><br>authors1 = doc(<span class="hljs-string">&#x27;.item .authors&#x27;</span>)<br><span class="hljs-keyword">for</span> author <span class="hljs-keyword">in</span> authors1.items():<br>    authors.append(author.text())<br></code></pre></td></tr></table></figure><h3 id="保存-json-文件">保存 json 文件</h3><ul><li><code>r”./book_&#123;&#125;”.format()</code>正则匹配</li><li><code>json.dump()</code>编码，用于将 dict 类型的数据转成 str 类型，并写入到 json 文件</li><li>保存形式：<br><img src="/img/post/2022-11-27-16-46-32.png" alt=""></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#   保存为json文件</span><br>book_dict = &#123;<br>    <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;cover_url&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-string">&quot;authors&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>&#125;<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(titles)):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;./book_&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i), <span class="hljs-string">&quot;w+&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>) <span class="hljs-keyword">as</span> fp:<br>        book_dict[<span class="hljs-string">&quot;title&quot;</span>] = titles[i]<br>        book_dict[<span class="hljs-string">&quot;cover_url&quot;</span>] = urls[i]<br>        book_dict[<span class="hljs-string">&quot;authors&quot;</span>] = authors[i]<br>        json.dump(book_dict, fp, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python网络爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>selenium</tag>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
      <tag>ChromeDriver</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>计算机网络复习</title>
    <link href="/2022/06/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%8D%E4%B9%A0/"/>
    <url>/2022/06/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>计算机网络</h1><h2 id="第一章-概述">第一章 概述</h2><h3 id="计算机网络">计算机网络</h3><h4 id="定义">定义</h4><p>最简单的定义：计算机网络是一些互相连接的，自治的计算机的集合</p><p>计算机网络是指具有独立功能的计算机、终端及其他设备，用通信线路连接起来，按一定的方式进行通信并实现资源共享的系统</p><h4 id="组成">组成</h4><p>资源子网（或用户子网），通信子网</p><p>独立自主的计算机是组成计算机网络的基本要素</p><p>计算机间利用通信手段能进行数据交换。实现资源共享</p><p><strong>分布式系统</strong>:具有高度内聚性和透明性的计算机网络</p><h3 id="计算机网络功能">计算机网络功能</h3><ul><li><strong>连通性</strong><ul><li>连接的建立与拆除，数据传输控制，差错控制，流量控制，路由选择（选择最佳路径），多路复用（提高传输线路的利用率）</li></ul></li><li>共享（即资源共享）<ul><li>信息共享，软件共享，硬件共享</li><li>数据资源，软件资源，硬件资源</li></ul></li></ul><h3 id="计算机网络的组成">计算机网络的组成</h3><p>组成部分: 硬件，软件，协议</p><p>按<strong>工作方式</strong>来分:</p><ul><li><strong>边缘部分</strong><ul><li>连接在互联网上的所有的主机</li><li>这些主机又称端系统<ul><li>小的端系统：普通个人电脑，智能手机，网络摄像头等</li><li>大的端系统：非常昂贵的大型计算机或服务器</li><li>端系统的拥有者：可以是个人、单位、或某个 ISP</li></ul></li></ul></li><li><strong>核心部分</strong><ul><li>要向网络边缘中的大量主机提供连通性，使边缘部分中的任何一个主机都能够向其他主机通信（即传送或接收各种形式的数据）<ul><li>路由器，在网络核心部分起特殊作用，是实现分组交换的关键构件，任务是转发收到的分组</li></ul></li></ul></li></ul><p>按<strong>功能组成</strong>分:</p><ul><li>通信子网<ul><li>实现数据的通信</li></ul></li><li>资源子网<ul><li>资源共享或数据的处理过程</li></ul></li></ul><h3 id="计算机网络分类">计算机网络分类</h3><p>从网络的<strong>交换功能</strong>分</p><ul><li><strong>电路交换</strong><ul><li>数据传输期间，原节点与目的节点之间有一条利用中间节点构成的一条专用的物理连接线路，直到数据传输结束</li></ul></li><li><strong>报文交换</strong><ul><li>把要发送的数据当做一个整体交给中间交换设备，中间交换设备先将报文存储起来，然后选择一条合适的空闲输出线将报文转发给下一个交换设备</li></ul></li><li><strong>分组交换</strong><ul><li>把用户的数据划分成一个个分组，组的大小有严格的上限，使得分组可以被缓存在交换设备的内存中</li><li>在发送端把要发送的报文分隔为较短的数据块</li><li>每个块增加带哟控制信息的首部构成分组（包）</li><li>依次把各分组发送到接收端</li><li>接收端剥去首部，抽出数据部分，还原成报文</li></ul></li><li><strong>混合交换</strong><ul><li>同时使用电路交换和分组交换</li></ul></li></ul><p>按<strong>作用范围</strong>分</p><ul><li>若中央处理机之间的距离非常近，&lt;1 米，不称为计算机网络</li><li><strong>WAN</strong><ul><li>广域网：互联网核心部分</li><li>特点：覆盖地理区域大（几公里至几千、几万公里），常借用公用网络，传输速率低（64kbps-2Mbps），网络拓扑结构复杂</li></ul></li><li><strong>MAN</strong><ul><li>城域网：范围是一座城市用来连接多个局域网，也采用以太网技术实现，公共设施</li></ul></li><li><strong>LAN</strong><ul><li>局域网：如企业网，校园网</li><li>特点：覆盖的地理区域比较小（0.1-20 公里），传输速率高（1Mbps-1Gbps），误码率低，拓扑结构简单（常见：总线型，星型，环型），通常归属一个单一的组织管理</li></ul></li><li><strong>PAN</strong><ul><li>个人区域网：个人工作地方，无限个人区域网 WPAN</li></ul></li></ul><p>按<strong>使用者</strong>分</p><ul><li><strong>公用网</strong><ul><li>由电信部门或从事专业电信运营业务的公司提供的面向公众服务的网络</li></ul></li><li><strong>专用网</strong><ul><li>资源共享，高可靠性，节约资金</li></ul></li><li><strong>接入网</strong><ul><li>某个部门为本单位的特殊业务工作提供的需要建造的网络，不向本单位以外的人提供服务，如：军队、铁路、电力</li></ul></li></ul><p>按<strong>拓扑结构</strong>分</p><ul><li>总线型，星型，环型，网状型</li></ul><p>按<strong>传输技术</strong>分</p><ul><li>广播式网络（共享公共通信信道），点对点网络（使用分组存储转发和路由选择机制）</li></ul><h3 id="标准的分类">标准的分类</h3><ul><li>法定标准<ul><li>由权威机构指定的正式的合法的标准<ul><li>OSI</li></ul></li></ul></li><li>事实标准<ul><li>行业主流，逐渐成为标准<ul><li>TCP/IP</li></ul></li></ul></li></ul><h3 id="制定因特网标准的三个阶段">制定因特网标准的三个阶段</h3><p><strong>RFC——因特网标准的形式</strong></p><p>互联网草案</p><ul><li>建议标准<ul><li>从这个阶段开始就成为 RFC 文档</li></ul></li><li>草案标准<ul><li>IETF，IAB 审核<ul><li>这个流程取消了</li></ul></li></ul></li><li>互联网标准</li></ul><h3 id="标准化组织">标准化组织</h3><ul><li>国际标准化组织 ISO<ul><li>OSI 参考模型，HDLC 协议</li></ul></li><li>国际电信联盟 ITU<ul><li>制定通信规则</li></ul></li><li>国际电气电子工程师协会 IEEE<ul><li>学术机构，IEEE802 系列标准，5G</li></ul></li><li>Internet 工程任务组 IETF<ul><li>负责因特网相关标准的制定<ul><li>RFC XXXX</li></ul></li></ul></li></ul><h3 id="网络、互联网、因特网、internet、Internet">网络、互联网、因特网、internet、Internet</h3><p>网络：由若干结点和连接这些结点的链路组成</p><p>互连网：网络的网络，把许多网络连接在一起</p><p>互联网（Internet）：世界上最大的互连网络</p><h3 id="多层次-ISP-结构">多层次 ISP 结构</h3><p>互联网服务提供者 ISP（Internet Service Provider）</p><h3 id="计算机网络的主要性能指标">计算机网络的主要性能指标</h3><h4 id="速率">速率</h4><p>连接在计算机网络上的主机在数字信道上传送数据位数的速率</p><p><strong>数据率</strong>或比特率，往往是指<strong>额定速率</strong>或标称速率</p><p>单位 b/s，kb/s，Mb/s 等,速率：10^3 换算(单位小写）</p><p>存储容量：1Byte（字节） = 8bit（比特）<br>1KB = 2^10KB = 1024B = 1024*8b</p><p>比特 1/0 位</p><h4 id="带宽">带宽</h4><p>原本指某个信号具有的频带宽度(最高频率与最低频率之差), 单位赫兹（Hz）</p><p>现在指数字信道所能传送的<strong>最高数据率</strong>，单位 b/s ｜｜网络设备所支持的最高速度</p><p>带宽单位：</p><ul><li>kb/s，10^3 b/s</li><li>Mb/s，10^6 b/s</li><li>Gb/s, 10^9 b/s</li><li>Tb/s , 10^12 b/s</li></ul><p>时间轴上信号的宽度随带宽的增大而变窄</p><h4 id="吞吐量">吞吐量</h4><p>单位时间内通过某个网络（或信道、接口）的数据量, 单位 kb/s，kb/s</p><p>受网络带宽或网络的额定速率的限制</p><p><strong>实际的速率</strong></p><h4 id="时延">时延</h4><p>指数据（报文/分组/比特流）从网络（或链路）的一端传送到另一端所需的时间</p><p><strong>总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延</strong></p><p>正常情况下可以忽略处理时延和排队时延</p><p>当通信量过大时，处理时延和排队时延占主导地位，此时网络性能已经变坏了</p><p>对于高速网络链路，我们提高的仅仅是数据的发送速率而不是比特在链路上的传播速率</p><p>链路带宽越大，网络延时越小，数据的发送时延越小</p><p>光纤信道的传输速率高：指的是光纤信道发送数据的速率可以很高，而光纤信道的传播速率实际比铜线电缆略低</p><ul><li>发送时延<ul><li>发送数据时数据款从节点进入到传输媒体所需要的时间<ul><li>信道带宽：数据在信道上的发送速率</li></ul></li><li>发生在机器内部的发送器上</li><li><code>发送时延 = 数据块长度（bit）/ 发送速率（bit/s）</code></li></ul></li><li>传播时延<ul><li>电磁波在信道中需要传播一定的距离而花费的时间<ul><li>电磁波在自由空间的传播速率是光速：3*10^8m/s</li><li>在网络媒体中：铜线电缆（2.3<em>10^8），光纤（2.0</em>10^8）</li></ul></li><li>发生在机器外部的传输信道媒体上</li><li><code>传播时延 = 信道长度（米）/  信号在信道上的传播速率（m/s）</code></li></ul></li><li>处理时延<ul><li>交换节点为存储转发而进行一些必要的处理所花费的时间</li><li>分析分组首部，提取数据部分，差错检验，查找路由等</li></ul></li><li>排队时延<ul><li>分组在输入队列等待处理，输出队列等待发送</li><li>排队时延的长短往往取决于网络当时的通信量，通信量很大时会发生队列溢出，排队时延无限大</li></ul></li></ul><h4 id="时延带宽积">时延带宽积</h4><p>传播时延：以时间为单位来表示链路长度</p><p>链路的时延带宽积又称为以比特为单位的链路长度</p><p><code>时延带宽积 = 传播时延 * 带宽</code>, 单位 bit（s * b/s）</p><p>又称为以比特为单位的链路长度/某段链路现在有多少 bit</p><h4 id="往返时间-RTT">往返时间 RTT</h4><p>RTT：表示从发送端发送数据开始，到发送端收到来自接收端的确认总共经历的时延</p><p>互联网中 RTT 包括：发送时延，传播时延，处理时延，排队时延，中间节点的处理时延、排队时延以及转发数据时的发送时延</p><p>与分组大小有关</p><p>意义：收到确认信息的时间，确认过程中已经发送的数据量；当时用卫星通信时往返时间 RTT 相对较长，是很重要的一个性能指标</p><p><strong>RTT 越大，在收到确认之前，可以发送的数据越多</strong></p><h4 id="丢包率">丢包率</h4><h4 id="利用率">利用率</h4><ul><li>信道利用率：某信道有百分之几的时间是被利用的（有数据通过），完全空闲的信道的利用率是零</li><li>网络利用率：全网络的信道利用率的加权平均值</li></ul><p>信道利用率并非越高越好，利用率增大信道引起的时延也就迅速增加</p><h3 id="网络体系结构分层">网络体系结构分层</h3><p><strong>网络体系结构分层的好处</strong>:<br>可将庞大而复杂的问题，转化为若干较小的局部问题，而这些较小的局部问题就比较易于研究和处理</p><p><strong>分层基本原则</strong></p><ul><li>各层之间相互独立，每层只实现一种相对独立的功能</li><li>每层之间界面自然清晰，相互交流尽可能少</li><li>结构上可分割开</li><li>保持下层对上层的独立性<ul><li>上层单向使用下层提供的服务</li></ul></li><li>整个分层结构应该能促进标准化工作</li></ul><h4 id="分层结构">分层结构</h4><p><strong>实体</strong></p><ul><li>n 层实体<ul><li>第 n 层中的活动元素</li></ul></li><li>对等实体<ul><li>同一层实体</li></ul></li></ul><p><strong>协议</strong></p><ul><li>为进行网络中的对等实体数据交换而建立的规则、标准或约定，称为网络协议【水平】</li><li><strong>网络协议三要素</strong><ul><li><strong>语法</strong><ul><li>规定传输数据的格式</li><li>数据与控制信息的结构或格式</li></ul></li><li>若干个协议元素和数据组合在一起来表达一个更完整的内容时所遵循的格式，如报文格式</li><li><strong>语义</strong><ul><li>规定所要完成的功能</li><li>需要发出何种控制信息，完成何种动作以及做出何种响应</li></ul></li><li><strong>同步</strong><ul><li>规定各种操作的顺序</li><li>事件实现顺序的详细说明</li></ul></li><li>通信双方建立和执行通信过程中必须遵循的顺序</li></ul></li></ul><p><strong>接口</strong>（访问服务点 SAP）</p><ul><li>上层使用下层服务的入口</li></ul><p><strong>服务</strong></p><ul><li>下层为相邻上层提供的功能调用【垂直】</li></ul><p><strong>SDU 服务数据单元</strong></p><ul><li>为完成用户所要求的功能而应传送的数据</li></ul><p><strong>PCI 协议控制信息</strong></p><ul><li>控制协议操作的信息</li></ul><p><strong>PDU 协议数据单元</strong></p><ul><li>对等层次之间传送的数据单元</li></ul><h3 id="计算机网络分层结构">计算机网络分层结构</h3><p>同一网络中，任意两个端系统必须具有相同的层次</p><p>通信只在对等层间进行（间接的、逻辑的、虚拟的），非对等层之间不能互相通信</p><ul><li>禁止不同主机的对等层之间进行直接通信</li><li>每一层必须依靠下层提供的服务来与另一台主机的对等层通信</li></ul><p>实际的物理通信只在最底层完成</p><h4 id="7-层-OSI-参考模型（法定标准）">7 层 OSI 参考模型（法定标准）</h4><p><strong>目的</strong>: 支持异构网络系统的互联互通<br>国际标准化组织 ISO 提出开放系统互联 OSI 参考模型<br>结构</p><ul><li><strong>应用层</strong><ul><li>所有能与用户交互产生网络流量的程序（要能联网）</li><li>典型应用层服务<ul><li>文件传输（FTP），电子邮件（SMTP），万维网（HTTP）</li></ul></li></ul></li><li><strong>表示层</strong><ul><li>用于处理在两个通信系统中过交换信息的表示方式（语法和语义）</li><li>功能<ul><li>数据格式变换</li><li>数据加密解密</li><li>数据压缩和恢复</li></ul></li></ul></li><li><strong>会话层</strong><ul><li>向表示层实体/用户进程提供建立连接并在连接上有序的传输数据（建立同步 SYN）</li><li>功能<ul><li>建立、管理、终止会话</li><li>使用校验点<ul><li>使会话在通信失效时从校验点继续恢复通信，实现数据同步</li><li>适用于传输大文件</li></ul></li></ul></li></ul></li><li><strong>传输层</strong><ul><li>负责主机中两个进程的通信，即端到端通信</li><li>传输单位是报文段或用户数据报</li><li>功能<ul><li>可靠传输、不可靠传输</li><li>差错控制</li><li>流量控制</li><li>复用分用<ul><li>复用：多个应用层可同时使用下面运输层的服务</li><li>分用：运输层把收到的信息分别交付给上面应用层中相应的进程<ul><li>端口号</li></ul></li></ul></li></ul></li><li>主要协议: TCP，UDP</li></ul></li><li><strong>网络层</strong><ul><li>把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务</li><li>传输单位是数据报</li><li>功能<ul><li>路由选择<ul><li>最佳路径</li></ul></li><li>流量控制<ul><li>限制发送方的速度</li></ul></li><li>查错控制</li><li>拥塞控制<ul><li>对网络全局的控制</li></ul></li></ul></li><li>主要协议<ul><li>IP、IPX、ICMP、IGMP、ARP、RARP、OSPF</li></ul></li></ul></li><li><strong>数据链路层</strong><ul><li>链路层加首部和尾部</li><li>把网络层上传下来的数据报组装成帧</li><li>传输单位是帧</li><li>功能<ul><li>成帧</li><li>差错控制<ul><li>帧错+位错</li></ul></li><li>流量控制<ul><li>发送方和接收方的速度协调（减小发送方速率）</li></ul></li><li>访问（接入）控制<ul><li>控制对信道的访问</li></ul></li></ul></li><li>主要协议<ul><li>SDLC、HDLC、PPP、STP</li></ul></li></ul></li><li><strong>物理层</strong><ul><li>把上面的数据变成比特流或把得到的数据变成数据链路层的数据形式，不加首尾部</li><li>在物理媒体上实现比特流的透明传输<ul><li>透明传输：指不管所传数据是什么样的比特组合，都应当能够在链路上传送</li></ul></li><li>传输单位是比特</li><li>功能<ul><li>定义接口特性</li><li>定义传输模式<ul><li>单工，半双工，双工</li></ul></li><li>定义传输速率</li><li>比特同步</li><li>比特编码</li></ul></li><li>主要协议<ul><li>Rj45、802.3</li></ul></li></ul></li></ul><h4 id="4-层-TCP-IP-参考模型（事实标准）">4 层 TCP/IP 参考模型（事实标准）</h4><p><strong>模型</strong></p><ul><li>应用层</li><li>传输层</li><li>网际层</li><li>网络接口层</li></ul><p><strong>TCP/IP 协议栈</strong></p><ul><li>HTTP、FTP、DNS</li><li>TCP、UDP</li><li>IP</li><li>Ethernet、ATM、Frame Relay</li></ul><p><strong>TCP/IP 对比</strong></p><ul><li>相同点<ul><li>都分层</li><li>基于独立的协议栈的概念</li><li>都可以实现异构网络的互联</li></ul></li><li>不同点<ul><li>OSI 定义三点：服务、协议、接口</li><li>OSI 线出现，参考模型先于协议发明，不偏向特定协议</li><li>TCP/IP 设计之初就考虑到异构网互联问题，将 IP 作为重要层次</li><li>OSI 网络层无连接+面向连接<ul><li>TCP/IP 无连接<ul><li>无连接直接进行数据传输</li><li>网络层都有 IP 协议，面向无连接</li></ul></li></ul></li><li>OSI 传输层面向连接<ul><li>TCP/IP 无连接+面向连接<ul><li>传输层可靠传输，都有面向连接</li></ul></li></ul></li></ul></li></ul><p>面向连接：</p><ol><li>建立连接，发出请求</li><li>建立成功，开始数据传输</li><li>传输完毕，释放连接</li></ol><p>无连接直接进行数据传输</p><h4 id="具有五层协议的体系结构">具有五层协议的体系结构</h4><ul><li>应用层<ul><li>支持各种网络应用</li><li>应用进程数据先传送到应用层，加上应用层首部，成为应用层 PDU<ul><li>应用层剥去首部取出应用程序数据上交给应用进程</li></ul></li></ul></li><li>运输层<ul><li>进程-进程的数据传输</li><li>应用层 PDU 传送到运输层，加上运输层首部，成为运输层报文</li></ul></li><li>网络层<ul><li>原主机到目的主机的数据分组路由与转发</li><li>报文传送到网络层，加上网络层首部，成为 IP 数据报</li></ul></li><li>数据链路层<ul><li>把网络层传下来的数据报组装成帧</li><li>IP 数据报再传送到数据链路层，加上链路层首部和尾部，成为数据链路层帧</li></ul></li><li>物理层<ul><li>比特传输</li><li>把比特流传送到物理媒体<ul><li>电信号（或光信号）在物理媒体中传播，从发送端物理层传送到接收端物理层</li></ul></li></ul></li></ul><h2 id="第二章-物理层">第二章 物理层</h2><h3 id="物理层四个特性">物理层四个特性</h3><ul><li>机械<ul><li>引线数目，引脚数目</li></ul></li><li>电气<ul><li>电压范围，传输速率，距离限制，二进制</li></ul></li><li>功能<ul><li>电平表示何种意义</li></ul></li><li>规程<ul><li>规程和时序</li></ul></li></ul><h3 id="数据通信相关术语">数据通信相关术语</h3><ul><li><strong>消息</strong><ul><li>通信系统中传输的具体对象（如符号、文字、语音、图像等）</li></ul></li><li><strong>数据</strong><ul><li>运送消息的实体</li><li>通常是有意义的符号序列</li><li>数据的内容称为消息</li></ul></li><li><strong>信号</strong><ul><li>数据的电气或电磁表现</li><li>数据在传输过程中的存在形式</li><li>模拟信号，数字信号</li><li>周期信号<ul><li>振幅，周期，相位</li></ul></li></ul></li><li><strong>信源</strong><ul><li>产生和发送数据的源头</li></ul></li><li><strong>信宿</strong><ul><li>接收数据的终点</li></ul></li><li><strong>信道</strong><ul><li>信号的传输媒介</li><li>一般用来表示向某一个方向传送信息的介质</li><li>一条通信线路往往包含一条发送信道和一条接收信道</li></ul></li><li><strong>分类</strong><ul><li>传输信道<ul><li>模拟信道，数字信号</li></ul></li><li>传输介质<ul><li>无线信道（无线电波），有线信道</li></ul></li></ul></li></ul><h3 id="通信方式">通信方式</h3><ul><li>单工：只能有一个方向的通信而没有反方向的交互</li><li>半双工：双方都可以发送信息，但不能双方同时发送或接收</li><li>全双工：双方可以同时发送或接收信息</li></ul><h3 id="传输方式">传输方式</h3><ul><li><strong>串行</strong><ul><li>每个脉冲只发送一个比特，两个通信设备只需要一个通信信道</li><li>信道少，费用低，但是发送端接收端与线路的接口处分别要并/串和串/并转换</li><li><strong>异步、同步</strong><ul><li>异步：发送方和接收方的采样时钟不是同一个<ul><li>数据块以字符为单位，每个字符由发送方随机产生，还要附加 1 位奇偶校验位<ul><li>双方要用相同的波特率发送和接收数据，每发送一个字符要进行交互</li><li>效率低，近距离，以字符为单位发送数据，费用低</li><li>必须指定的四个参数：波特率，字符长度（8 位），奇偶校验（有/无）停止位长度（1，2）</li></ul></li></ul></li><li>同步：发送方和接收方的采样时钟是同一个<ul><li>分为<ul><li>面向字符的同步通信（以特殊字符做开始和结束标志，数据块前加一个或两个同步字符 SYN，效率高，传输速率高）</li><li>面向 bit 流的同步通信（必须约定的参数：传输速率，CRC 生成多项式；每个数据块的头部和尾部用一个或多个特殊的比特序列来标记数据块的开始和结束）</li></ul></li></ul></li></ul></li></ul></li><li><strong>并行</strong><ul><li>在每个时钟脉冲到来时多个比特被发送，所以一次需要多条导线</li><li>速度快，费用高，距离短</li><li>用于计算机内部数据传输</li></ul></li></ul><h3 id="码元">码元</h3><p>在使用时间域（或简称为时域）的波形表示数字信号时，代表不同离散数值的基本波形<br>1 码元可以携带多个比特的信息量</p><p>二进制编码时只有两种码元，一种代表 0，一种 1<br>k 进制码元: 4 进制码元<br>码元的离散状态有 4 个=&gt;4 种高低不同的信号波形 00 01 10 11, 一个波形对应两个 bit</p><p><strong>数据率</strong></p><ul><li><strong>数据传输速率</strong><ul><li>单位时间内传输的数据量<ul><li><strong>波特率</strong><ul><li>1s 传输多少个码元, 也可称为脉冲个数或信号变化的次数</li><li>单位波特 Baud, 1Baud = 1 码元/s</li><li>码元可以是多进制也可以是二进制，但码元速率与进制数无关</li></ul></li><li><strong>比特率</strong><ul><li>1s 传输多少个比特</li><li>单位比特/秒</li></ul></li><li>一个码元携带 n bit 信息量，则 M Baud 波特率所对应的比特率为 M*n bit/s</li><li>系统传输的是比特流，通常比较信息传输速率</li><li>带宽: 最高数据率(b/s)</li></ul></li></ul></li></ul><h3 id="影响失真程度的因素">影响失真程度的因素</h3><ul><li>码元传输速率</li><li>信号传输距离</li><li>噪声干扰</li><li>传输媒体质量</li></ul><h3 id="奈氏准则">奈氏准则</h3><p>在<strong>理想低通</strong>（无噪声，带宽受限）条件下</p><ul><li><p>为了避免码间串扰</p></li><li><p>极限码元传输速率为 2W Baud，W 是信号带宽，单位 Hz</p></li><li><p>限制码元速率的上限</p></li><li><p>理想低通信道下的极限数据传输率 = 2W log2V （b/s）</p><ul><li>V: 几种码元</li></ul></li></ul><p>得到的结论</p><ul><li>在任何信道中，码元传输的速率是有上限的，传输速率超过此上限，就会出现严重的码间串扰问题，使接收端对码元的判决（即识别）成为不可能<ul><li>码间串扰：扩散了的码元波形所占的时间变得更宽，接收端收到的信号波形就失去了码元之间的清晰界限</li></ul></li><li>信道的频带越宽（能通过的信号高频分量越多），就可以用更高的速率进行码元的有效传输</li></ul>]]></content>
    
    
    <categories>
      
      <category>计算机网络</category>
      
    </categories>
    
    
    <tags>
      
      <tag>计算机网络</tag>
      
      <tag>复习资料</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java</title>
    <link href="/2021/12/25/Java/"/>
    <url>/2021/12/25/Java/</url>
    
    <content type="html"><![CDATA[<h1>Java</h1><h2 id="第一章-Java-语言概述">第一章 Java 语言概述</h2><h3 id="Java-语言的特色">Java 语言的特色</h3><ol><li><p>简单性</p></li><li><p>平台无关性</p></li><li><p>面向对象的技术</p></li><li><p>支持多线程</p></li><li><p>动态性</p></li><li><p>安全性</p></li></ol><p>还有高性能、分布性、强大性、解释性、可移植性</p><h3 id="Java-的工作原理及-JVM">Java 的工作原理及 JVM</h3><p><strong>Java 虚拟机 JVM（ Java Virtual Machine ）</strong></p><p>在一台计算机上由软件或硬件模拟的计算机。JVM 读取并处理经编译过的平台无关的字节码 class 文件</p><p>Java 编译器针对 Java 虚拟机产生 class 文件，因此是独立于平台的</p><p>Java 解释器负责将 Java 虚拟机的代码在特定的平台上运行<br>垃圾收集机制（ Garbage collection ）</p><p><strong>代码安全性检测（ Code Security ）</strong></p><p>执行代码时，JVM 对运行的代码进行安全性检测，当进行一些非法操作的时候，比如修改一些系统设置，JVM 会发出警告</p><p><strong>垃圾收集机制</strong></p><p>不再使用的内存空间应回收——垃圾收集</p><p>Java 语言解除了程序员回收无用内存空间的责任，它提供一种系统级线程跟踪存储空间的分配情况，并在 JVM 空闲的时候检查并释放那些可被释放的存储器空间</p><p>垃圾收集在 Java 程序运行过程中自动进行，程序员无法精确控制和干预</p><h3 id="一个简单的-Java-应用程序">一个简单的 Java 应用程序</h3><p>源文件中只能有一个类是 public 类，且源文件名必须与该类名完全相同，该类是主类，包含 main 方法</p><p>main()是 Java 程序执行的入口点</p><h3 id="Java-程序的分类">Java 程序的分类</h3><ul><li>Java 应用程序( Java Application )<ul><li>以 main()方法作为程序入口，由 Java 解释器加载运行。是完整的程序，能够独立运行</li></ul></li><li>Java 小应用程序( Java Applet )<ul><li>不使用 main()方法作为程序入口，需要*.class 嵌入到 HTML 网页中运行，由浏览器或 appletviewer 加载执行，无法独立运行</li><li>例：Welcome.Java<br>首先使用编译器将 Welcome.java 编译成 Welcome.class ，然后使用记事本编辑文件 welcome.html 如下：<br><code>html &lt;applet code=&quot;Welcome.class&quot; height=&quot;100&quot; width=&quot;300&quot;&gt;&lt;/applet&gt; </code></li></ul></li></ul><h3 id="Java-语言的面向对象特性">Java 语言的面向对象特性</h3><p>编程思想：力图使对计算机语言中对事物的描述与现实中该事物的本来面目尽可能一致</p><p><strong>类</strong>( class )和<strong>对象</strong>( object )是面向对象方法的核心概念。类是对一类事物描述，是抽象的，概念上的定义；对象是实际存在的该类事物的每个个体，因而也称<strong>实例</strong>( instance )</p><h3 id="Java-API-介绍">Java API 介绍</h3><p><a href="http://java.io">java.io</a>; java.lang; <a href="http://java.net">java.net</a>; java.util; java.awt; java.sql</p><h2 id="第二章-Java-语法基础">第二章 Java 语法基础</h2><h3 id="标识符、分隔符和关键字">标识符、分隔符和关键字</h3><p><strong>标识符命名规则：</strong></p><ol><li>标识符应以字母、下划线、美元符$开头，不能以数字开头</li><li>标识符可以有字母、下划线、美元符或数字</li><li>大小写敏感，长度无限制</li><li>系统的关键字不能作为标识符</li></ol><p><strong>关键字：</strong></p><ul><li>所有 Java 关键字都是小写</li><li>TRUE, FALSE, NULL 都不是 Java 关键字，goto 和 const 虽然从未使用但也是关键字，true, false, null 虽做专门用途但也不是关键字</li></ul><p><strong>分隔符</strong>：“;”, “{}”, &quot; &quot;</p><p>语句块嵌套层数无限制</p><h3 id="常量和变量">常量和变量</h3><p><strong>常量</strong>：布尔型、字符型（一对单引号括起来的单个字符）、整数型、浮点型、字符串型</p><p><strong>变量</strong>：包括变量名和变量值，必须先声明后使用</p><h3 id="Java-的数据类型">Java 的数据类型</h3><p>数据类型</p><ul><li>基本数据类型<ul><li>数值型<ul><li>整数类型( byte, short, int, long )</li><li>浮点类型( float, double )</li></ul></li><li>字符型( char )</li><li>布尔型( boolean )</li></ul></li><li>引用数据类型<ul><li>类( class )<ul><li>接口( interface )</li><li>数组</li></ul></li></ul></li></ul><h3 id="运算符、表达式和语句">运算符、表达式和语句</h3><h3 id="条件语句">条件语句</h3><h3 id="循环语句">循环语句</h3><h3 id="跳转语句">跳转语句</h3><h2 id="第三章-Java-面向对象程序设计">第三章 Java 面向对象程序设计</h2><h3 id="类的创建">类的创建</h3><p>类是组成 Java 程序的基本元素，封装了一类对象的状态属性和行为方法，是类对象的原型</p><p>包括类声明和类体</p><h4 id="修饰符">修饰符</h4><p><code>public</code>：声明了类可以在其他类中使用</p><p><code>abstract</code>：声明了这个类不能被实例化</p><p><code>final</code>：声明了类不能被继承，即没有子类</p><h4 id="关键字">关键字</h4><p><code>class</code>：用来定义类，类名必须是合法的 Java 标识符</p><p><code>extends</code>：用来说明该类是 SuperclassName 的子类，SuperclassName 是该类的父类的名字</p><p><code>implement</code>：用来声明本类要实现的一个或多个接口，由逗号分隔</p><h4 id="类体">类体</h4><p>定义该类所有的变量和方法</p><h5 id="成员变量">成员变量</h5><p>在类体中，变量声明部分所声明的变量</p><p>分为实例成员变量和类成员变量，用修饰符 static 声明的变量称为类变量，否则为实例变量</p><p>可以是 Java 中任意的数据结构，包括简单类型，类，接口，数组，创建后系统自动对其进行默认初始化或显式初始化</p><p><strong>限定符：</strong></p><ul><li><code>private</code>：变量只能被类中的代码访问</li><li><code>protected</code>：可以被继承类及同一个包中的类访问</li><li><code>public</code>：能被类外的代码访问</li><li>无限定符：（包访问权限），可以被类中的代码和同一个包中的类访问</li><li><code>static</code>：用来制定静态变量（类变量），类变量既可以由类方法访问，也可以由实例方法访问</li><li><code>final</code>：用来声明一个常量，同 define</li><li><code>volatile</code>：用来声明一个由多线程共享的变量，使得各线程对该变量的访问能保持一致</li></ul><h5 id="局部变量">局部变量</h5><p>在方法体中声明的变量和方法中的参数</p><h4 id="方法">方法</h4><p>用修饰符 static 声明的方法称为类方法，没有用修饰符 static 修饰的变量称为实例方法</p><p><strong>方法重载</strong>（overloading）：多个方法享有相同的名字，方法的参数列表必须不一样，这里的不一样可能是个数，类型不一样。重载和方法的返回值无关，返回值可以相同，也可以不同。在同一个类中可以定义多个同名方法。如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Testoverload</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">( <span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b )</span>;<br>String <span class="hljs-title function_">add</span><span class="hljs-params">( String a, String b )</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>构造方法</strong>：创建对象是总是调用一个特定的方法</p><p>如在</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">person</span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-title function_">person</span><span class="hljs-params">()</span>&#123; &#125;;<br>&#125;<br></code></pre></td></tr></table></figure><p>在<code>main</code>方法中，<code>person a = new person();</code> 构造了一个对象</p><p>一旦类的定义者显式定义了一个或多个构造方法，系统将不再提供默认的构造方法</p><h5 id="this-的用法">this 的用法</h5><p>用于覆盖范围规则，代表当前对象本身，this 可以看做是类对象的别名，使该类中的隐藏数据以及方法可以引用</p><p>用于代表当前类的构造方法</p><h3 id="继承（inheritance）">继承（inheritance）</h3><p>重用其他类中的方法和属性来创建新类，利用继承可以先创建一个具有某些基本功能的一般类，然后将这些类作为基础去创建具有特殊功能的类。</p><p>由继承得到的类称为子类（subclass），父类包括所有直接或间接被继承的类，一个父类可以同时拥有多个子类，一个子类只能直接拥有一个父类</p><p><strong>变量的隐藏</strong>：如果子类中定义的成员变量和父类中定义的成员变量完全相同，此时父类中的成员变量将被隐藏</p><p><strong>方法的覆盖或重写</strong>：如果在子类中定义的方法和父类中定义的方法在名字、返回类型、参数个数和参数类型方面完全相同，此时父类的方法将被隐藏</p><h3 id="关键字-2">关键字</h3><ul><li><strong>static</strong><ul><li>标记的变量或方法由整个类（所有实例共享），如果访问控制权限允许，可不必创建该类对象而直接用类名加’ . '调用</li></ul></li><li><strong>final</strong><ul><li>final 标记的类不能被继承</li><li>final 标记的类不能被子类重写</li><li>final 标记的变量即成为常量，只能被赋值一次</li><li>final 标记的成员变量必须在声明的同时或在每个构造方法中显式赋值才能使用</li></ul></li><li><strong>abstract</strong><ul><li>用 abstract 修饰的不能直接创建对象，抽象类往往是它的所有子类共有属性的集合</li><li>必须产生子类，由子类创建对象</li></ul></li><li><strong>super</strong><ul><li>super(parentName) 或 <a href="http://super.name">super.name</a> = parentName</li></ul></li></ul><h3 id="包">包</h3><p>由于 Java 编译器为每个类生成一个字节码文件，且文件名与 public 的类名相同，因此同名的类有可能发生冲突，Java 提供 package 来管理类名空间和访问保护机制</p><h3 id="访问控制">访问控制</h3><p>private，default，protected，public</p><h3 id="接口">接口</h3><p>接口（interface）是抽象方法和常量值的定义的集合</p><p>是一种特殊的抽象类，只包含常量和方法的定义，而没有变量和方法的实现</p><p>举例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Runner</span>&#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>多个无关的类可以实现同一个接口</p><p>一个类可以实现多个无关的接口</p><p>与继承关系类似，接口与实现类之间存在多态性</p><h3 id="内部类">内部类</h3><ul><li>允许一个类的定义位于另一个类的内部，前者称为内部类</li><li>内部类和外层封装它的类之间存在逻辑上的从属关系</li><li>在外部引用它时必须给出完整的名称，如 School.Teacher mike = new School.Teacher()；</li></ul><h2 id="第四章-对象、数组与字符串">第四章 对象、数组与字符串</h2><h3 id="对象">对象</h3><p>将任何实体都看成对象</p><p>对象 是通过对实体的抽象得到，由属性和方法组成。属性是实体的一些特征值，方法是实体的功能和方法</p><p>对象之间通过消息进行传递进行交互，最终完成任务</p><p><strong>对象生命周期</strong>三个阶段：创建，使用和清除</p><p><strong>对象的复制</strong></p><ul><li>浅拷贝和深拷贝</li><li>浅拷贝只直接复制所有对象成员的值</li><li>深拷贝对于基本数据类型变量直接复制其值，对于引用数据类型对象递归复制其指向的内存空间</li></ul><h3 id="一维数组">一维数组</h3><p>声明：如 <code>int a[]</code> 或 <code>int[] a</code>;</p><p>声明数组时 不能指定其长度</p><p>使用数组还需要为它分配内存空间，分配内存空间的时候 必须指明数组的长度</p><p>如 <code>a = new int[3];</code></p><p><strong>初始化：</strong></p><ul><li>动态初始化：数组定义与为数组元素分配空间并赋值的操作分开进行<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dates[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyDate</span>(<span class="hljs-number">22</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1964</span>);<br></code></pre></td></tr></table></figure></li><li>静态初始化：定义数组的同时就为数组元素分配空间并复制<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> a[] = &#123;<span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>&#125;;<br>MyDate dates[] = &#123;<br>newMyDate(<span class="hljs-number">22</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1964</span>);<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="多维数组">多维数组</h3><p>二维数组声明：<code>type var[][]</code> 或 <code>type[][] var;</code><br>例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> a[][] = &#123; &#123;<span class="hljs-number">1</span> ,<span class="hljs-number">2</span> &#125;, &#123; <span class="hljs-number">3</span> ,<span class="hljs-number">4</span> ,<span class="hljs-number">0</span> ,<span class="hljs-number">9</span> &#125;, &#123; <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span> &#125; &#125;<br></code></pre></td></tr></table></figure><p>声明和初始化应按从高位到低维的顺序进行，不必是规则矩阵形式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> t[][] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span> [<span class="hljs-number">4</span>][];<br>t[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>];<br>t[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>];<br><span class="hljs-type">int</span> t1[][] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[][<span class="hljs-number">4</span>];<span class="hljs-comment">//非法</span><br></code></pre></td></tr></table></figure><p>初始化：静态和动态</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> intArray1[<span class="hljs-number">3</span>][<span class="hljs-number">2</span>] = &#123; &#123; <span class="hljs-number">1</span>, <span class="hljs-number">2</span> &#125;, &#123; <span class="hljs-number">2</span>, <span class="hljs-number">3</span> &#125;, &#123; <span class="hljs-number">4</span>, <span class="hljs-number">5</span> &#125; &#125;; <span class="hljs-comment">// illegal</span><br></code></pre></td></tr></table></figure><h3 id="字符串">字符串</h3><p>利用 Java.lang 包中的两个类 String 和 StringBuffer 来储存、创建和操作字符串</p><p><code>String类</code>用于处理由多个字符组成的不可变数据</p><p><code>StringBuffer类</code>用于存储和操作由多个字符组成的可变数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello World&quot;</span>;<br>message = message + <span class="hljs-string">&quot;!!&quot;</span>;<br><span class="hljs-type">StringBuffer</span> <span class="hljs-variable">messageBuf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>(message).append(<span class="hljs-string">&quot;!!&quot;</span>);<br><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> messageBuf.toString();<br></code></pre></td></tr></table></figure><h4 id="String-类">String 类</h4><p>最常用的一种 Java 引用类型</p><p>String 类对象保存不可修改的 Unicode 字符序列</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello World&quot;</span>;<br></code></pre></td></tr></table></figure><p>String 类型数据可以和任何其他数据类型进行‘+’操作，实现字符串连接的效果</p><ul><li><p>获得字符串长度 <code>int length = a.length();</code></p></li><li><p>按照指定索引下得到字符 <code>char c1 = name.charAt(3);</code></p></li><li><p>从一个字符串或者字符串缓冲区得到多个字符 <code>String b = s.substring(8);</code></p></li></ul><p><strong>常用方法：</strong></p><ul><li>startWith(String s) 比较字符串的前缀与特定字符串是否相同</li><li>endWith(String s) 比较字符串的后缀与特定字符串是否相同</li><li>equals(String s) 比较字符串与特定字符串是否完全相同</li><li>equalsIgnoreCase(String s) 比较字符串与特定字符串是否相同，忽略大小写</li><li>public int compareTo(String s) 按字典序比较字符串大小，相同返回 0，比特定字符串大返回正值，小返回负值</li><li>public int compareToIgnoreCase(String s) 按字典序比较字符串大小，忽略大小写</li></ul><h3 id="Java-中常用类库">Java 中常用类库</h3><p>常用的包：</p><ul><li>java.lang 语言包，是 Java 语言的基础类包</li><li>java.util 应用包，提供各种应用类型的类</li><li>java.awt 抽象窗口工具包，提供各种图形和图像类</li><li><a href="http://java.io">java.io</a> 输入输出包，提供各种输入输出类</li><li><a href="http://java.net">java.net</a> 网络应用包，提供各种网络应用类</li><li>java.applet 提供 applet 程序需要的类</li></ul><h2 id="第五章-数据结构及常用算法">第五章 数据结构及常用算法</h2><p>泛型( Generic )<br>数据结构中的接口<br>向量( Vector )<br>散列表( HashMap )<br>堆栈( Stack )<br>链表( LinkedList )</p><h2 id="第六章-流和文件">第六章 流和文件</h2><h3 id="流概述">流概述</h3><p>为进行数据的输入/输出操作，Java 中把不同的输入输出源（键盘、文件、网络连接等）抽象表述为“流”</p><p><a href="http://java.io">java.io</a> 包中定义了多个流类型（类或抽象类）来实现输入/输出功能</p><h3 id="基本输入和输出流">基本输入和输出流</h3><p>按<strong>功能</strong>划分两种基本的流：</p><ul><li><strong>输入流</strong>：只能从中读取数据，而不能向其写出数据</li><li><strong>输出流</strong>：只能向其写出数据，而不能从中读取数据</li></ul><p>输入流和输出流可以被连接到文件、网络套接字或内存缓冲区</p><p>按<strong>处理数据</strong>的单位划分：字符流和字节流</p><table><thead><tr><th></th><th>字节流</th><th>字符流</th></tr></thead><tbody><tr><td>输入</td><td>InputStream</td><td>Reader</td></tr><tr><td>输出</td><td>OutputStream</td><td>Writer</td></tr></tbody></table><h4 id="节点流和处理流">节点流和处理流</h4><ul><li><strong>节点流</strong>：可以从/向一个特定的地方（结点）读写数据，例如磁盘或者一块内存</li><li><strong>处理流</strong>：是对一个已存在的流的连接和封装，通过所封装的流的功能调用实现数据读/写功能</li></ul><h4 id="InputStream-类">InputStream 类</h4><p>三个基本 read 方法：</p><ul><li>int read()</li><li>int read( byte[] buffer )</li><li>int read( byte[] buffer, int offset, int length)</li></ul><p>其他方法：</p><ul><li>void close()</li><li>int available()</li></ul><h4 id="OutputStream-类">OutputStream 类</h4><p>三个基本 write 方法</p><ul><li>void write(int c)</li><li>void write( byte[] buffer )</li><li>void write( byte[] buffer, int offset, int length )</li></ul><p>其他方法：</p><ul><li>void close();</li><li>void flush()</li></ul><h3 id="标准输入和输出流">标准输入和输出流</h3><p><code>System.in</code>提供从“标准输入”读入数据的功能，为 InputStream 类型</p><p><code>System.out</code>提供向“标准输出”写出数据的功能，为 PrintStream 类型</p><h3 id="文件处理">文件处理</h3><p><a href="http://java.io">java.io</a> 包提供了文件操作功能的 File 类</p><p>创建 File 对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">File f;<br>f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>( <span class="hljs-string">&quot;Test.java&quot;</span> );<br>f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>( <span class="hljs-string">&quot;F:/ok/HelloWorld.class&quot;</span> );<br></code></pre></td></tr></table></figure><p>在 java 中将目录也当做文件处理，实现目录管理功能的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">File</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>( <span class="hljs-string">&quot;F:/ok/&quot;</span> );<br><span class="hljs-type">File</span> <span class="hljs-variable">f</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>( p, <span class="hljs-string">&quot;HelloWorld.class&quot;</span> );<br></code></pre></td></tr></table></figure><h4 id="File-类方法介绍">File 类方法介绍</h4><p>关于文件/目录名操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span><br>String <span class="hljs-title function_">getPath</span><span class="hljs-params">()</span><br>String <span class="hljs-title function_">getAbsolutePath</span><span class="hljs-params">()</span><br>String <span class="hljs-title function_">getParent</span><span class="hljs-params">()</span><br><span class="hljs-type">boolean</span> <span class="hljs-title function_">renameTo</span><span class="hljs-params">( File newName )</span><br></code></pre></td></tr></table></figure><p>获取常规文件信息操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">long</span> <span class="hljs-title function_">lastModified</span><span class="hljs-params">()</span><br><span class="hljs-type">long</span> <span class="hljs-title function_">length</span><span class="hljs-params">()</span><br><span class="hljs-type">boolean</span> <span class="hljs-title function_">delete</span><span class="hljs-params">()</span><br></code></pre></td></tr></table></figure><h4 id="文件过滤">文件过滤</h4><p>就是对文件名的过滤，即将符合条件的文件选择出来进行操作</p><p>接口<code>FileFilter</code>和<code>FilenameFilte</code>r 实现这一功能，要声明一个类实现接口中的 accept()的方法，常称为过滤器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FileFilter</span> &#123; <span class="hljs-type">boolean</span> <span class="hljs-title function_">accept</span><span class="hljs-params">( File pathname )</span>; &#125;<span class="hljs-comment">//pathname 是要过滤目录中的文件对象</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FilenameFilter</span> &#123; <span class="hljs-type">boolean</span> <span class="hljs-title function_">accept</span><span class="hljs-params">( File dir, String name)</span>; &#125;<span class="hljs-comment">//dir:要过滤的文件，name：目录中的文件名</span><br></code></pre></td></tr></table></figure><h4 id="FileInputStream-FileOutputStream-类">FileInputStream/FileOutputStream 类</h4><p>使用 File 类可以建立与磁盘文件的连接，读取磁盘文件的相关属性和对磁盘文件进行管理性操作</p><p>使用 File 类不能完成对磁盘文件数据的读写操作</p><p><code>FileInputStream</code>/<code>FileOutputStream</code>类可以用来实现对字节流文件的 I/O 处理，通过它提供的方法打开本机的文件，并进行顺序的读写</p><p><strong>读入数据</strong>两种方式：</p><ul><li>利用 FileInputStream 类提供的 read 方法</li><li>以 FileInputStream 类对象为原始数据源，再套上其他功能强大的输入流</li></ul><p><strong>向文件写入数据</strong>有两种方式：</p><ul><li>利用 FileOutputStream 类提供的 write 方法来完成</li><li>以 FileOutputStream 类对象为原始数据源，再套上其他功能强大的输入流</li></ul><h4 id="RandomAcessFile-类">RandomAcessFile 类</h4><p>直接继承于 Object，用户可以对文件进行任何所希望的操作</p><h4 id="FileReader-FileWriter-类">FileReader/FileWriter 类</h4><p>以字符为单位读入或写出数据</p><p>以 String 或 File 类型参数指定要读写的文件</p><h3 id="缓冲区输入和输出流">缓冲区输入和输出流</h3><p>输入流 FileReader 和输出流 FileWriter 可以方便的完成输入和输出操作，对输入和输出有较快的时间要求，使用缓冲流类在内存中建立缓冲区</p><ul><li>BufferedReader</li><li>BufferedWriter</li></ul><h3 id="格式字节数据流">格式字节数据流</h3><p>DataInputStream 类和 DataOutputStream 类创建的对象称为数据输入流和数据输出流</p><p>允许程序按照与机器无关的风格读取 Java 的原始数据类型，即无需关心数据类型占多少字节</p><ul><li>DataInputStream 类<ul><li><code>DataInputStream( InputStream in );</code><br>将创建的数据输入流指向一个由参数 in 指定的输入流，以便从中读取数据</li></ul></li><li>DataOutputStream 类<ul><li><code>DataOutputStream( OutputStream out )</code><br>将创建的数据输出流指向一个由参数 out 指定的输出流，然后通过这个数据输出流把 Java 数据类型的数据写到输出流 out</li></ul></li></ul><h2 id="第七章-Java-GUI-应用程序设计">第七章 Java GUI 应用程序设计</h2><p>AWT 与 Swing<br>事件处理机制<br>AWT/Swing 组件<br>常用事件<br>绘图</p><h2 id="第八章-异常处理与多线程">第八章 异常处理与多线程</h2><h3 id="Java-异常">Java 异常</h3><p>异常（Eception）：其他因编程错误或偶然的外在因素导致的一般性问题，例如：对负数开平方，空指针访问，试图读取不存在的文件，网络连接中断</p><p>常见异常：</p><ul><li><code>RuntimeException</code>：错误的类型转换，数组下标越界，空指针访问</li><li><code>IOExeption</code>：从一个不存在的文件中读取数据，越过文件结尾继续读取，连接一个不存在的 URL</li></ul><h3 id="异常的处理">异常的处理</h3><p>程序出现异常会自动生成一个异常类对象，该异常对象将被提交给 Java 运行时系统，这个过程称为抛出（throw）异常</p><p>Java 运行时系统接收到异常对象时，会寻找能处理这一异常的代码并把当前异常对象交给其处理，这个过程称为捕获（catch）异常</p><p>系统找不到可以捕获异常的方法，则系统终止，程序退出</p><p>程序员通常只能处理异常而对错误无能为力</p><p><strong>异常的处理</strong></p><ul><li>运行时错误：运行时系统就会产生一个和该错误相对应的异常类对象，Java 为它提供默认的异常处理程序</li><li>非运行时错误：一种方法是自己处理，使用<code>try-catch-finally</code>语句来捕获并处理异常对象；另一种是方法不需要处理它生成的异常，而是向上传递，由调用它的方法来处理，使用<code>throw</code>语句声明他可以抛出的异常而不捕捉它们</li></ul><h3 id="线程概念">线程概念</h3><p>线程是一个程序内部的顺序控制流</p><p>Java 的线程是通过<code>java.lang.Thread</code>类来实现的，方法 run()称为线程体</p><h3 id="线程的创建">线程的创建</h3><p>使用 Runnable 接口，可以从其他类继承，保持程序风格的一致性</p><p>直接继承 Thread 类，不能再从其他类继承，编写简单，可以直接操纵线程，无需使用 Thread.currentThread()</p><h3 id="线程的状态与控制">线程的状态与控制</h3><p>状态：创建，就绪，运行，阻塞，终止</p><h3 id="线程的优先级、调度和管理">线程的优先级、调度和管理</h3><p>Java 允许我们对一个线程组中的所有线程同时进行操作</p><h3 id="线程组">线程组</h3><h3 id="线程的同步">线程的同步</h3>]]></content>
    
    
    <categories>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>计算机操作系统复习</title>
    <link href="/2021/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%A4%8D%E4%B9%A0/"/>
    <url>/2021/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>操作系统复习</h1><h2 id="第一章引论">第一章引论</h2><h3 id="OS（Operating-Systems）定义">OS（Operating Systems）定义</h3><p><strong>操作系统定义</strong>:在计算机硬件系统上配置的第一个大型软件</p><p><strong>计算机系统层次</strong></p><table><thead><tr><th>应用软件</th><th>高层</th></tr></thead><tbody><tr><td>其他系统软件</td><td></td></tr><tr><td>操作系统</td><td></td></tr><tr><td>硬件系统</td><td>低层</td></tr></tbody></table><ul><li>层，层次结构由若干个层(Layer)组成，层是具有独立功能的模块或部件</li><li>接口，层与层之间的关系通过接口实现</li><li>单向依赖，层次结构中各个层从低到高排列。一个层只能使用比它更低的层的接口</li><li>隐藏性，一个层通过接口使用低层的功能，只需了解相关层的接口而无需关注层内部的设计实现等细节，也称为透明性</li></ul><p>为上层提供服务，避免上层过多考虑细节为下层隐藏细节</p><h3 id="多道程序设计并发执行与现代操作系统的关系">多道程序设计并发执行与现代操作系统的关系</h3><p>I/O 控制技术的发展，在硬件上具有处理器（CPU）与设备、设备与设备并行工作的能力，在软件方面提出了多道程序设计技术，两者奠定了操作系统形成的基础</p><h3 id="OS-基本类型及主要特征">OS 基本类型及主要特征</h3><p>OS：操作系统</p><p>基本类型：批处理操作系统，分时操作系统，实时操作系统</p><p><strong>批处理:</strong></p><ul><li>特征：批量处理，方便操作；自动执行，资源利用率高；缺少人机交互能力，不便于调试程序。</li></ul><p>假脱机（SPOOLing）</p><p><strong>分时系统和实时系统的特征\区别</strong></p><ul><li><p>分时系统：同时性；独立性；及时性；交互性（最主要）</p></li><li><p>实时系统：高及时性；高可靠性 以数据的采集、传输、处理、控制为主要工作</p></li><li><p>区别：批处理系统和分时系统中人们对得到结果的时间没有太严格的要求，而在实时系统中，计算机对一个任务处理的正确性，不仅要求计算结果是正确的，还要求在规定的时间内得到结果</p></li></ul><h3 id="批处理系统的作业、作业控制语言、作业说明书">批处理系统的作业、作业控制语言、作业说明书</h3><ul><li><strong>作业</strong>：要求计算机处理的一个问题，每个独立的步骤称为一个作业步，一个作业是若干个作业步的有序集合，若干作业的有序集合称为作业流或一批作业</li><li><strong>作业控制语言（JCL）</strong>：由操作系统提供的一组命令，用于定义作业、描述对作业的运行控制</li><li><strong>作业说明书</strong>：定义一个作业，描述对该作业运行控制的一组 JCL 命令组成的文件</li></ul><h3 id="批处理系统工作的四个阶段">批处理系统工作的四个阶段</h3><ul><li><strong>提交</strong>：程序员把程序，程序运行所需要的数据连同作业说明书一起提交给操作员</li><li><strong>后备</strong>：输入计算机控制读卡机将一批作业的所有卡片信息依次读入，再控制磁带机将作业信息写到磁带上，此时磁带上的作业为后备或收容状态</li><li><strong>执行</strong>：操作员启动主计算机，操作系统的作业调度程序从磁盘中选择若干作业进入主计算机的内存并运行</li><li><strong>完成</strong>：输出计算机从此袋中读取数据并送到打印机输出</li></ul><h3 id="联机批处理系统的核心技术，SPOOLing-组成">联机批处理系统的核心技术，SPOOLing 组成</h3><ul><li><strong>输入井</strong>：磁盘中一个特定的存储区域用于存储从读卡机上读取的作业信息</li><li><strong>预输入程序</strong>：控制读卡机反复读取卡片上的作业信息并存入输入井（输入井中的作业处于后备状态，并以作业队列方式组织（作业后备队列））</li><li><strong>输出井</strong>：磁盘中一个特定的存储区域，作业执行过程中需要打印的数据暂时存储在输出井而没有直接输出到打印机</li><li><strong>缓输出程序</strong>：控制打印机的工作，如果打印机是空闲的，则读取输出井中的数据送给打印机输出</li></ul><h3 id="操作系统主要功能">操作系统主要功能</h3><ol><li>用户接口及作业管理</li><li>处理器管理（进程）</li><li>存储器管理</li><li>文件系统</li><li>设备管理</li></ol><h2 id="第二章操作系统接口">第二章操作系统接口</h2><h3 id="核心态，用户态">核心态，用户态</h3><ul><li>核心态：可以运行包含特权指令在内的全部指令</li><li>用户态：只能运行非特权指令</li><li>特权指令：涉及系统安全的指令或使用比较复杂的指令</li></ul><h3 id="OS-内核组成，内核基本特点">OS 内核组成，内核基本特点</h3><p>内核是计算机系统最重要的系统软件：内核是实现对计算机系统管理，控制的主要部分，拥有最高的操作权限；内核中的程序和数据需要精心设计，运行时需要严密保护</p><p>操作系统内核的程序和数据包括：与硬件密切相关的操作；关键数据结构；基本中断处理程序；使用频繁的功能模块</p><p>特点：</p><ol><li>常驻内存，常驻是指程序装入内存运行完成后，操作系统没有回收所占用的空间；常驻技术可以加快系统的运行速度</li><li>内核的程序运行在核心态，用户不能直接运行内核的数据，也不能直接访问内核的数据</li></ol><h3 id="BIOS-基本组成（操作系统的启动）">BIOS 基本组成（操作系统的启动）</h3><p><strong>ROM BIOS</strong>：基本输入/输出系统，存储在只读存储器芯片中的一组程序和数据的统称</p><p>基本组成：</p><ul><li>POST 自检程序，开启计算机系统电源时处理机复位并运行，功能是识别系统的硬件配置，并根据这些配置对系统中各部件进行自检和初始化</li><li>基本启动程序，检查和运行引导程序，引导程序的执行过程就是读去操作系统的启动装载程序并运行</li><li>基本硬件驱动程序和中断处理程序，指系统基本 I/O 设备的驱动程序及其基本的中断服务程序</li></ul><h3 id="OS-用户接口类型（命名接口和程序接口）">OS 用户接口类型（命名接口和程序接口）</h3><p><strong>命令接口：</strong></p><ul><li>批处理系统中，作业控制语言（JCL）属于命令接口，这种命令被称为脱机命令</li><li>分时系统中，用户通过键盘输入命令，主计算机接收，分析命令，这种命令被称为联机命令</li><li>现代个人微机操作系统中，联机命令又分为字符命令，菜单命令，和图标命令，其中字符命令是最基本的命令接口</li></ul><p><strong>程序接口：</strong></p><ul><li>供程序员在程序中使用的接口，通过系统调用来实现</li></ul><h3 id="系统调用含义与实现过程">系统调用含义与实现过程</h3><p><strong>含义：</strong></p><ul><li>一组操作系统设计人员事先编写的子程序，这些子程序作为内核的一部分</li><li>程序员使用这组子程序的方法</li></ul><p><strong>实现过程：</strong></p><ul><li>处理器切换为核心态，保存用户程序的现场</li><li>分析功能号并在地址入口表查找对应的子程序，有时候还需要进行安全控制检查</li><li>执行系统调用的子程序并得到结果</li><li>现场恢复，处理器切换为用户态并返回结果，必要时进行安全检查</li></ul><h3 id="系统调用与用户子程序的主要区别">系统调用与用户子程序的主要区别</h3><p>从操作系统角度来看，它们所处的运行环境不同，系统调用运行在核心态，用户子程序则是运行在用户态；系统调用的执行产生中断即访管中断（或陷阱），用户子程序的运行则不会产生中断；系统调用子程序的代码与调用者的程序代码是分开、独立的，而用户子程序的代码与调用者的程序代码在同一个进程地址空间；不同用户程序可以共享使用同一个系统调用，用户子程序通常不能由其他用户程序调用。</p><table><thead><tr><th>对比项目</th><th>系统调用</th><th>用户子程序</th></tr></thead><tbody><tr><td>运行环境</td><td>核心态</td><td>用户态</td></tr><tr><td>中断</td><td>访管中断</td><td>无</td></tr><tr><td>与主程序关系</td><td>与主程序分开、独立</td><td>同一进程地址空间</td></tr><tr><td>共享</td><td>不同用户可以共享</td><td>同一进程内部调用</td></tr></tbody></table><h2 id="第三章进程管理">第三章进程管理</h2><h3 id="程序可再现性的含义，并发执行微观含义的随机性理解">程序可再现性的含义，并发执行微观含义的随机性理解</h3><p><strong>可再现性</strong>：对于一道正确的程序来说，只要初始条件相同，在同一台机器上多次运行，每次运行得到的结果就应该是相同的。或者说，一道程序如果在不同时间多次运行，那么，每次运行所完成的功能应该是相同的。程序员调试程序的依据就是程序的可再现性。</p><p><strong>并发执行的随机性</strong>：为了表现多道程序并发执行在宏观上的多任务，在微观上这些程序必须轮流交替的在处理器上运行，在这些程序中，哪一道程序先运行，哪一道程序后运行，运行时能够连续运行多长时间，这些都是随机的不确定的</p><p>破坏了程序的可再现性</p><h3 id="进程定义、进程基本特征">进程定义、进程基本特征</h3><p>进程是系统资源分配的独立单位，因进程是程序的运行过程，因此进程包含了程序，进程的运行就是其对应的程序的运行，程序规定了进程所要完成的功能，引入进程不仅可以实现对处理器的有效管理，同时也实现了对其他资源的管理</p><p>进程的主要特征：</p><ul><li><p>动态性：有一个生命期，从创建、运行到消亡的过程</p></li><li><p>并发性：多个进程可以并发执行</p></li><li><p>独立性：进程是操作系统分配资源的基本单位</p></li><li><p>结构性：由程序块，数据块，进程控制块等部分组成</p></li></ul><h3 id="进程动态性，基本状态及转换关系">进程动态性，基本状态及转换关系</h3><p>基本状态：</p><ol><li>运行：进程正占用 CPU 运行</li><li>就绪：对于当前不处在运行状态的进程，如果把 CPU 分配给它，它就可以立即运行</li><li>阻塞：即使分配处理器也不能运行</li></ol><p><img src="/img/post/2023-01-15-17-02-12.png" alt="三种状态进程转换"></p><h3 id="进程的表示（PCB）、进程队列">进程的表示（PCB）、进程队列</h3><p>描述、管理和控制进程所涉及的数据结构称为进程控制块（PCB），PCB 是进程存在的标识，操作系统通过 PCB 管理，控制进程</p><p>PCB 分为三个部分：</p><ul><li><strong>基本描述信息部分</strong>：<ul><li>进程名，pname 通常是用程序文件名或命名名称表示，不唯一</li><li>进程标识符 pid，由操作系统自动生成，唯一，可用于区别进程，getpid()</li><li>用户标识 uid，操作系统在用户注册时，为每个用户分配一个唯一的标识符 uid</li><li>进程状态 pstate 表示进程当前的状态</li></ul></li><li><strong>管理信息部分</strong><ul><li>程序和数据地址，程序和数据在内存中的位置信息</li><li>IO 操作相关参数，进程进行 IO 操作时的参数</li><li>进程通信信息，用于进程间通信的消息队列指针等</li></ul></li><li><strong>控制信息部分</strong><ul><li>现场信息，进程离开运行状态时，保存现场以备恢复</li><li>调度参数，与进程调度相关的参考信息，如优先级、运行时间等</li><li>同步、互斥信息量，用户保证进程间同步、互斥关系的信息</li></ul></li></ul><p>PCB 队列（进程队列）：</p><ul><li><strong>就绪队列</strong>：按照进程性质和优先级，可以有多个就绪队列，以提高进程调度算法选择进城的效率，多处理器系统中每个处理其具有独立的请求队列</li><li><strong>等待队列</strong>：按照阻塞原因系统可以有多个等待队列，在阻塞原因解除时统一调整进程状态</li></ul><h3 id="进程管理的-5-个功能">进程管理的 5 个功能</h3><p>控制、同步、通信、调度、死锁</p><h3 id="进程阻塞，唤醒原语-实现进程状态的变化">进程阻塞，唤醒原语,实现进程状态的变化</h3><p>一个特殊的程序段称为原语，程序段中的所有指令要么全部执行要么一个都不执行，作用是保证系统运行的一致性</p><p><strong>进程原语</strong>包括进程的创建（Create），撤销（Destroy），阻塞，唤醒，切换</p><p>进程阻塞原语（Block）用于使一个进程进入阻塞状态</p><p>完成以下操作：</p><ol><li>修改进程为阻塞状态</li><li>将进程的现场保存以备恢复</li><li>将进程 PCB 加入合适的等待队列</li></ol><p><strong>进程唤醒原语</strong>（Wakeup）用于是一个进程从阻塞状态进入就绪状态，在阻塞原因解除时被使用</p><p>完成以下操作：</p><ol><li>将进程 PCB 从等待队列中移除</li><li>修改进程状态为就绪状态</li><li>将进程 PCB 加入合适的就绪队列</li></ol><p>阻塞原因解除后进程未必可以直接运行，因此合理的唤醒源于并不会将阻塞状态直接修改为运行状态</p><p>临界区的执行，也是顺序的</p><h3 id="并发进程的两种制约关系">并发进程的两种制约关系</h3><ul><li>间接制约：是由资源共享引起的，一组并发进程在共享某种临界资源时存在的一种制约关系</li><li>直接制约：由任务协作引起的，一个进程的执行状况直接决定了另一个或几个进程能否执行</li></ul><h3 id="临界资源、临界区含义">临界资源、临界区含义</h3><p><strong>临界资源</strong>：一次只能让一个进程使用的资源，如打印机，存储单元，堆栈，文件</p><p><strong>临界区</strong>：进程对应的程序中访问临界资源的一段程序代码，就是进程在资源的一次使用过程中，从申请开始至归还为止的一段程序代码，不允许处理器在临界区之间轮流交替的执行</p><h3 id="信号量机制的含义（P，V-操作定义）">信号量机制的含义（P，V 操作定义）</h3><p>信号量机制由三个要素组成：信号量 s、原语 p、原语 v</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">struct semaphore&#123;<br><span class="hljs-type">int</span> value;<span class="hljs-comment">//信号量的值</span><br>PCB *bq;<span class="hljs-comment">//由于该信号量而堵塞的进程的PCB队列（等待队列）</span><br>&#125;<br><br>p(s)&#123;<br>s.value = s.value-<span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>( s.value &lt; <span class="hljs-number">0</span> )blocked(s);<br>&#125;<br><br>v(s)&#123;<br>s.value = s.value + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">if</span>( s.value &lt;= <span class="hljs-number">0</span> )wakeup(s);<br>&#125;<br></code></pre></td></tr></table></figure><p>该机制中，s.value&gt;0 表示资源就绪，否则表示有进程在使用或请求使用资源。进程请求资源时需使用原语 p，若资源非空闲，则进入由于 s 而导致的等待队列，直至正在使用资源的进程归还资源时使用原语 v 将其唤醒</p><h4 id="大题">大题</h4><p>例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">PA()[<br><span class="hljs-type">int</span> x;<br>p(s);<br>x = count;(<span class="hljs-number">1</span>)<br>x = x+<span class="hljs-number">1</span>;(<span class="hljs-number">2</span>)<br>count = x;(<span class="hljs-number">3</span>)<br>v(s);<br>&#125;<br><br>PB()&#123;<br><span class="hljs-type">int</span> y;<br>p(s);<br>y = count;(<span class="hljs-number">4</span>)<br>y = y-<span class="hljs-number">1</span>;(<span class="hljs-number">5</span>)<br>count = y;(<span class="hljs-number">6</span>)<br>v(s);<br>&#125;<br></code></pre></td></tr></table></figure><p>用信号量 s 表示资源(变量 count)的就绪情况，使得临界区(1)(2)(3)与(4)(5)(6)建立互斥关系</p><p>按 1，4，5，6，2，3 顺序能否执行</p><p>semaphore s = 1; //定义信号量</p><p>处理器在执行 PA()的(1)之前，应先执行 PA()中的 p(s)操作，由于这时 s.value = 1，所以执行 p(s)后，s.value = 0，不会引起进程堵塞，p(s)操作很快返回，PA()进入临界区，处理器执行(1)。现在，按照假定，处理器转去执行 PB()的(4)(5)(6)，从上述代码可知，处理器在执行(4)之前，应先执行 PB()的 p(s)操作，当处理器执行 PB()中 p(s)之前，s.value = 0，所以，在 p(s)执行后 s.value = -1，PB()进程因 p(s)操作进入阻塞状态，PB()被加入 s.bq 的等待队列中，而暂时无法执行 PB()的(4)及其后续的语句。这样，将来处理器轮到 PA()，继续执行 PA()的(2)(3)和 v(s)，并离开了临界区。处理器在执行 PA()的 v(s)前，s.value = -1，所以，PA()的 v(s)操作的执行将从 s.bq 等待队列中唤醒阻塞状态的进程 PB()。当处理器再次轮到 PB()执行时，执行 PB()中的 p(s)的下一条指令，即 PB()进入临界区执行。</p><h3 id="信号量机制实现互斥关系">信号量机制实现互斥关系</h3><p>可能导致错误结果的轮流交替执行操作都被控制了</p><p>p 操作和 v 操作是原语，不会出现如加锁机制的两条语句被分割执行的情况</p><h3 id="信号量机制实现同步关系（一般-PC-问题和复杂-PC-问题）">信号量机制实现同步关系（一般 PC 问题和复杂 PC 问题）</h3><p>对于一组存在直接制约关系的并发进程，为了避免制约关系导致的运行错误，应当使各进程中代码的运行顺序服从内在要求，需要建立进程间单向或相互的依赖关系。</p><p>若一组进程中的每一个进程都与其他至少一个进程建立了单向或相互的依赖关系，则称这组进程为同步进程，这组进程间建立了同步关系。</p><p><img src="/img/post/2023-01-15-17-10-21.png" alt=""></p><p>代码段 L1 对 L2 依赖时，可将 L2 的一次执行看做一种“资源”的归还（就绪），而 L1 的执行，需要申请使用这种“资源”。</p><p>信号量机制实现同步关系：在 L1 执行前执行原语 p，在 L2 执行后执行原语 v</p><p>与互斥关系不同的是，L1 使用“资源”后并不归还（“资源”被消耗）</p><h3 id="进程通信的含义，进程通信方式">进程通信的含义，进程通信方式</h3><p>进程通信（IPC）：两个或多个进程之间交换数据的过程，其中提供数据的一方称为发送进程，得到数据的一方成为接收进程</p><p>进程通信方式：</p><ul><li>共享存储区通信<ul><li>信号，管程，低级通信机制</li></ul></li><li>消息缓冲通信</li><li>信箱通信<ul><li>多生产者多消费者的 PC 问题</li></ul></li><li>管道通信</li></ul><h3 id="消息缓冲通信的实现-概念理解">消息缓冲通信的实现,概念理解</h3><p><strong>消息缓冲通信</strong>：内核空间中为每个进程配备了一个消息队列 MQ，并记录在进程的 PCB 中，发送进程通过 Send 操作将信息封入一个消息缓冲区中，并追加到接收进程的消息队列内；接收进程通过 Receive 操作收取自身消息队列中的信息。</p><p>消息缓冲区包括：发送进程标识(pid)，正文大小(size)，正文(data)，向下指针(next);</p><p>与信箱通信相比，消息缓冲通信中的消息队列专属于进程。消息缓冲通信是一种直接通信，当接收进程未开启时，通信不成功</p><h3 id="引入线程的目的">引入线程的目的</h3><p><strong>线程</strong>：把进程细化为若干个可以独立运行的实体，每一个实体成为一个线程（Thread）</p><p>引入线程减小了系统的基本工作单位粒度，其目的在于：</p><ul><li>实现进程内部的并发执行，提高并行程度</li><li>减少处理器切换带来的开销</li><li>简化进程通信方式</li></ul><h3 id="并发含义和特征">并发含义和特征</h3><p>并发执行是指在多道程序设计环境下，处理器在开始执行一道程序的第一条指令后，在这道程序完成之前，处理器可以开始执行下一道程序，同样的，更多其他的程序也可以开始运行</p><p>并发执行具有复杂性，体现在随机性，不可再现性，相互制约</p><h2 id="第四章进程调度与死锁">第四章进程调度与死锁</h2><h3 id="作业调度基本算法、周转时间、平均周转时间的计算">作业调度基本算法、周转时间、平均周转时间的计算</h3><p><strong>作业调度</strong>就是按一定的策略从后备队列中选择一部分作业，为它们分配运行所需要资源，创建进程的过程</p><p>作业调度称为宏观调度，被作业调度程序选中的作业进入内存，其状态为“执行”状态，需要进过进程调度后才能得到运行</p><p>周转时间：第 i 个作业 Ji 的周转时间 Ti 的定义为 Ti = 作业 Ji 的完成时刻 - 作业 Ji 的提交时刻</p><p>对于批处理用户而言，一个作业的周转时间越小越好</p><p><strong>平均周转时间</strong>： T = （T1 + T2 + . + Tn）/n</p><p>对于调度应尽可能寻找减少平均周转时间 T 的管理方法</p><p><strong>作业调度基本算法</strong>：</p><ul><li><strong>FCFS</strong>：先到先服务<ul><li>思想：排队</li><li>特点：公平合理；算法简单容易实现；服务质量欠佳（不利于短作业）</li></ul></li><li><strong>SJF</strong>：短作业优先<ul><li>思想：减少共同等待时间</li><li>特点：实现最小的平均周转时间；吞吐量大；存在“饥饿”现象；算法思想简单，但实现困难</li></ul></li><li><strong>HRN</strong>：高响应比优先<ul><li>思想：通过考虑作业已等待时间解决 SJF 的饥饿问题</li><li>响应比 R</li></ul></li></ul><h3 id="进程调度两种方式">进程调度两种方式</h3><p>进程调度就是按一定策略从进程就绪队列中选择一个进程，让其占用处理器运行</p><p>两种方式：</p><ul><li>抢占方式：系统可以基于某些原则在没有任何警告的情况下，让运行的进程停下来，把处理器分配给下一个进程，具有更好的灵活性，但具有更大的系统开销，常见原则有：时间片原则，优先级原则</li><li>非抢占方式：运行的进程让他继续除非他自身的原因让出处理器，否则一直运行至完成为止，管理简单系统开销较小，但缺乏灵活性</li></ul><h3 id="进程调度基本算法-FCFS-RR-优先级-的思想">进程调度基本算法[FCFS,RR,优先级]的思想</h3><h4 id="FCFS-先来先服务">FCFS 先来先服务</h4><p>调度时不修改就绪队列，并且总是选择队首</p><p>基于非抢占调度</p><p>优缺点：公平，易实现，服务质量欠佳</p><h4 id="RR-时间调度算法">RR 时间调度算法</h4><p>时间片轮转 RR</p><p>基于抢占调度方式，实现依赖于计时器中断</p><p>进程每次被选中时分配一个时间片，调度时判断其时间片是否用尽，若用尽则将其移至就绪队列末尾，否则不修改就绪队列，并且总是选择队首</p><p>时间片长为 T,若就绪队列中已存在 n 个进程，则提交的新进程的最长响应时间 R = T * n</p><p>根据实际需要确定 T 的值：</p><p>T 太长则响应时间过长，T 太短则进程切换过于频繁，系统开销加大</p><h4 id="Priority-优先级算法">Priority 优先级算法</h4><p>为每个进程赋予一个优先数，调度时总是选择优先数最高的进程</p><p>可基于抢占式调度也可基于非抢占式调度：</p><ul><li>抢占式调度可保证总是执行高优先级进程</li><li>非抢占式调度，仅能保证当前一个进程阻塞或结束时总能选择优先级最高的进程</li></ul><p><strong>关键是进程优先数的配置</strong></p><ul><li>静态优先级算法：进程优先数在进程创建时确定，不可被改变</li><li>动态优先级算法：进程优先数在创建进程时被赋初值，运行中可根据系统状态改变</li></ul><p>IO 繁忙型进程应当被赋予高优先级以提高系统并行程度</p><h3 id="高响应比计算方法">高响应比计算方法</h3><p>R = 作业等待时间/作业大小</p><p>作业等待时间=系统当前时间-作业提交时刻</p><p>作业大小是指作业运行是占用处理器时间的总和</p><p>短作业一开始就拥有较高的响应比而优先被选中</p><h3 id="进程死锁的四个必要条件">进程死锁的四个必要条件</h3><ol><li>互斥条件，每一个进程至少与同组的另一个进程共享同一类临界资源，共享同一临界资源的进程必须互斥进行</li><li>不剥夺条件，一个进程在申请资源得不到满足时不能执行其他进程的自愿归还操作</li><li>请求与保持条件，进程在申请新资源得不到满足而阻塞时，对原来申请已经分配得到的资源仍然保持着</li><li>环路等待条件，等待前一个进程归还资源，而他已经拥有的资源优势他的后一个进程所等待的</li></ol><p><strong>一组进程死锁则上述四个条件同时成立</strong></p><h3 id="死锁预防的含义及预防方法">死锁预防的含义及预防方法</h3><p>含义：在资源分配上采取限制措施来破坏死锁产生的 4 个必要条件之一</p><p><strong>互斥条件</strong>原则上不能被破坏，因为并发执行方式正是利用互斥执行才得以保证程序的可再现性。（打印机可以把进程对临界资源的使用转化为对可共享资源的使用，采取虚拟技术）</p><p>不能通过破坏“不剥夺条件”来实现，被剥夺资源的进程不可预期的被打断，系统需处理回退，缺乏公平性，反复剥夺与被剥夺</p><p><strong>破坏请求与保持条件</strong>，有两种方式：</p><ul><li><strong>静态分配</strong><ul><li>进程需要一次申请完所有可能使用的资源，缺点是难以预知需要使用的资源，降低资源利用率</li></ul></li><li><strong>资源暂时释放</strong><ul><li>进程申请资源不成功时，暂时归还已分配的资源，缺点是系统需处理回退，反复申请与归还</li></ul></li></ul><p><strong>环路等待状态：</strong></p><ul><li><strong>按序分配</strong><ul><li>对资源编号，进程只允许申请比当前已拥有资源编号更大的资源，缺点是若使用大编号资源的段内需使用小编号资源，则只能实行小范围内的静态分配，编号管理困难</li></ul></li><li><strong>单请求方式</strong><ul><li>资源申请不允许嵌套，但一次可申请多个，归还旧资源后方可申请新资源，缺点是同时需要多个资源时只能实行小范围内的静态分配</li></ul></li></ul><h3 id="安全状态的判断-银行家算法应用">安全状态的判断,银行家算法应用</h3><p>系统处于安全状态就一定不会发生死锁，如果系统进入不安全状态就可能发生死锁，但不一定发生死锁，但发生死锁时一定是在不安全状态</p><p>银行家算法核心思想：在资源分配之前预先判断这次分配是否会导致系统进入不安全状态</p><h3 id="死锁判断例子">死锁判断例子</h3><p>假设某一道程序运行时需要访问临界资源 R，该程序可供多个用户同时运行，如果系统拥有资源 R 的数量为 k,而程序申请使用资源 R 的数量为 x(假定程序每次只申请一个,先后分 x 次申请),有 n 个用户同时运行该程序。那么,在 k、x 和 n 满足什么条件下，可以保证用户运行时不会产生进程死锁?</p><p>解:该程序被运行 n 次，将创建 n 个进程，如果每个进程都得到 x-1 个资源 R 后，资源 R 还剩余 1 个单位，那么,这 n 个进程就不会死锁，因此 k、x 和 n 满足 k-n * (x-1)≥1 即可。</p><h2 id="第五章存储器管理">第五章存储器管理</h2><p>处理器的寄存器（Register）可以存放程序的指令和运算数据，寄存器是所有存储部件中存取速度最快的一种</p><p>高速缓冲区存储器（Cache）：为了缓解 CPU 与主存之间速度不匹配而采取的技术，在 CPU 和主存之间加入一级或多级的静态随机存取存储器（SRAM）作为 Cache，容量比主存小得多，不能在程序中直接使用</p><p>主存（本章所讲）分为只读存储器（RAM）和可以进行读或写操作的随机存取存储器（RAM），RAM 的数据不能保存，关机之后数据消失。CPU 可以直接访问主存，主存用于存放处理器运行期间的程序和数据</p><h3 id="存储管理的主要功能-重定位及其方式">存储管理的主要功能,重定位及其方式</h3><p>主要功能：</p><ul><li>存储空间的分配和回收（最基本的功能）<ul><li>主要任务如下：<ol><li>设计合理的数据结构，登记存储单元的使用情况</li><li>设计分配算法</li><li>存储空间回收</li></ol></li></ul></li><li>重定位（静态，动态）</li><li>存储空间的共享和保护</li></ul><p>**重定位：**也称地址转换或地址映射，就是把虚拟地址转换为物理地址的过程，程序的运行必然需要重定位，因为 CPU 最终是以物理地址存取数据和指令。</p><p>**静态重定位：**操作系统装入程序时修改其中所引用的逻辑地址值为物理地址值，由操作系统实现</p><p>**动态重定位：**在运行过程中需要做访问操作时才进行地址转换，由 CPU 的存储管理单元（MMU）自动实现，操作系统只登记 MMU 进行重定位时需要的相关信息</p><table><thead><tr><th></th><th>静态重定位</th><th>动态重定位</th></tr></thead><tbody><tr><td>硬件支持</td><td>不需要</td><td>需要</td></tr><tr><td>操作系统的工作</td><td>装入时修改程序</td><td>登记 MMU 所需信息</td></tr><tr><td>程序装入</td><td>被修改</td><td>直接装入</td></tr><tr><td>程序运行时移动</td><td>困难</td><td>容易</td></tr><tr><td>程序的不连续装入</td><td>困难</td><td>容易</td></tr><tr><td>其它技术支持（动态链接，虚拟存储等）</td><td>难以实现</td><td>容易实现</td></tr></tbody></table><h3 id="固定分区基本思想和数据结构">固定分区基本思想和数据结构</h3><p>操作系统占用内核空间之外将整个用户空间划分为若干个固定大小的区域，多道程序分别装入不同的分区内，一道程序只能装入一个分区，而一个分区也只能分配给一道程序</p><p>数据结构：分区说明表（DPT），记录各分区的位置和使用情况</p><table><thead><tr><th>区号</th><th>长度</th><th>起始地址</th><th>状态</th></tr></thead><tbody><tr><td>1</td><td>75K</td><td>32K</td><td>1</td></tr><tr><td>2</td><td>30K</td><td>107K</td><td>0</td></tr></tbody></table><p>分区分配给进程状态置为 1</p><h3 id="动态分区的-FF-BF-WF-分配算法">动态分区的 FF,BF,WF 分配算法</h3><p>最先适应算法，最佳适应算法，最坏适应算法</p><h3 id="FIFO-LRU">FIFO/LRU</h3><p>先进先出算法</p><p>最近最久未使用算法</p><h3 id="静态分页基本思想">静态分页基本思想</h3><p>静态分页：程序装入内存是装入其所有的页。运行速度快，实现方法简单，程序所需空间不能超过实际内存大小</p><p>需记录以下关键数据</p><ol><li>记录内存中各块的使用（空闲/被分配）情况<ul><li>位示图法：内存中的第 b 个块的使用情况被记录在一个位示图第 i 个字的第 j 位上，0 表示空闲，1 表示已分配<ul><li>b = 字长 * i + j</li><li>i = b / 字长</li><li>j = b % 字长</li></ul></li></ul></li><li>用页表记录进程中的页与内存中的块的对应情况<ul><li>每个进程创建时将建立该进程的页表，以记录进程的各个页被装入到内存中的块的编号。页表的起始位置（页表基址）及页的个数（页表限长）记录在进程的 PCB 中以备重定位时 MMU 使用</li></ul></li></ol><p>静态分页及数采用动态重定位，同时进行存储保护</p><h3 id="页表、快表的作用">页表、快表的作用</h3><p><strong>页表</strong>：登记进程页与块对应关系的数据结构称为页表，主要功能是重定位和存储保护</p><p><strong>快表</strong>：TLB（在 MMU 增加的一组专用的硬件高速缓冲区）中所存储的页与块的对应关系，访存时先在 TLB 中查询</p><p><strong>作用</strong>：弥补静态分页技术的不足（重定位时两次访存（查找页表和读取数据）增大了 CPU 的开销）</p><h3 id="请求分页中页表结构，中断位-P、修改位-M-的作用">请求分页中页表结构，中断位 P、修改位 M 的作用</h3><p>页表需要记录：</p><ul><li>页对应的块的编号</li><li>中断位 P，页是否在内存中</li><li>访问位 A，页在装入后是否再次被访问过</li><li>修改位 M，页在装入后是否被修改，在页面调度时使用可以减少写 IO 操作</li><li>外存地址，页在外存中的位置</li></ul><h3 id="抖动现象和-Belady-现象">抖动现象和 Belady 现象</h3><p>Belady 现象：可使用的内存块数越多，运行过程中产生的缺页率反而越多（FIFO 特有）</p><p>抖动现象：缺页中断发生的次数多，反复调入调出</p><h3 id="分段存储管理、段页式存储管理的数据结构及重定位过程">分段存储管理、段页式存储管理的数据结构及重定位过程</h3><p>段式和页式的区别:</p><ol><li>存储空间的分配单位粒度：页长度是固定的，页由硬件虚拟地址结构决定；段由程序员的程序设计决定，段之间长度往往不相等</li><li>虚拟地址空间的维数：分页是一维的，分段是二维（段号 s 和段内地址 d）的</li><li>内存分配：分页把内存空间看成由一组大小相等的块组成，分段存储管理则采用动态分区</li><li>碎片：按页分配存在内碎片，按段分配造成外碎片</li></ol><p>段：二维的地址，页：一维</p><h3 id="存储管理方法与碎片问题">存储管理方法与碎片问题</h3><p>分页存储管理中每个进程的最后一个页可能不足一个块的长度，按页分配内存块时，存在内碎片；分段存储管理则采用动态分区，随着分配和回收的不断进行，可能存在很小的空闲区造成外碎片</p><p><strong>内部碎片可能大可能小，外部碎片很小</strong></p><h3 id="分区内存管理和分页内存管理的地址变换方法">分区内存管理和分页内存管理的地址变换方法</h3><p>分区：物理地址 = 逻辑地址 + 分区首地址</p><p>分页：</p><ul><li>逻辑地址整除页长，商为页号，余数为页内地址</li><li>查页表，找到页表对应的帧号</li><li>物理地址 = 帧号 * 页长 + 页内地址</li></ul><h2 id="第六章文件管理">第六章文件管理</h2><h3 id="文件系统的主要功能，按名存取的含义">文件系统的主要功能，按名存取的含义</h3><p>按名存取，是指用户只需给出文件名和相关的操作即可（如创建、读或写等操作）而无需关心文件内容在存储介质上的存储形式，以及文件内容的存取细节。</p><p>文件系统的主要功能：</p><ul><li>文件内容的组织。组织形式分为文件的逻辑结构（面向用户使用）和物理结构（面向系统设计，侧重于提高存储空间的利用率和存取速度）</li><li>文件和目录管理。文件系统通过文件的物理结构和目录文件实现按名存取的功能</li><li>文件系统的接口</li><li>文件的共享和安全性</li></ul><h3 id="文件逻辑结构的分类">文件逻辑结构的分类</h3><ul><li><strong>流式文件</strong>。文件内容按照用户提供的数据顺序，以字符流方式组织，没有对文件内容进行结构上的划分</li><li><strong>记录式文件</strong>。以数据在逻辑上的完整性含义为单位划分文件内容，每个单位成为一个逻辑记录简称记录</li></ul><h3 id="三种文件物理结构及其主要特点">三种文件物理结构及其主要特点</h3><ul><li>连续结构：顺序结构，系统按照记录顺序将它们存放在依次相邻的物理块上<ul><li>特点：管理简单；存取速度快；存储空间连续分配，存储空间利用率不高；不便于文件内容的增加或删除</li></ul></li><li>链接结构：指定物理块的一个固定存储单元，作为链表的指针，指向同一个文件内容存储的下一个物理块，并规定指针为空表示该文件的物理块链表结束<ul><li>特点：非连续的存储分配，提高了存储空间的利用率；方便文件内容的增加或删除；只适合顺序存取，存取速度慢；指针信息造成物理块信息不完整，并导致数据无法控制</li></ul></li><li>索引结构：为外存储器上的每个文件建立一个索引表<ul><li>特点：非连续的存储分配提高了存储空间的利用率；方便文件内容的增加或删除；实现随机存取；索引表占用额外的存储空间；增加检索的开销</li></ul></li></ul><h3 id="FCB-和目录文件">FCB 和目录文件</h3><p>文件控制块（FCB）用于描述和管理文件</p><p>包括：描述信息部分（有文件名、文件的逻辑结构信息、文件物理结构信息），管理信息部分（存取控制信息和使用信息）</p><p>若干文件的 FCB 数据的有序集合称为文件目录，文件目录是以文件的形式保存在外存储器上，这类文件称为目录文件，简称目录或文件夹。</p><p>一个目录作为一个文件也对应一个 FCB，一个目录的 FCB 数据还可以保存在另一个目录文件中，这样按不同的方式划分文件，把若干文件组织在一起作为一个文件目录。</p><h3 id="二级目录的名称及结构关系图">二级目录的名称及结构关系图</h3><p>分为用户文件目录（UFD）和系统主目录（MFD）。系统为每个用户建立一个用户文件目录，登记该用户的所有文件，另外系统为全部用户建立一个系统主目录用于登记用户名和对应的用户文件目录的存储起始地址</p><h3 id="二级目录访问过程">二级目录访问过程</h3><p>用户访问文件过程是：按照用户名查找系统主目录，得到用户文件目录，接着按照文件名查找用户文件目录，得到文件的 FCB，从而得到文件在外存中的存储位置</p><h3 id="文件保密的含义和基于存取权限的访问控制方式">文件保密的含义和基于存取权限的访问控制方式</h3><p>文件保密是对文件存取的控制，防止文件的非法访问</p><p>基于主体权限的存取控制方式：存取控制矩阵、存取控制表、权能表</p><h3 id="文件的共享">文件的共享</h3><p>绕道法，链接法，基本文件目录法（BFD）</p><h2 id="第七章设备管理">第七章设备管理</h2><h3 id="设备独立性含义">设备独立性含义</h3><p>I/O 软件的层次结构为用户和程序隐藏了底层设备的物理特性差异，实现了设备的独立性。当进程运行时，由操作系统在逻辑设备与物理设备之间建立连接，即设备的分配，把这种设备使用方法的特点称为设备独立性</p><h3 id="I-O-缓冲的目的">I/O 缓冲的目的</h3><ol><li>缓解设备和处理器之间速度不匹配的矛盾，提高系统工作的并行程度</li><li>减少 I/O 操作的次数</li><li>减少中断次数</li><li>提高系统的及时性，方便用户操作</li></ol><h3 id="磁盘驱动调度组成">磁盘驱动调度组成</h3><p>移臂调度和旋转调度</p><h3 id="移臂调度算法例子（SSTF、SCAN、电梯）">移臂调度算法例子（SSTF、SCAN、电梯）</h3><p>SSTF 最短寻道时间优先</p><p>SCAN 扫描算法，总是选择当前磁头方向上距离最近柱面的 I/O 操作，移到尽头才返回</p><p>电梯算法，SCAN 算法的改进，当前方向没有 I/O 操作就换方向</p>]]></content>
    
    
    <categories>
      
      <category>计算机操作系统</category>
      
    </categories>
    
    
    <tags>
      
      <tag>复习资料</tag>
      
      <tag>操作系统</tag>
      
      <tag>OS</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
